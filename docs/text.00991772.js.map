{"mappings":"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","sources":["src/text/index.ts"],"names":["WEIGHTS","frame","TRANSPARENT","WHITE","BLUE","TEXT","fontAnim","container","document","getElementById","Error","innerText","beat","measure","Math","floor","style","color","backgroundColor","fontStyle","setTimeout","fontWeight","String","removeProperty","length","setProperty","console","log","intervalId","round","initAnim","bpm","clearInterval","setInterval","window","onclick","count","bpmAvg","msecsFirst","msecsPrevious","resetCount","performance","now","onkeypress","e","key","app","div1","createElement","div2","div3","div4","fontSize","position","top","left","appendChild","removeChild","slideyBoi","msecs","display"],"version":3,"file":"text.00991772.js.map","sourcesContent":["const WEIGHTS = [300, 400, 500, 600];\n\nfunction random<T>(arr: T[]): T {\n  if (arr.length === 0) throw new Error(\"Array too short\");\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nlet frame = 0;\n\nconst TRANSPARENT = \"rgba(0, 0, 0, 0)\";\nconst WHITE = \"#ffffff\";\nconst BLUE = \"#0000ff\";\n\nconst TEXT = \"<!-- @ajaska -->\";\n\nfunction fontAnim() {\n  const container = document.getElementById(\"mainText\");\n  if (!container) throw new Error(\"Couldn't find text\");\n  container.innerText = TEXT;\n\n  const beat = frame % 4;\n  const measure = Math.floor(frame / 4);\n\n  if (beat === 0) {\n    {\n      container.style.color = WHITE;\n      container.style.backgroundColor = BLUE;\n      container.style.fontStyle = \"italic\";\n    }\n    setTimeout(() => {\n      container.style.color = BLUE;\n      container.style.backgroundColor = TRANSPARENT;\n      container.style.fontStyle = \"normal\";\n    }, 100);\n\n    setTimeout(() => {\n      container.style.color = WHITE;\n      container.style.backgroundColor = BLUE;\n      container.style.fontStyle = \"italic\";\n    }, 200);\n\n    setTimeout(() => {\n      container.style.color = BLUE;\n      container.style.backgroundColor = TRANSPARENT;\n      container.style.fontStyle = \"normal\";\n    }, 300);\n  }\n\n  if (measure % 2 === 0) {\n    // container.style.color = WHITE;\n    // container.style.backgroundColor = BLUE;\n    container.style.fontWeight = String(WEIGHTS[beat]);\n    container.style.removeProperty(\"-webkit-text-stroke\");\n  } else if (measure % 2 === 1) {\n    // container.style.color = BLUE;\n    // container.style.backgroundColor = WHITE;\n    container.style.fontWeight = String(WEIGHTS[WEIGHTS.length - 1 - beat]);\n    container.style.removeProperty(\"-webkit-text-stroke\");\n  } else if (measure % 4 === 2) {\n    container.style.color = BLUE;\n    container.style.backgroundColor = BLUE;\n    container.style.setProperty(\"-webkit-text-stroke\", `2px ${WHITE}`);\n\n    container.style.fontWeight = String(WEIGHTS[beat]);\n  } else if (measure % 4 === 3) {\n    container.style.color = WHITE;\n    container.style.backgroundColor = WHITE;\n    container.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n\n    container.style.fontWeight = String(WEIGHTS[WEIGHTS.length - 1 - beat]);\n  }\n\n  frame++;\n  console.log(`${measure + 1}.${beat + 1}`);\n}\n\nfunction slideyBoi() {\n  const app = document.getElementById(\"appContainer\")!;\n  const div1 = document.createElement(\"div\");\n  const div2 = document.createElement(\"div\");\n  const div3 = document.createElement(\"div\");\n  const div4 = document.createElement(\"div\");\n  setTimeout(() => {\n    div1.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div1.style.color = TRANSPARENT;\n    div1.style.backgroundColor = TRANSPARENT;\n    div1.style.fontStyle = \"normal\";\n    div1.style.fontSize = \"144px\";\n    div1.style.fontWeight = String(WEIGHTS[0]);\n    div1.style.position = \"absolute\";\n    div1.style.top = \"4px\";\n    // div1.style.top = \"0px\";\n    div1.style.left = \"4px\";\n    div1.innerText = TEXT;\n    app.appendChild(div1);\n  }, 0);\n\n  setTimeout(() => {\n    div2.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div2.style.color = TRANSPARENT;\n    div2.style.backgroundColor = TRANSPARENT;\n    div2.style.fontStyle = \"normal\";\n    div2.style.fontSize = \"144px\";\n    div2.style.fontWeight = String(WEIGHTS[1]);\n    div2.style.position = \"absolute\";\n    div2.style.top = \"8px\";\n    // div2.style.top = \"0px\";\n    div2.style.left = \"8px\";\n    div2.innerText = TEXT;\n    app.appendChild(div2);\n  }, 50);\n\n  setTimeout(() => {\n    //div3.style.color = BLUE;\n    div3.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div3.style.color = TRANSPARENT;\n    div3.style.backgroundColor = TRANSPARENT;\n    div3.style.fontStyle = \"normal\";\n    div3.style.fontSize = \"144px\";\n    div3.style.fontWeight = String(WEIGHTS[2]);\n    div3.style.position = \"absolute\";\n    div3.style.top = \"12px\";\n    // div3.style.top = \"0px\";\n    div3.style.left = \"12px\";\n    div3.innerText = TEXT;\n    app.appendChild(div3);\n  }, 100);\n\n  setTimeout(() => {\n    div4.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div4.style.color = TRANSPARENT;\n    // div4.style.color = BLUE;\n    div4.style.backgroundColor = TRANSPARENT;\n    div4.style.fontStyle = \"normal\";\n    div4.style.fontSize = \"144px\";\n    div4.style.fontWeight = String(WEIGHTS[3]);\n    div4.style.position = \"absolute\";\n    div4.style.top = \"16px\";\n    // div4.style.top = \"0px\";\n    div4.style.left = \"16px\";\n    div4.innerText = TEXT;\n    app.appendChild(div4);\n  }, 150);\n\n  setTimeout(() => {\n    app.removeChild(div4);\n  }, 200);\n  setTimeout(() => {\n    app.removeChild(div3);\n  }, 225);\n  setTimeout(() => {\n    app.removeChild(div2);\n  }, 250);\n  setTimeout(() => {\n    app.removeChild(div1);\n  }, 275);\n}\n\nlet intervalId: number;\nconst BPM = 140;\nconsole.log(\"target bpm\", BPM);\nconsole.log(\"time between beats\", Math.round((60 * 1000) / BPM));\nconsole.log(\"best bpm\", (60 * 1000) / Math.round((60 * 1000) / BPM));\n\nconst initAnim = (bpm?: number) => {\n  // TODO better timing\n  if (intervalId != null) clearInterval(intervalId);\n  document.getElementById(\"bpm-cur\")!.innerText = `BPM: ${Math.round(\n    bpm || BPM\n  )}`;\n  frame = 0;\n  fontAnim();\n  intervalId = setInterval(fontAnim, Math.round((60 * 1000) / (bpm || BPM)));\n};\n\nsetTimeout(() => initAnim(), 100);\n\nwindow.onclick = () => {\n  initAnim();\n};\n\nlet count = 0;\nlet bpmAvg: number | null = null;\nlet msecsFirst = 0;\nlet msecsPrevious = 0;\n\nfunction resetCount() {\n  count = 0;\n  bpmAvg = null;\n  document.getElementById(\"bpm-avg\")!.innerText = \"\";\n}\n\nfunction tapForBPM(e: KeyboardEvent) {\n  if (e.key === \"r\") {\n    resetCount();\n    return;\n  }\n  if (e.key === \"c\" && bpmAvg != null) {\n    initAnim(bpmAvg);\n  }\n  if (e.key === \"s\") {\n    slideyBoi();\n    return;\n  }\n  if (e.key !== \"x\") {\n    return;\n  }\n  const msecs = performance.now();\n\n  const display = document.getElementById(\"bpm-avg\");\n  if (bpmAvg != null && msecs - msecsPrevious > 1000 * bpmAvg) {\n    count = 0;\n  }\n\n  if (count == 0) {\n    display!.innerText = \"FIRST BEAT\";\n    msecsFirst = msecs;\n    count = 1;\n  } else {\n    bpmAvg = (60000 * count) / (msecs - msecsFirst);\n    display!.innerText = String(Math.round(bpmAvg * 100) / 100);\n    count++;\n  }\n  msecsPrevious = msecs;\n  return true;\n}\n\nsetInterval(() => {\n  if (bpmAvg == null) return;\n\n  const msecs = performance.now();\n\n  if (msecs - msecsPrevious > 2000) {\n    resetCount();\n  }\n}, 2000);\n\ndocument.onkeypress = tapForBPM;\n"]}