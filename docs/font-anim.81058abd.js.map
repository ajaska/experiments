{"mappings":"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","sources":["src/font-anim/index.ts"],"names":["WEIGHTS","intervalId","frame","TRANSPARENT","WHITE","BLUE","TEXT","fontAnim","container","document","getElementById","Error","innerText","beat","measure","Math","floor","style","color","backgroundColor","fontStyle","setTimeout","fontWeight","String","removeProperty","length","setProperty","concat","console","log","round","initAnim","bpm","clearInterval","setInterval","window","onclick","count","bpmAvg","msecsFirst","msecsPrevious","resetCount","performance","now","onkeypress","e","key","app","div1","createElement","div2","div3","div4","fontSize","position","top","left","appendChild","removeChild","msecs","display"],"version":3,"file":"font-anim.81058abd.js.map","sourcesContent":["const WEIGHTS = [300, 400, 500, 600];\n\nfunction random<T>(arr: T[]): T {\n  if (arr.length === 0) throw new Error(\"Array too short\");\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nlet frame = 0;\n\nconst TRANSPARENT = \"rgba(0, 0, 0, 0)\";\nconst WHITE = \"#ffffff\";\nconst BLUE = \"#0000ff\";\n\nconst TEXT = \"(*´ ✖̥̥̥̥̥﹏✖̥̥̥̥̥)\";\n\nfunction fontAnim() {\n  const container = document.getElementById(\"mainText\");\n  if (!container) throw new Error(\"Couldn't find text\");\n  container.innerText = TEXT;\n\n  const beat = frame % 4;\n  const measure = Math.floor(frame / 4);\n\n  if (beat === 0) {\n    {\n      container.style.color = WHITE;\n      container.style.backgroundColor = BLUE;\n      container.style.fontStyle = \"italic\";\n    }\n    setTimeout(() => {\n      container.style.color = BLUE;\n      container.style.backgroundColor = TRANSPARENT;\n      container.style.fontStyle = \"normal\";\n    }, 100);\n\n    setTimeout(() => {\n      container.style.color = WHITE;\n      container.style.backgroundColor = BLUE;\n      container.style.fontStyle = \"italic\";\n    }, 200);\n\n    setTimeout(() => {\n      container.style.color = BLUE;\n      container.style.backgroundColor = TRANSPARENT;\n      container.style.fontStyle = \"normal\";\n    }, 300);\n  }\n\n  if (measure % 2 === 0) {\n    // container.style.color = WHITE;\n    // container.style.backgroundColor = BLUE;\n    container.style.fontWeight = String(WEIGHTS[beat]);\n    container.style.removeProperty(\"-webkit-text-stroke\");\n  } else if (measure % 2 === 1) {\n    // container.style.color = BLUE;\n    // container.style.backgroundColor = WHITE;\n    container.style.fontWeight = String(WEIGHTS[WEIGHTS.length - 1 - beat]);\n    container.style.removeProperty(\"-webkit-text-stroke\");\n  } else if (measure % 4 === 2) {\n    container.style.color = BLUE;\n    container.style.backgroundColor = BLUE;\n    container.style.setProperty(\"-webkit-text-stroke\", `2px ${WHITE}`);\n\n    container.style.fontWeight = String(WEIGHTS[beat]);\n  } else if (measure % 4 === 3) {\n    container.style.color = WHITE;\n    container.style.backgroundColor = WHITE;\n    container.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n\n    container.style.fontWeight = String(WEIGHTS[WEIGHTS.length - 1 - beat]);\n  }\n\n  frame++;\n  console.log(`${measure + 1}.${beat + 1}`);\n}\n\nfunction slideyBoi() {\n  const app = document.getElementById(\"appContainer\")!;\n  const div1 = document.createElement(\"div\");\n  const div2 = document.createElement(\"div\");\n  const div3 = document.createElement(\"div\");\n  const div4 = document.createElement(\"div\");\n  setTimeout(() => {\n    div1.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div1.style.color = TRANSPARENT;\n    div1.style.backgroundColor = TRANSPARENT;\n    div1.style.fontStyle = \"normal\";\n    div1.style.fontSize = \"144px\";\n    div1.style.fontWeight = String(WEIGHTS[0]);\n    div1.style.position = \"absolute\";\n    div1.style.top = \"4px\";\n    // div1.style.top = \"0px\";\n    div1.style.left = \"4px\";\n    div1.innerText = TEXT;\n    app.appendChild(div1);\n  }, 0);\n\n  setTimeout(() => {\n    div2.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div2.style.color = TRANSPARENT;\n    div2.style.backgroundColor = TRANSPARENT;\n    div2.style.fontStyle = \"normal\";\n    div2.style.fontSize = \"144px\";\n    div2.style.fontWeight = String(WEIGHTS[1]);\n    div2.style.position = \"absolute\";\n    div2.style.top = \"8px\";\n    // div2.style.top = \"0px\";\n    div2.style.left = \"8px\";\n    div2.innerText = TEXT;\n    app.appendChild(div2);\n  }, 50);\n\n  setTimeout(() => {\n    //div3.style.color = BLUE;\n    div3.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div3.style.color = TRANSPARENT;\n    div3.style.backgroundColor = TRANSPARENT;\n    div3.style.fontStyle = \"normal\";\n    div3.style.fontSize = \"144px\";\n    div3.style.fontWeight = String(WEIGHTS[2]);\n    div3.style.position = \"absolute\";\n    div3.style.top = \"12px\";\n    // div3.style.top = \"0px\";\n    div3.style.left = \"12px\";\n    div3.innerText = TEXT;\n    app.appendChild(div3);\n  }, 100);\n\n  setTimeout(() => {\n    div4.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div4.style.color = TRANSPARENT;\n    // div4.style.color = BLUE;\n    div4.style.backgroundColor = TRANSPARENT;\n    div4.style.fontStyle = \"normal\";\n    div4.style.fontSize = \"144px\";\n    div4.style.fontWeight = String(WEIGHTS[3]);\n    div4.style.position = \"absolute\";\n    div4.style.top = \"16px\";\n    // div4.style.top = \"0px\";\n    div4.style.left = \"16px\";\n    div4.innerText = TEXT;\n    app.appendChild(div4);\n  }, 150);\n\n  setTimeout(() => {\n    app.removeChild(div4);\n  }, 200);\n  setTimeout(() => {\n    app.removeChild(div3);\n  }, 225);\n  setTimeout(() => {\n    app.removeChild(div2);\n  }, 250);\n  setTimeout(() => {\n    app.removeChild(div1);\n  }, 275);\n}\n\nlet intervalId: number;\nconst BPM = 106;\nconsole.log(\"target bpm\", BPM);\nconsole.log(\"time between beats\", Math.round((60 * 1000) / BPM));\nconsole.log(\"best bpm\", (60 * 1000) / Math.round((60 * 1000) / BPM));\n\nconst initAnim = (bpm?: number) => {\n  // TODO better timing\n  if (intervalId != null) clearInterval(intervalId);\n  frame = 0;\n  fontAnim();\n  intervalId = setInterval(fontAnim, Math.round((60 * 1000) / (bpm || BPM)));\n};\n\nsetTimeout(() => initAnim(), 100);\n\nwindow.onclick = () => {\n  initAnim();\n};\n\nlet count = 0;\nlet bpmAvg: number | null = null;\nlet msecsFirst = 0;\nlet msecsPrevious = 0;\n\nfunction resetCount() {\n  count = 0;\n  bpmAvg = null;\n  document.getElementById(\"bpm-avg\")!.innerText = \"\";\n}\n\nfunction tapForBPM(e: KeyboardEvent) {\n  if (e.key === \"r\") {\n    resetCount();\n    return;\n  }\n  if (e.key === \"c\" && bpmAvg != null) {\n    initAnim(bpmAvg);\n  }\n  if (e.key === \"s\") {\n    slideyBoi();\n    return;\n  }\n  if (e.key !== \"x\") {\n    return;\n  }\n  const msecs = performance.now();\n\n  const display = document.getElementById(\"bpm-avg\");\n  if (bpmAvg != null && msecs - msecsPrevious > 1000 * bpmAvg) {\n    count = 0;\n  }\n\n  if (count == 0) {\n    display!.innerText = \"FIRST BEAT\";\n    msecsFirst = msecs;\n    count = 1;\n  } else {\n    bpmAvg = (60000 * count) / (msecs - msecsFirst);\n    display!.innerText = String(Math.round(bpmAvg * 100) / 100);\n    count++;\n  }\n  msecsPrevious = msecs;\n  return true;\n}\n\nsetInterval(() => {\n  if (bpmAvg == null) return;\n\n  const msecs = performance.now();\n\n  if (msecs - msecsPrevious > 2000) {\n    resetCount();\n  }\n}, 2000);\n\ndocument.onkeypress = tapForBPM;\n"]}