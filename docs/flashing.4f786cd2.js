!async function(){const e=document.getElementById("gif"),t=new window.SuperGif({gif:e});let o=!1,n=0;t.load(()=>{console.log("Frames: ",t.get_length()),n=t.get_length(),o=!0});const l=await async function(){return await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})}();console.log(l);const a=new AudioContext({sampleRate:44100}),r=a.createMediaStreamSource(l),c=a.createScriptProcessor(1024,1,1);c.connect(a.destination),r.connect(c);const s=new WebSocket("ws://192.168.1.249:9001");let d=0;c.onaudioprocess=e=>{d>0?d-=1:function(e,t){e.send(String(Math.floor(performance.now()))),e.send(t.buffer)}(s,e.inputBuffer.getChannelData(0))},s.onerror=s.onclose=()=>{c.onaudioprocess=null};const i=document.getElementById("app"),g=document.getElementById("app2"),u=document.getElementById("bpm"),m=[document.getElementById("beat1"),document.getElementById("beat2"),document.getElementById("beat3"),document.getElementById("beat4")];let y=0,p=0;function b(e){return`hsl(240, 100%, ${Math.floor(100-e/2)}%)`}window.onclick=()=>{p=3};let f=0;s.onmessage=e=>{y+=1;let[l,a]=e.data.split("|");if(y%5==0){const e=Math.floor(performance.now())-Number(l);console.log("RTT",e),e>500&&(d=10),e<100&&(d=0)}const r=JSON.parse(a);if(r.b&&(p=(p+1)%4),r.b)m[p].style.backgroundColor=i.style.backgroundColor="#0000FF",f=0;else if(r.b2){const e=10*Math.max(Math.min(r.a,10),0);m[p].style.backgroundColor=i.style.backgroundColor=b(e)}else m[p].style.backgroundColor="#EAEAEA",i.style.backgroundColor="#FFFFFF";let c;f=Math.max(f,r.a),m[p].innerText=String(f),r.p>90&&(m[(p+1)%4].style.backgroundColor=b(r.p/2)),c=r.b&&p%2==0?0:Math.floor(r.p/100*n),o&&t.get_current_frame()!=c&&t.move_to(c),g.style.backgroundColor=`hsl(${Math.floor(240+90*p+90*r.p/100)%360}, 100%, 50%)`,u.innerText=r.t},i.style.width="400px",i.style.height="400px",i.style.backgroundColor="#FFFFFF",g.style.width="400px",g.style.height="100px",g.style.backgroundColor="#FFFFFF"}();
//# sourceMappingURL=flashing.4f786cd2.js.map
