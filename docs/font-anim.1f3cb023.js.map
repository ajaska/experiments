{"mappings":"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","sources":["src/font-anim/index.ts"],"names":["WEIGHTS","intervalId","frame","TRANSPARENT","WHITE","BLUE","fontAnim","container","document","getElementById","Error","beat","measure","Math","floor","style","color","backgroundColor","fontStyle","setTimeout","fontWeight","String","removeProperty","length","setProperty","concat","console","log","round","initAnim","bpm","clearInterval","setInterval","window","onclick","count","bpmAvg","msecsFirst","msecsPrevious","resetCount","innerText","performance","now","onkeypress","e","key","app","div1","createElement","div2","div3","div4","fontSize","position","top","left","appendChild","removeChild","msecs","display"],"version":3,"file":"font-anim.1f3cb023.js.map","sourcesContent":["const WEIGHTS = [300, 400, 500, 600];\n\nfunction random<T>(arr: T[]): T {\n  if (arr.length === 0) throw new Error(\"Array too short\");\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nlet frame = 0;\n\nconst TRANSPARENT = \"rgba(0, 0, 0, 0)\";\nconst WHITE = \"#ffffff\";\nconst BLUE = \"#0000ff\";\n\nfunction fontAnim() {\n  const container = document.getElementById(\"mainText\");\n  if (!container) throw new Error(\"Couldn't find text\");\n\n  const beat = frame % 4;\n  const measure = Math.floor(frame / 4);\n\n  if (beat === 0) {\n    {\n      container.style.color = WHITE;\n      container.style.backgroundColor = BLUE;\n      container.style.fontStyle = \"italic\";\n    }\n    setTimeout(() => {\n      container.style.color = BLUE;\n      container.style.backgroundColor = TRANSPARENT;\n      container.style.fontStyle = \"normal\";\n    }, 100);\n\n    setTimeout(() => {\n      container.style.color = WHITE;\n      container.style.backgroundColor = BLUE;\n      container.style.fontStyle = \"italic\";\n    }, 200);\n\n    setTimeout(() => {\n      container.style.color = BLUE;\n      container.style.backgroundColor = TRANSPARENT;\n      container.style.fontStyle = \"normal\";\n    }, 300);\n  }\n\n  if (measure % 2 === 0) {\n    // container.style.color = WHITE;\n    // container.style.backgroundColor = BLUE;\n    container.style.fontWeight = String(WEIGHTS[beat]);\n    container.style.removeProperty(\"-webkit-text-stroke\");\n  } else if (measure % 2 === 1) {\n    // container.style.color = BLUE;\n    // container.style.backgroundColor = WHITE;\n    container.style.fontWeight = String(WEIGHTS[WEIGHTS.length - 1 - beat]);\n    container.style.removeProperty(\"-webkit-text-stroke\");\n  } else if (measure % 4 === 2) {\n    container.style.color = BLUE;\n    container.style.backgroundColor = BLUE;\n    container.style.setProperty(\"-webkit-text-stroke\", `2px ${WHITE}`);\n\n    container.style.fontWeight = String(WEIGHTS[beat]);\n  } else if (measure % 4 === 3) {\n    container.style.color = WHITE;\n    container.style.backgroundColor = WHITE;\n    container.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n\n    container.style.fontWeight = String(WEIGHTS[WEIGHTS.length - 1 - beat]);\n  }\n\n  frame++;\n  console.log(`${measure + 1}.${beat + 1}`);\n}\n\nfunction slideyBoi() {\n  const app = document.getElementById(\"appContainer\")!;\n  const div1 = document.createElement(\"div\");\n  const div2 = document.createElement(\"div\");\n  const div3 = document.createElement(\"div\");\n  const div4 = document.createElement(\"div\");\n  setTimeout(() => {\n    div1.style.color = BLUE;\n    div1.style.backgroundColor = TRANSPARENT;\n    div1.style.fontStyle = \"normal\";\n    div1.style.fontSize = \"144px\";\n    div1.style.fontWeight = String(WEIGHTS[0]);\n    div1.style.position = \"absolute\";\n    div1.style.top = \"4px\";\n    // div1.style.top = \"0px\";\n    div1.style.left = \"4px\";\n    div1.innerText = \"@ajaska\";\n    app.appendChild(div1);\n  }, 0);\n\n  setTimeout(() => {\n    div2.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div2.style.color = TRANSPARENT;\n    div2.style.backgroundColor = TRANSPARENT;\n    div2.style.fontStyle = \"normal\";\n    div2.style.fontSize = \"144px\";\n    div2.style.fontWeight = String(WEIGHTS[1]);\n    div2.style.position = \"absolute\";\n    // div2.style.top = \"8px\";\n    div2.style.top = \"0px\";\n    div2.style.left = \"8px\";\n    div2.innerText = \"@ajaska\";\n    app.appendChild(div2);\n  }, 50);\n\n  setTimeout(() => {\n    //div3.style.color = BLUE;\n    div3.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div3.style.color = TRANSPARENT;\n    div3.style.backgroundColor = TRANSPARENT;\n    div3.style.fontStyle = \"normal\";\n    div3.style.fontSize = \"144px\";\n    div3.style.fontWeight = String(WEIGHTS[2]);\n    div3.style.position = \"absolute\";\n    div3.style.top = \"12px\";\n    // div3.style.top = \"0px\";\n    div3.style.left = \"12px\";\n    div3.innerText = \"@ajaska\";\n    app.appendChild(div3);\n  }, 100);\n\n  setTimeout(() => {\n    div4.style.setProperty(\"-webkit-text-stroke\", `2px ${BLUE}`);\n    div4.style.color = TRANSPARENT;\n    // div4.style.color = BLUE;\n    div4.style.backgroundColor = TRANSPARENT;\n    div4.style.fontStyle = \"normal\";\n    div4.style.fontSize = \"144px\";\n    div4.style.fontWeight = String(WEIGHTS[3]);\n    div4.style.position = \"absolute\";\n    div4.style.top = \"16px\";\n    // div4.style.top = \"0px\";\n    div4.style.left = \"16px\";\n    div4.innerText = \"@ajaska\";\n    app.appendChild(div4);\n  }, 150);\n\n  setTimeout(() => {\n    app.removeChild(div4);\n  }, 200);\n  setTimeout(() => {\n    app.removeChild(div3);\n  }, 225);\n  setTimeout(() => {\n    app.removeChild(div2);\n  }, 250);\n  setTimeout(() => {\n    app.removeChild(div1);\n  }, 275);\n}\n\nlet intervalId: number;\nconst BPM = 182;\nconsole.log(\"target bpm\", BPM);\nconsole.log(\"time between beats\", Math.round((60 * 1000) / BPM));\nconsole.log(\"best bpm\", (60 * 1000) / Math.round((60 * 1000) / BPM));\n\nconst initAnim = (bpm?: number) => {\n  // TODO better timing\n  if (intervalId != null) clearInterval(intervalId);\n  frame = 0;\n  fontAnim();\n  intervalId = setInterval(fontAnim, Math.round((60 * 1000) / (bpm || BPM)));\n};\n\nsetTimeout(() => initAnim(), 100);\n\nwindow.onclick = () => {\n  initAnim();\n};\n\nlet count = 0;\nlet bpmAvg: number | null = null;\nlet msecsFirst = 0;\nlet msecsPrevious = 0;\n\nfunction resetCount() {\n  count = 0;\n  bpmAvg = null;\n  document.getElementById(\"bpm-avg\")!.innerText = \"\";\n}\n\nfunction tapForBPM(e: KeyboardEvent) {\n  if (e.key === \"r\") {\n    resetCount();\n    return;\n  }\n  if (e.key === \"c\" && bpmAvg != null) {\n    initAnim(bpmAvg);\n  }\n  if (e.key === \"s\") {\n    slideyBoi();\n    return;\n  }\n  if (e.key !== \"x\") {\n    return;\n  }\n  const msecs = performance.now();\n\n  const display = document.getElementById(\"bpm-avg\");\n  if (bpmAvg != null && msecs - msecsPrevious > 1000 * bpmAvg) {\n    count = 0;\n  }\n\n  if (count == 0) {\n    display!.innerText = \"FIRST BEAT\";\n    msecsFirst = msecs;\n    count = 1;\n  } else {\n    bpmAvg = (60000 * count) / (msecs - msecsFirst);\n    display!.innerText = String(Math.round(bpmAvg * 100) / 100);\n    count++;\n  }\n  msecsPrevious = msecs;\n  return true;\n}\n\nsetInterval(() => {\n  if (bpmAvg == null) return;\n\n  const msecs = performance.now();\n\n  if (msecs - msecsPrevious > 2000) {\n    resetCount();\n  }\n}, 2000);\n\ndocument.onkeypress = tapForBPM;\n"]}