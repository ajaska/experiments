{"mappings":"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","sources":["./src/music-playground/widgets.min.js"],"sourcesContent":["var AudioSupervisor = (window.AudioSupervisor = function () {\n    var n,\n      e = this;\n    return (\n      (e.init = function (e) {\n        document.addEventListener &&\n          document.addEventListener(\"visibilitychange\", t),\n          (Tone.Transport.latencyHint = isMobile() ? 0.06 : \"fastest\"),\n          (n = []);\n      }),\n      (e.makeGestureOnElementResumeAudioContext = function (e) {\n        function t() {\n          Tone.context.resume().then(function () {\n            e.removeEventListener(\"touchstart\", t, !0),\n              e.removeEventListener(\"touchend\", t, !0),\n              e.removeEventListener(\"mousedown\", t, !0),\n              e.removeEventListener(\"mouseup\", t, !0),\n              e.removeEventListener(\"click\", t, !0);\n          });\n        }\n        e.addEventListener(\"touchstart\", t, !0),\n          e.addEventListener(\"touchend\", t, !0),\n          e.addEventListener(\"mousedown\", t, !0),\n          e.addEventListener(\"mouseup\", t, !0),\n          e.addEventListener(\"click\", t, !0);\n      }),\n      (e.registerPlayingWidget = function (e) {\n        // console.log('registered', e);\n        -1 == n.indexOf(e) && n.push(e);\n      }),\n      (e.unregisterPlayingWidget = function (t) {\n        // console.log('unregistered', t);\n        n = n.filter(function (e) {\n          return e != t;\n        });\n      }),\n      (e.isOnlyWidgetPlaying = function (e) {\n        return 1 === n.length && n[0] === e;\n      }),\n      (e.areAnyWidgetsPlaying = function () {\n        return 0 < n.length;\n      }),\n      (e.masterEffectChain = function () {\n        return Tone.Master;\n      }),\n      e\n    );\n    function t() {\n      document.hidden && Tone\n        ? Tone.Master.volume.rampTo(-1 / 0, 0.3)\n        : Tone && Tone.Master.volume.rampTo(0, 0.4);\n    }\n  }),\n  BrowserCompatibility = {\n    isBrowserCompatible: function () {\n      var e =\n          window.hasOwnProperty(\"AudioContext\") ||\n          window.hasOwnProperty(\"webkitAudioContext\"),\n        t = window.hasOwnProperty(\"Promise\"),\n        n = window.hasOwnProperty(\"Worker\");\n      return e && t && n;\n    },\n    appendCompatibilityWarning: function (e, t) {\n      var n = document.createElement(\"div\");\n      (n.className = \"widget__compatibility-message\"),\n        (n.innerHTML = t),\n        e.appendChild(n);\n    },\n  },\n  Drumkit = (window.Drumkit = function () {\n    var e,\n      i,\n      r,\n      t = this;\n    return (\n      (t.init = function (o) {\n        if (e) return e;\n        return (e = new Promise(function (e) {\n          var t = o.map(function (e) {\n              return { path: e.path, name: e.midi + \"\" };\n            }),\n            n = SAMPLE_CACHE.getBuffers(t);\n          ((r = new Tone.MultiPlayer(n).toMaster()).fadeOut = 0.01),\n            (i = e),\n            Tone.Buffer.on(\"progress\", a),\n            Tone.Buffer.on(\"load\", a),\n            a();\n        }));\n      }),\n      (t.playNoteAtNumber = n),\n      (t.playNotes = function (e) {\n        e.forEach(function (t) {\n          e.some(function (e) {\n            return t.lane.midi === e.lane.choke;\n          }) || n(t.lane.midi, t.time, t.lane.choke);\n        });\n      }),\n      (t.stopAll = function () {\n        r.stopAll();\n      }),\n      t\n    );\n    function a() {\n      r.buffers.loaded && i();\n    }\n    function n(e, t, n) {\n      r.start(e + \"\", t), n && Workarounds.multiplayerStopAll(r, n + \"\", t);\n    }\n  }),\n  KeySupervisor = (window.KeySupervisor = function () {\n    var t,\n      o,\n      i,\n      r,\n      e = this;\n    return (\n      (e.init = function (e) {\n        document.addEventListener(\n          \"keydown\",\n          function (e) {\n            !(function (e) {\n              return !0 === t[e.keyCode];\n            })(e) && ((t[e.keyCode] = !0), o && o(e));\n          },\n          !0\n        ),\n          document.addEventListener(\n            \"keyup\",\n            function (e) {\n              (t[e.keyCode] = !1), i && i(e);\n            },\n            !0\n          ),\n          document.addEventListener &&\n            document.addEventListener(\"visibilitychange\", n),\n          (t = {});\n      }),\n      (e.connectWidget = function (e, t, n) {\n        r && r();\n        (o = e), (i = t), (r = n);\n      }),\n      e\n    );\n    function n() {\n      document.hidden && r && (r(), (r = i = o = null));\n    }\n  }),\n  LiveSetExport = {\n    serviceURL: \"https://learningmusic-export.ableton.com\",\n    checkExportServiceAvailablility: function (e) {\n      var t = new XMLHttpRequest();\n      (t.timeout = 5e3),\n        t.addEventListener(\"load\", function () {\n          e(!0);\n        }),\n        t.addEventListener(\"error\", function () {\n          e(!1);\n        }),\n        t.addEventListener(\"abort\", function () {\n          e(!1);\n        }),\n        t.addEventListener(\"timeout\", function () {\n          e(!1);\n        }),\n        t.open(\"GET\", LiveSetExport.serviceURL + \"/availability\"),\n        t.send();\n    },\n    createLiveSet: function (e, t, n) {\n      var o = new Date().toDateString().replace(/[^a-z0-9]/gi, \"_\"),\n        i = {\n          backlink: window.location.href,\n          name: \"idea_\" + o,\n          tempo: e,\n          tracks: t,\n        };\n      if (!LiveSetExport.userHasAlreadyExportedOnce())\n        var r = window.open(\n          LOCALE_PATH + \"/live-set-export-waiting.html\",\n          \"_blank\"\n        );\n      var a = new XMLHttpRequest();\n      a.addEventListener(\"load\", function () {\n        n(void 0);\n        var e = this.responseText;\n        if (LiveSetExport.userHasAlreadyExportedOnce())\n          LiveSetExport.isValidFileId(e) &&\n            (window.location = LiveSetExport.downloadURLFromFileId(e));\n        else {\n          storageAvailable(\"localStorage\") &&\n            localStorage.setItem(\"__userHasExported\", \"yes\");\n          var t = \"?fileId=\" + e;\n          r.location.href = LOCALE_PATH + \"/live-set-export.html\" + t;\n        }\n      }),\n        a.addEventListener(\"error\", function () {\n          n(\"Export failed.\");\n        }),\n        a.addEventListener(\"abort\", function () {\n          n(\"Export was cancelled.\");\n        }),\n        a.open(\"POST\", LiveSetExport.serviceURL + \"/export\"),\n        a.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\"),\n        a.send(JSON.stringify(i));\n    },\n    downloadURLFromFileId: function (e) {\n      return LiveSetExport.serviceURL + \"/export?id=\" + e;\n    },\n    userHasAlreadyExportedOnce: function () {\n      return (\n        !!storageAvailable(\"localStorage\") &&\n        \"yes\" == localStorage.getItem(\"__userHasExported\")\n      );\n    },\n    isValidFileId: function (e) {\n      return e.match(\n        \"[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}\"\n      );\n    },\n    createDownloadLink: function (e, t) {\n      var n,\n        o,\n        i,\n        r =\n          ((n = \"fileId\"),\n          (o = window.location.href),\n          (i = new RegExp(\"[?&]\" + n + \"=([^&#]*)\", \"i\").exec(o))\n            ? i[1]\n            : null);\n      if (LiveSetExport.isValidFileId(r)) {\n        void 0 === t && (t = \"\");\n        var a = document.createElement(\"a\"),\n          s = document.createTextNode(\"Download\");\n        a.appendChild(s),\n          (a.title = \"Download your music as an Ableton Live Set\"),\n          (a.href = LiveSetExport.downloadURLFromFileId(r)),\n          (a.className = t),\n          document.getElementById(e).appendChild(a),\n          a.addEventListener(\"click\", function () {\n            a.style.display = \"none\";\n          });\n      } else\n        document.getElementById(e).innerHTML =\n          \"Error exporting to Live. Please try again.\";\n    },\n  },\n  LiveSetExporter = (window.LiveSetExporter = function () {\n    var i;\n    return (\n      (this.init = function () {\n        i = [];\n      }),\n      (this.registerWidget = function (e) {\n        i.push(e),\n          e.bind(\"export\", function (e, t) {\n            var n = e.getExportInfo();\n            if (\"takeover\" === e.getConfig().onPlay)\n              LiveSetExport.createLiveSet(n.tempo, n.tracks, t);\n            else {\n              var o = i.reduce(function (e, t) {\n                return e.concat(t.getExportInfo().tracks);\n              }, []);\n              LiveSetExport.createLiveSet(n.tempo, o, t);\n            }\n          });\n      }),\n      this\n    );\n  }),\n  Loader = (window.Loader = function () {\n    var t, n;\n    return (\n      (this.init = function (e) {\n        ((t = document.createElement(\"div\")).id = e.widgetId + \"loader\"),\n          (t.className = \"\"),\n          ((n = document.createElement(\"div\")).className =\n            \"widget-loader__loading-animation\"),\n          t.appendChild(n),\n          document.getElementById(e.widgetId).appendChild(t);\n      }),\n      (this.hide = function () {\n        t.style.display = \"none\";\n      }),\n      (this.onAudioLoaded = function () {\n        n.style.display = \"none\";\n      }),\n      this\n    );\n  }),\n  Metronome = (window.Metronome = function () {\n    var o, t;\n    return (\n      (this.init = function (e) {\n        var t = pathToWidgetSounds(),\n          n = {\n            metro: t + \"metronome/Metronome\" + getAudioExtension(),\n            metroup: t + \"metronome/MetronomeUp\" + getAudioExtension(),\n          };\n        (o = new Tone.MultiPlayer(n, i).toMaster()).volume.value = 12;\n      }),\n      (this.start = function (e) {\n        i(), t.start(e);\n      }),\n      (this.stop = function (e) {\n        t.stop(e), t.dispose();\n      }),\n      this\n    );\n    function i() {\n      t = new Tone.Sequence(\n        function (e, t) {\n          o.start(t, e);\n        },\n        [\"metroup\", \"metro\", \"metro\", \"metro\"],\n        \"4n\"\n      );\n    }\n  }),\n  Piano = (window.Piano = function () {\n    var e,\n      d,\n      u,\n      i,\n      c,\n      t = this;\n    return (\n      (t.init = function (l) {\n        (i = l),\n          (e =\n            e ||\n            new Promise(function (e) {\n              var t,\n                n,\n                o,\n                i,\n                r = l.samples.map(function (e) {\n                  return { path: e.path, name: e.midi + \"\" };\n                }),\n                a = SAMPLE_CACHE.getBuffers(r);\n              (u = new Tone.MultiPlayer(a)).connect(\n                SUPERVISOR.masterEffectChain()\n              ),\n                (u.fadeOut = l.fadeout.duration),\n                (c = []);\n              for (var s = 0; s < 128; s++)\n                c.push(\n                  ((t = s),\n                  (n = l.samples),\n                  void 0,\n                  (o = n.map(function (e) {\n                    return e.midi;\n                  })),\n                  { val: (i = nearest(t, o)), offset: t - i })\n                );\n              (d = e),\n                Tone.Buffer.on(\"progress\", p),\n                Tone.Buffer.on(\"load\", p),\n                p();\n            }));\n        return e;\n      }),\n      (t.playNoteAtFrequency = function (e, t, n) {\n        o(Math.round(Tone.Frequency(e).toMidi()), t, n);\n      }),\n      (t.playNoteAtNumber = o),\n      (t.stopAll = function () {\n        u.stopAll();\n      }),\n      t\n    );\n    function p() {\n      u.buffers.loaded && d();\n    }\n    function o(e, t, n) {\n      var o = c[e];\n      u.start(o.val + \"\", t, 0, n + \"-\" + i.fadeout.offset, o.offset);\n    }\n  }),\n  Recorder = (window.Recorder = function () {\n    var t;\n    return (\n      (this.init = function (e) {}),\n      (this.recordEvent = function (e) {\n        t && t(e);\n      }),\n      (this.connect = function (e) {\n        t = e;\n      }),\n      this\n    );\n  }),\n  SampleCache = (window.SampleCache = function () {\n    var i,\n      n = this;\n    return (\n      (n.init = function () {\n        i = new Tone.Buffers();\n      }),\n      (n.getBuffer = function (e, t) {\n        {\n          if (i.has(e)) return i.get(e);\n          var n = t || getAudioExtension(),\n            o = pathToWidgetSounds() + e + n;\n          return i.add(e, o), i.get(e);\n        }\n      }),\n      (n.getBuffers = function (e) {\n        var t = new Tone.Buffers();\n        return (\n          e.forEach(function (e) {\n            t.add(e.name, n.getBuffer(e.path, e.extension));\n          }),\n          t\n        );\n      }),\n      n\n    );\n  }),\n  SingleTouchObserver = (window.SingleTouchObserver = function () {\n    var r;\n    return (\n      (this.init = function (e) {\n        (r = e),\n          d3\n            .select(e.node)\n            .append(\"div\")\n            .attr(\"class\", \"mouseObserver\")\n            .style(\"width\", \"100%\")\n            .style(\"height\", \"100%\")\n            .on(\"mousedown\", t)\n            .on(\"touchstart\", t);\n      }),\n      this\n    );\n    function t() {\n      if (\"mousedown\" !== d3.event.type || 0 === d3.event.button) {\n        var t = d3.select(this).classed(\"active\", !0),\n          n = d3\n            .select(window)\n            .on(\"touchmove\", o)\n            .on(\"mousemove\", o)\n            .on(\"mouseup\", i)\n            .on(\"touchend\", i),\n          e = d3.mouse(this);\n        r.onDown(e[0], e[1]),\n          document.activeElement && document.activeElement.blur(),\n          d3.event.preventDefault();\n      }\n      function o() {\n        var e = d3.mouse(t.node());\n        r.onMove(e[0], e[1]);\n      }\n      function i() {\n        var e = d3.mouse(t.node());\n        n\n          .on(\"touchmove\", null)\n          .on(\"mousemove\", null)\n          .on(\"mouseup\", null)\n          .on(\"touchend\", null),\n          r.onUp(e[0], e[1]);\n      }\n    }\n  }),\n  Tooltip = {\n    inject: function (e, t, n, o, i) {\n      if (t && e && !(Tooltip.userHasSeenTooltip(t.name) && !t.showalways)) {\n        e.getBoundingClientRect();\n        (xShiftFactor = 0),\n          \"left\" == i\n            ? (xShiftFactor = 0.25)\n            : \"right\" == i && (xShiftFactor = -0.25),\n          (xShiftInPx = 200 * xShiftFactor);\n        var r = document.createElement(\"div\");\n        (r.className = \"widget-tooltip\"),\n          (r.style.width = \"200px\"),\n          (r.style.top = n || \"100%\"),\n          (r.style.left = o || \"50%\"),\n          (r.style.marginTop = \"12px\"),\n          (r.style.marginLeft = -100 + xShiftInPx + \"px\");\n        var a = document.createElement(\"div\");\n        (a.className = \"widget-tooltip__triangle\"),\n          (a.style.top = \"-20px\"),\n          (a.style.left = 90 - xShiftInPx + \"px\"),\n          (a.style.border = \"solid 10px\"),\n          (a.style.borderColor = \"transparent transparent black transparent\"),\n          r.appendChild(a);\n        var s = document.createElement(\"div\");\n        (s.className = \"widget-tooltip__text\"),\n          (s.innerHTML = t[\"@text\"]),\n          r.appendChild(s);\n        var l = document.createElement(\"div\");\n        (l.className = \"widget-tooltip__dismiss\"),\n          (l.innerHTML = t[\"@close\"] ? t[\"@close\"] : \"Close\"),\n          r.appendChild(l),\n          r.addEventListener(\"click\", function () {\n            r.classList.add(\"widget-tooltip--hide\"),\n              Tooltip.setUserHasSeenTooltip(t.name);\n          }),\n          e.appendChild(r);\n      }\n    },\n    tooltipKeyForLocalStorage: function (e) {\n      return \"__tooltip_\" + e;\n    },\n    userHasSeenTooltip: function (e) {\n      return (\n        !!storageAvailable(\"localStorage\") &&\n        \"dismissed\" ==\n          localStorage.getItem(Tooltip.tooltipKeyForLocalStorage(e))\n      );\n    },\n    setUserHasSeenTooltip: function (e) {\n      storageAvailable(\"localStorage\") &&\n        localStorage.setItem(Tooltip.tooltipKeyForLocalStorage(e), \"dismissed\");\n    },\n    appendTooltippableChild: function (e, t) {\n      var n = document.createElement(\"div\");\n      (n.style.position = \"relative\"), n.appendChild(t), e.appendChild(n);\n    },\n  },\n  Transport = (window.Transport = function () {\n    var t,\n      n,\n      o,\n      i,\n      r,\n      a,\n      s,\n      e = this;\n    return (\n      (e.init = function (e) {\n        (n = e),\n          ((t = document.createElement(\"div\")).className = \"widget-transport\"),\n          e.node.appendChild(t),\n          ((o = document.createElement(\"button\")).onclick = m),\n          Tooltip.appendTooltippableChild(t, o),\n          o.parentElement.classList.add(\"widget__transport-btn-wrapper\"),\n          ((i = document.createElement(\"button\")).onclick = g),\n          Tooltip.appendTooltippableChild(t, i),\n          i.parentElement.classList.add(\"widget__transport-btn-wrapper\"),\n          (r = \"stopped\"),\n          (a = !1),\n          (s = e.tempo),\n          Tone.Transport.on(\"takeover\", c),\n          Tone.Transport.on(\"sessionTempoChanged\", l),\n          d();\n      }),\n      (e.isRecording = function () {\n        return a;\n      }),\n      (e.isPlaying = function () {\n        return \"playing\" == r;\n      }),\n      (e.getTempo = function () {\n        return s;\n      }),\n      (e.setTempo = function (e) {\n        (s = e),\n          (\"join\" == n.onPlay || (\"takeover\" == n.onPlay && \"playing\" == r)) &&\n            ((Tone.Transport.bpm.value = s),\n            Tone.Transport.emit(\"sessionTempoChanged\", s));\n        n.onTempoChanged && n.onTempoChanged(s);\n      }),\n      (e.playButton = function () {\n        return o;\n      }),\n      (e.recordButton = function () {\n        return i;\n      }),\n      e\n    );\n    function l(e) {\n      // console.log(\"l\", \"e\");\n      \"join\" == n.onPlay && ((s = e), n.onTempoChanged && n.onTempoChanged(s));\n    }\n    function d() {\n      (o.innerHTML = {\n        playing: \"<i class='icon-pause'></i>\",\n        queued: \"<i class='icon-play widget_transport-icon--queued'></i>\",\n        stopped: \"<i class='icon-play'></i>\",\n      }[r]),\n        (o.className = \"btn widget__transport-btn\"),\n        (function () {\n          i.innerHTML = \"<i class='icon-record'></i>\";\n          var e = n.showRecordButton ? \"\" : \" hidden\";\n          i.className =\n            a && \"playing\" == r\n              ? \"btn widget__transport-btn widget-button--recording\" + e\n              : \"btn widget__transport-btn\" + e;\n        })();\n    }\n    function u() {\n      a && ((a = !1), METRONOME.stop()),\n        n.onStopPlayback(),\n        SUPERVISOR.unregisterPlayingWidget(n.widgetId),\n        (r = \"stopped\"),\n        d();\n    }\n    function c(e) {\n      \"playing\" == r && u();\n    }\n    function p() {\n      (Tone.Transport.bpm.value = s),\n        (Tone.Transport.position = \"0:0:0\"),\n        Tone.Transport.start(ToneTransportStartDelay()),\n        a && METRONOME.start(),\n        n.onStartPlayback(),\n        SUPERVISOR.registerPlayingWidget(n.widgetId),\n        (r = \"playing\"),\n        d();\n    }\n    function f() {\n      (Tone.Transport.position = \"0:0:0\"), Tone.Transport.stop(), u();\n    }\n    // \"Toggle playback\"\n    function m() {\n      // console.log(\"m\", n.widgetId);\n      if ((!0, \"queued\" != r))\n        if (SUPERVISOR.areAnyWidgetsPlaying()) {\n          if (SUPERVISOR.areAnyWidgetsPlaying()) {\n            var e = \"playing\" == r;\n            \"takeover\" == n.onPlay\n              ? e\n                ? f()\n                : (Tone.Transport.emit(\"takeover\"), f(), p())\n              : \"join\" == n.onPlay &&\n                (e\n                  ? SUPERVISOR.isOnlyWidgetPlaying(n.widgetId)\n                    ? f()\n                    : c()\n                  : (a && METRONOME.start(\"@1m\"),\n                    Tone.Transport.scheduleOnce(function (e) {\n                      (r = \"playing\"), d();\n                    }, \"@1m\"),\n                    n.onStartQuantizedPlayback(),\n                    SUPERVISOR.registerPlayingWidget(n.widgetId),\n                    (r = \"queued\"),\n                    d()));\n          }\n        } else p();\n      // console.log(r)\n    }\n    function g() {\n      (a = !a),\n        \"playing\" == r\n          ? a\n            ? METRONOME.start(\"0:0:0\")\n            : METRONOME.stop()\n          : m(),\n        d();\n    }\n  });\nfunction getSixteenths(e) {\n  return parseFloat(e.split(\":\")[2]);\n}\nfunction getBeats(e) {\n  return parseFloat(e.split(\":\")[1]);\n}\nfunction getBars(e) {\n  return parseFloat(e.split(\":\")[0]);\n}\nfunction getTotalBeats(e) {\n  return 4 * getBars(e) + getBeats(e) + getSixteenths(e) / 4;\n}\nfunction beatsAsBarsBeatsSixteenths(e) {\n  return Tone.Time(\"0:1:0 * \" + e).toBarsBeatsSixteenths();\n}\nfunction canPlayAudio(e) {\n  return Tone.Buffer.supportsType(e);\n}\nfunction getAudioExtension() {\n  var e = \".wav\";\n  return (\n    canPlayAudio(\"ogg\") ? (e = \".ogg\") : canPlayAudio(\"mp4\") && (e = \".mp4\"), e\n  );\n}\nfunction pathToWidgetSounds() {\n  return \"./sounds/\";\n}\nfunction pctInRange(e, t, n) {\n  return (n - e) / (t - e);\n}\nfunction fitsInRange(e, t, n) {\n  return e <= n && n <= t;\n}\nfunction almostEqual(e, t, n) {\n  return null == n && (n = 0.001), Math.abs(e - t) < n;\n}\nfunction nearest(e, t) {\n  for (var n = Number.MAX_VALUE, o = 0; o < t.length; o++) {\n    var i = t[o],\n      r = Math.abs(e - n);\n    Math.abs(e - i) <= r && (n = i);\n  }\n  return n;\n}\nfunction assert(e, t) {\n  if (!e) {\n    if (((t = t || \"Assertion failed\"), \"undefined\" != typeof Error))\n      throw new Error(t);\n    throw t;\n  }\n}\nfunction storageAvailable(e) {\n  try {\n    var t = window[e],\n      n = \"__storage_test__\";\n    return t.setItem(n, n), t.removeItem(n), !0;\n  } catch (e) {\n    return !1;\n  }\n}\n\n// BEGIN ARLAN CODE\nfunction connectToWebsocket() {\n  const ws_url =\n    process.env.NODE_ENV === \"development\"\n      ? \"ws://localhost:1238\"\n      : \"wss://experiments-do.ajaska.com:443/music-playground/\";\n  const ws = new WebSocket(ws_url);\n  ws.onmessage = (e) => {\n    const message = JSON.parse(e.data)\n    switch (message.type) {\n      case \"state\": {\n        const pianoRoll = window[message.model]\n        const { transport, modelSetter } = pianoRoll.getLiveAdjustThings()\n        const state = JSON.parse(message.state)\n        if (transport)\n          transport.setTempo(state.tempo)\n        if (modelSetter)\n          modelSetter.setModel(state)\n        return\n      }\n      case \"sound\": {\n        const pianoRoll = window[message.model]\n        const { player } = pianoRoll.getLiveAdjustThings()\n        player.trigger(\"playNotes\", message.sound);\n        return\n      }\n      default: {\n        throw new Error(\"Unable to handle message\", message)\n      }\n    }\n  }\n\n  ws.onopen = () => {\n    const statusElement = document.getElementById(\"connection-status\");\n    statusElement.innerHTML = \"[[ CONNECTION: Online ]]\"\n    statusElement.className = \"online\"\n  }\n  ws.onclose = () => {\n    const statusElement = document.getElementById(\"connection-status\");\n    statusElement.innerHTML = \"[[ CONNECTION: Lost, reconnecting... ]]\"\n    statusElement.className = \"\"\n\n    window.setTimeout(() => connectToWebsocket(), 5000)\n  }\n\n  window.arlan_ws = ws\n}\nwindow.setTimeout(() => connectToWebsocket(), 500)\n\n// END ARLAN CODE\n\n// ARLAN NOTE: use these functions\nfunction getSavedModelString(e) {\n// console.log(\"gsms\", e)\n// console.trace()\n  return storageAvailable(\"localStorage\") ? localStorage.getItem(e) : void 0;\n}\nfunction getSavedModel(e) {\n  try {\n    return JSON.parse(getSavedModelString(e));\n  } catch (e) {\n    return;\n  }\n}\nfunction tryRestoreApp(e, t, n) {\n  var o = getSavedModel(e);\n  if (o && o.version == n) return t.ports.importModel.send(o), o;\n}\nfunction trySaveState(e, t, n) {\n  // ARLAN NOTE: reliably called on every update\n  // console.log(\"persisting state\", e /* state */, t /* name */, n /* version */) \n  if (storageAvailable(\"localStorage\"))\n    try {\n      var o = e;\n      o.version = n;\n      var i = JSON.stringify(o);\n      localStorage.setItem(t, i); // , isDeveloperMode() && console.log(i);\n\n      // BEGIN ARLAN CODE\n      if (window.arlan_ws) {\n        window.arlan_ws.send(JSON.stringify({ type: \"state\", model: t, state: i }))\n      }\n      // END ARLAN CODE\n    } catch (e) {\n      return;\n    }\n}\nvar DEVELOPER_MODE = !1;\nfunction isDeveloperMode() {\n  return window.location.href.includes(\"localhost\") || DEVELOPER_MODE;\n}\nfunction isMobile() {\n  return !!(\n    navigator.userAgent.match(/Android/i) ||\n    navigator.userAgent.match(/webOS/i) ||\n    navigator.userAgent.match(/iPhone/i) ||\n    navigator.userAgent.match(/iPad/i) ||\n    navigator.userAgent.match(/iPod/i) ||\n    navigator.userAgent.match(/BlackBerry/i) ||\n    navigator.userAgent.match(/Windows Phone/i)\n  );\n}\nfunction isChromeOnIOS() {\n  return !!navigator.userAgent.match(\"CriOS\");\n}\nfunction keyFromPhysicalCode(e) {\n  return e.includes(\"Digit\")\n    ? e.split(\"Digit\")[1]\n    : e.includes(\"Key\")\n    ? e.split(\"Key\")[1]\n    : void 0;\n}\nfunction keyEventToPhysicalKey(e) {\n  return e.code ? keyFromPhysicalCode(e.code) : String.fromCharCode(e.keyCode);\n}\nfunction clearCookies() {\n  function n(e, t) {\n    document.cookie = t\n      ? e +\n        \"=; Path=/; Domain=\" +\n        t +\n        \"; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\"\n      : e + \"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\n  }\n  try {\n    document.cookie.split(\";\").forEach(function (e) {\n      var t = e.split(\"=\")[0];\n      t && 0 === t.indexOf(\"_g\") ? n(t, document.domain) : t && n(t);\n    });\n  } catch (e) {\n    console.log();\n  }\n}\nfunction ToneTransportStartDelay() {\n  return \"+0.1\";\n}\nclearCookies();\nvar GLOBAL_PITCHPAD_SYNTH,\n  Workarounds = {\n    multiplayerStopAll: function (e, t, n) {\n      try {\n        for (;;) e.stop(t, n);\n      } catch (e) {}\n    },\n  },\n  PitchpadSynth = (window.PitchpadSynth = function () {\n    var i,\n      r,\n      a,\n      s,\n      l,\n      d,\n      e = this;\n    return (\n      (e.init = function (e) {\n        (i = []),\n          (r = 3),\n          (a = []),\n          (s = []),\n          (l = []),\n          (d = Tone.context.createGain()).connect(Tone.Master),\n          (d.gain.value = 0.5);\n        for (var t = 0; t < r; t++) {\n          i[t] = null;\n          var n = Tone.context.createOscillator(),\n            o = Tone.context.createGain();\n          (n.type = \"triangle\"),\n            n.connect(o),\n            o.connect(d),\n            (o.gain.value = 1e-6),\n            n.start(0),\n            a.push(n),\n            s.push(o),\n            l.push(-1);\n        }\n      }),\n      (e.startTouch = function (e, t) {\n        var n = i.findIndex(function (e) {\n          return null === e;\n        });\n        if (-1 == n) return;\n        (i[n] = e),\n          a[n].frequency.setValueAtTime(t, Tone.context.currentTime),\n          (l[n] = t),\n          c(n);\n      }),\n      (e.moveTouch = function (e, t, n) {\n        var o = u(e);\n        if (-1 == o) return;\n        a[o].frequency.setValueAtTime(t, Tone.context.currentTime),\n          n && !almostEqual(t, l[o]) && c(o);\n        l[o] = t;\n      }),\n      (e.stopTouch = t),\n      (e.stopAll = function () {\n        for (var e = 0; e < r; e++) t(i[e]);\n      }),\n      e\n    );\n    function u(t) {\n      return i.findIndex(function (e) {\n        return e === t;\n      });\n    }\n    function c(e) {\n      var t = Tone.context.currentTime;\n      s[e].gain.cancelScheduledValues(t),\n        s[e].gain.setTargetAtTime(1, t + 0.02, 0.001),\n        s[e].gain.setTargetAtTime(0.3, t + 0.02 + 0.1, 0.01);\n    }\n    function t(e) {\n      var t = u(e);\n      -1 != t &&\n        ((function (e) {\n          var t = Tone.context.currentTime;\n          s[e].gain.cancelScheduledValues(t),\n            s[e].gain.setTargetAtTime(0, t + 0.05, 0.1);\n        })(t),\n        (i[t] = null),\n        (l[t] = -1));\n    }\n  }),\n  ScaleExplorer = (window.ScaleExplorer = function () {\n    var i, r, a, t, n, s, l, d, u, o, c;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (i = e),\n          (mLoader = new Loader()),\n          mLoader.init(e),\n          mLoader.onAudioLoaded(),\n          (function () {\n            SUPERVISOR.makeGestureOnElementResumeAudioContext(\n              document.getElementById(i.widgetId)\n            );\n            var e = document.getElementById(i.widgetId);\n            e.style.position = \"relative\";\n            var t = document.createElement(\"div\");\n            (t.id = i.widgetId + \"appHolder\"),\n              (t.style.textAlign = \"center\"),\n              e.appendChild(t),\n              (c = Elm.ScaleExplorer.embed(t, {\n                scale: x(),\n                startNote: (function () {\n                  var e = x()[0];\n                  return e - (e % 12);\n                })(),\n                customNoteNames: I()\n                  ? null\n                  : i.frequencies.map(function (e) {\n                      return e.name;\n                    }),\n                customNoteColors: I()\n                  ? null\n                  : i.frequencies.map(function (e) {\n                      return e.color ? e.color : \"\";\n                    }),\n                showPiano: \"yes\" == i.showPiano,\n                showPads: i.isQuantized,\n                showScaleChooser: \"yes\" == i.showScaleChooser,\n                showRootChooser: \"yes\" == i.showRootChooser,\n                availableScaleNames: i.availableScales.split(\",\"),\n                defaultScaleName: i.defaultScale,\n                defaultRootName: i.defaultRoot,\n                scaleCanBeMappedToPiano: !(\"no\" == i.scaleCanBeMappedToPiano),\n                keyboardMappings: i.keyboard ? i.keyboard.split(\"\") : [],\n                showKeyboardButton: i.isQuantized && !isMobile(),\n                lang: i.lang,\n              })).ports.exportScale.subscribe(function (e) {\n                (o = e), S(), a.stopAll();\n              }),\n              c.ports.keyboardActive.subscribe(function (e) {\n                e\n                  ? KEY_SUPERVISOR.connectWidget(y, T, b)\n                  : KEY_SUPERVISOR.connectWidget(null, null, null);\n              }),\n              GLOBAL_PITCHPAD_SYNTH ||\n                (GLOBAL_PITCHPAD_SYNTH = new PitchpadSynth()).init();\n            (a = GLOBAL_PITCHPAD_SYNTH),\n              (r = d3\n                .select(\"#\" + i.widgetId)\n                .append(\"svg\")\n                .attr(\n                  \"class\",\n                  \"widget-scale-explorer__mouse-observer grabbable\"\n                )\n                .style(\"left\", \"0\")\n                .style(\"bottom\", \"0\")\n                .style(\"width\", \"100%\")).on(\"mousedown\", h),\n              r.on(\"mousemove\", function () {\n                d3.event.preventDefault();\n              }),\n              r.on(\"mouseup\", function () {\n                d3.event.preventDefault();\n              }),\n              r.on(\"touchstart\", m),\n              E(),\n              window.addEventListener(\"resize\", E),\n              (d = P().map(function (e) {\n                return !1;\n              })),\n              (u = P().map(function (e) {\n                return !1;\n              })),\n              w([]),\n              d3.timer(g),\n              i.tip &&\n                (function (e) {\n                  switch (e) {\n                    case \"lowhighpitch\":\n                      Tooltip.inject(\n                        document.getElementById(i.widgetId),\n                        (function (e) {\n                          var t = i.tips[e];\n                          return (\n                            (t.name = e), (t[\"@close\"] = i.lang[\"@close\"]), t\n                          );\n                        })(e),\n                        \"80%\"\n                      );\n                  }\n                })(i.tip);\n          })();\n      }),\n      this\n    );\n    function p(e) {\n      return i.isQuantized ? n(e) : t(e);\n    }\n    function f() {\n      return parseInt(r.style(\"width\"), 10);\n    }\n    function m() {\n      d3.event.preventDefault();\n      var o = d3.select(this).classed(\"active\", !0);\n      o.on(\"touchmove\", function () {\n        d3.event.preventDefault();\n        for (var e = 0; e < d3.event.changedTouches.length; e++) {\n          var t = d3.event.changedTouches.item(e),\n            n = d3.touch(o.node(), t.identifier)[0];\n          a.moveTouch(t.identifier, p(n), i.isQuantized);\n        }\n        w(d3.touches(r.node()));\n      })\n        .on(\"touchend\", function () {\n          d3.event.preventDefault();\n          for (var e = 0; e < d3.event.changedTouches.length; e++) {\n            var t = d3.event.changedTouches.item(e),\n              n = d3.touch(o.node(), t.identifier)[0];\n            a.stopTouch(t.identifier, p(n));\n          }\n          w(d3.touches(r.node()));\n        })\n        .on(\"touchcancel\", function () {\n          d3.event.preventDefault();\n          for (var e = 0; e < d3.event.changedTouches.length; e++) {\n            var t = d3.event.changedTouches.item(e),\n              n = d3.touch(o.node(), t.identifier)[0];\n            a.stopTouch(t.identifier, p(n));\n          }\n          w(d3.touches(r.node()));\n        });\n      for (var e = 0; e < d3.event.changedTouches.length; e++) {\n        var t = d3.event.changedTouches.item(e),\n          n = d3.touch(o.node(), t.identifier)[0];\n        a.startTouch(t.identifier, p(n));\n      }\n      w(d3.touches(r.node()));\n    }\n    function g() {\n      if (l) {\n        l = !1;\n        var e = r.selectAll(\"circle.widget-scale-explorer__touch\").data(s);\n        e.exit().remove(),\n          e\n            .enter()\n            .append(\"circle\")\n            .attr(\"class\", \"widget-scale-explorer__touch\")\n            .attr(\"r\", \"15px\")\n            .merge(e)\n            .attr(\"cx\", function (e) {\n              return e[0];\n            })\n            .attr(\"cy\", function (e) {\n              return parseInt(r.style(\"height\"), 10) / 2;\n            });\n      }\n    }\n    function h() {\n      var t = d3.select(this).classed(\"active\", !0),\n        e = d3\n          .select(window)\n          .on(\"mousemove\", function () {\n            var e = d3.mouse(t.node());\n            w([e]), a.moveTouch(\"mouse\", p(e[0]), i.isQuantized);\n          })\n          .on(\"mouseup\", function () {\n            w([]),\n              a.stopTouch(\"mouse\"),\n              e.on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n      a.startTouch(\"mouse\", p(d3.mouse(this)[0])),\n        w([d3.mouse(this)]),\n        d3.event.preventDefault();\n    }\n    function v(e) {\n      var t = keyEventToPhysicalKey(e);\n      return null == t\n        ? -1\n        : i.keyboard.split(\"\").findIndex(function (e) {\n            return e.toUpperCase() == t.toUpperCase();\n          });\n    }\n    function y(e) {\n      var t = v(e);\n      if (!(t < 0)) {\n        var n = P()[t];\n        if ((a.startTouch(\"key\" + t, n), (d[t] = !0), c)) {\n          var o = x()[t];\n          c.ports.noteOn.send(o);\n        }\n      }\n    }\n    function T(e) {\n      var t = v(e);\n      if (!(t < 0) && (a.stopTouch(\"key\" + t), (d[t] = !1), c)) {\n        var n = x()[t];\n        c.ports.noteOff.send(n);\n      }\n    }\n    function w(e) {\n      if (((l = !0), (s = e), u && c)) {\n        var o = P().length,\n          i = [],\n          r = f() / o;\n        s.forEach(function (e) {\n          var t = e[0],\n            n = _.clamp(Math.floor(t / r), 0, o - 1);\n          i.push(n);\n        });\n        for (var t = 0; t < u.length; t++) {\n          var n = u[t];\n          if (\n            null !=\n            i.find(function (e) {\n              return e == t;\n            })\n          ) {\n            if (!n) {\n              u[t] = !0;\n              var a = x()[t];\n              c.ports.noteOn.send(a);\n            }\n          } else if (n) {\n            u[t] = !1;\n            a = x()[t];\n            c.ports.noteOff.send(a);\n          }\n        }\n      }\n    }\n    function E() {\n      S(), w([]);\n    }\n    function b() {\n      c.ports.resetNoteOnState.send(!0), c.ports.keyboardDisconnected.send(!0);\n      for (var e = 0; e < d.length; e++)\n        d[e] && (a.stopTouch(\"key\" + e), (d[e] = !1));\n    }\n    function S() {\n      (n = d3.scaleQuantize().domain([0, f()]).range(P())),\n        (t = d3.scaleLinear().domain([0, f()]).range(P()).clamp(!0));\n    }\n    function I() {\n      return i.defaultRoot || i.defaultScale;\n    }\n    function P() {\n      return I()\n        ? x().map(function (e) {\n            return Tone.Frequency(e, \"midi\").toFrequency();\n          })\n        : i.frequencies.map(function (e) {\n            return e.freq;\n          });\n    }\n    function x() {\n      return I()\n        ? o ||\n            [0, 2, 4, 5, 7, 9, 11, 12].map(function (e) {\n              return e + 60;\n            })\n        : \"no\" != i.scaleCanBeMappedToPiano\n        ? i.frequencies.map(function (e) {\n            return Math.round(Tone.Frequency(e.freq).toMidi());\n          })\n        : i.frequencies.map(function (e, t) {\n            return t;\n          });\n    }\n  }),\n  SimpleDrumpad = (window.SimpleDrumpad = function () {\n    var n, t, o, i, r, a, s, l;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (n = e), (t = new Loader()).init(n), v() && t.hide();\n        (s = !1), (a = new Drumkit()).init(e.kit.samples).then(y);\n      }),\n      this\n    );\n    function d(e) {\n      return e.name.replace(/\\s/g, \"\");\n    }\n    function u(e) {\n      !(function (e) {\n        o.select(\"#\" + d(e))\n          .transition()\n          .duration(50)\n          .style(\"background-color\", \"#FED134\")\n          .transition()\n          .duration(200)\n          .style(\"background-color\", \"#858585\");\n      })(e),\n        a.playNoteAtNumber(e.midi, 0, e.choke),\n        n.recorder && n.recorder.recordEvent(e);\n    }\n    function e() {\n      var e = i.selectAll(\".widget__pad\").data(n.kit.samples);\n      e.enter()\n        .append(\"div\")\n        .attr(\"class\", \"widget__pad widget__pad--drum\")\n        .attr(\"id\", function (e, t) {\n          return d(e);\n        })\n        .on(\"mousedown\", function (e, t) {\n          u(e), d3.event.preventDefault();\n        })\n        .on(\"touchstart\", function (e, t) {\n          d3.event.stopPropagation(), d3.event.preventDefault(), u(e);\n        })\n        .merge(e)\n        .html(function (e, t) {\n          return s\n            ? \"<kbd class='widget__pad__key'>\" +\n                n.keyboard.split(\"\")[t].toUpperCase() +\n                \"</kbd><div class='widget__pad__label'>\" +\n                e.name +\n                \"</div>\"\n            : \"<div class='widget__pad__label'>\" + e.name + \"</div>\";\n        });\n    }\n    function c(e) {\n      var t = (function (e) {\n        var t = keyEventToPhysicalKey(e);\n        return null == t\n          ? -1\n          : n.keyboard.split(\"\").findIndex(function (e) {\n              return e.toUpperCase() == t.toUpperCase();\n            });\n      })(e);\n      -1 != t && u(n.kit.samples[t]);\n    }\n    function p(e) {}\n    function f() {\n      (s = !1), g(), e();\n    }\n    function m() {\n      s\n        ? (KEY_SUPERVISOR.connectWidget(null, null, null), f())\n        : (KEY_SUPERVISOR.connectWidget(c, p, f), (s = !0)),\n        g(),\n        e();\n    }\n    function g() {\n      var e = s\n        ? \"widget__keyboard-button--on\"\n        : \"widget__keyboard-button--off\";\n      l.className = \"btn btn--link btn--cropped widget__keyboard-button \" + e;\n    }\n    function h() {\n      if (!isMobile()) {\n        var e = document.getElementById(n.widgetId);\n        ((r = document.createElement(\"div\")).className =\n          \"widget-drumpad__header\"),\n          (r.style.justifyContent = \"flex-end\"),\n          e.appendChild(r),\n          ((l = document.createElement(\"button\")).innerHTML =\n            n.lang[\"@keyboard\"]),\n          (l.onclick = m),\n          Tooltip.appendTooltippableChild(r, l),\n          (l.parentElement.style.width = \"80px\"),\n          l.parentElement.classList.add(\"widget__keyboard-button__wrapper\"),\n          g();\n      }\n    }\n    function v() {\n      return null != n.recorder;\n    }\n    function y() {\n      t.onAudioLoaded(),\n        SUPERVISOR.makeGestureOnElementResumeAudioContext(\n          document.getElementById(n.widgetId)\n        ),\n        (o = d3.select(\"#\" + n.widgetId)),\n        v()\n          ? ((i = o\n              .append(\"div\")\n              .attr(\"id\", \"padHolder\")\n              .attr(\"class\", \"widget__pads\")),\n            h())\n          : (h(),\n            (i = o\n              .append(\"div\")\n              .attr(\"id\", \"padHolder\")\n              .attr(\"class\", \"widget__pads\"))),\n        e(),\n        n.tip &&\n          (function (e) {\n            function t(e) {\n              var t = n.tips[e];\n              return (t.name = e), (t[\"@close\"] = n.lang[\"@close\"]), t;\n            }\n            switch (e) {\n              case \"keyboard\":\n                if (isMobile()) return;\n                Tooltip.inject(l.parentElement, t(e));\n                break;\n              case \"drumpad\":\n                (document.getElementById(n.widgetId).style.position =\n                  \"relative\"),\n                  Tooltip.inject(\n                    document.getElementById(n.widgetId),\n                    t(e),\n                    \"95%\",\n                    \"25%\",\n                    \"left\"\n                  );\n            }\n          })(n.tip);\n    }\n  }),\n  PianoRollAssessment = {\n    lanesMatch: function (e, t, n) {\n      var o = e.events.filter(function (e) {\n          return e.lane == n;\n        }),\n        i = t.events.filter(function (e) {\n          return e.lane == n;\n        });\n      return (\n        o.length == i.length &&\n        o.every(function (t) {\n          return i.find(function (e) {\n            return (\n              t.start === e.start &&\n              t.duration === e.duration &&\n              t.lane === e.lane\n            );\n          });\n        })\n      );\n    },\n    populatedLanesMatch: function (e, t, n) {\n      if (!e || !t) return !1;\n      for (var o = 0; o < n; o++) {\n        if (\n          0 <\n            e.events.filter(function (e) {\n              return e.lane == o;\n            }).length &&\n          !PianoRollAssessment.lanesMatch(e, t, o)\n        )\n          return !1;\n      }\n      return !0;\n    },\n    modelsMatch: function (e, t, n) {\n      if (!e || !t) return !1;\n      if (e.events.length != t.events.length) return !1;\n      for (var o = 0; o < n; o++)\n        if (!PianoRollAssessment.lanesMatch(e, t, o)) return !1;\n      return !0;\n    },\n  },\n  PIANOROLL_VERSION = 2,\n  PianoRollEditor = (window.PianoRollEditor = function () {\n    var o,\n      i,\n      r,\n      a,\n      s,\n      l,\n      d,\n      u = this;\n    return (\n      (u.init = function (e) {\n        (i = e),\n          (function () {\n            for (var e = i.lanes, t = 0; t < e.length; t++)\n              void 0 === e[t].color && (e[t].color = \"none\"),\n                void 0 === e[t].freq && (e[t].freq = null),\n                void 0 === e[t].midi && (e[t].midi = null),\n                void 0 === e[t].choke && (e[t].choke = null);\n            ((l = document.createElement(\"div\")).style.width = m() + \"px\"),\n              (l.style.position = \"relative\"),\n              (l.style.overflow = \"hidden\"),\n              (l.style.backgroundColor = \"#666\"),\n              Tooltip.appendTooltippableChild(\n                document.getElementById(i.widgetId),\n                l\n              );\n            var n = document.createElement(\"div\");\n            l.appendChild(n),\n              (o = Elm.SimplePianoRoll.embed(n, {\n                lanes: e,\n                beats: i.beats,\n                gridSize: i.gridSize / 4,\n                width: m(),\n                height: f(),\n                labelWidth: T(),\n                scaleName: i.defaultScale ? i.defaultScale : null,\n                rootName: i.defaultRoot ? i.defaultRoot : null,\n                octave: i.defaultOctave ? parseInt(i.defaultOctave) : null,\n                octaveCount: i.defaultOctaveCount\n                  ? parseInt(i.defaultOctaveCount)\n                  : null,\n                showRootChooser: \"yes\" == i.showRootChooser,\n                showScaleChooser: \"yes\" == i.showScaleChooser,\n                availableScales: i.availableScales\n                  ? i.availableScales.split(\",\")\n                  : [],\n                showTempoSlider: \"no\" != i.showTempoSlider,\n                showSettings: !0,\n                tempo: parseFloat(i.tempo),\n                highlightedLanes: i.highlightedLanes ? i.highlightedLanes : [],\n                options: {\n                  allowResize: null == i.allowResize || i.allowResize,\n                },\n              })),\n              o.ports.exportModel.subscribe(function (e) {\n                var t = !r || e.page != r.page,\n                  n = !r || e.lanes.length != r.lanes.length;\n                (r = e),\n                  u.trigger(\"modelChange\", e),\n                  t && u.trigger(\"pageChange\"),\n                  n && c();\n              }),\n              o.ports.previewNotes.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesSelected.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesDragged.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesAdded.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !1);\n              }),\n              o.ports.tempoChanged.subscribe(function (e) {\n                u.trigger(\"tempoChanged\", e);\n              }),\n              ((d = document.createElement(\"div\")).className =\n                \"widget-pianoroll__mouse-observer-holder\"),\n              (d.style.left = T() + \"px\"),\n              (d.style.width = g() + \"px\"),\n              (d.style.height = h() + \"px\"),\n              l.appendChild(d),\n              new SingleTouchObserver().init({\n                node: d,\n                onDown: function (e, t) {\n                  o.ports.mouseDown.send([e, t]);\n                },\n                onMove: function (e, t) {\n                  o.ports.mouseMove.send([e, t]);\n                },\n                onUp: function (e, t) {\n                  o.ports.mouseUp.send([e, t]);\n                },\n              }),\n              ((a = document.createElement(\"div\")).className =\n                \"widget-pianoroll__playhead\"),\n              (a.style.bottom = \"0px\"),\n              (a.style.height = h() - 2 + \"px\"),\n              l.appendChild(a),\n              ((s = document.createElement(\"div\")).className =\n                \"widget-pianoroll__playhead\"),\n              (s.style.bottom = p() + \"px\"),\n              (s.style.height = y() - 1 + \"px\"),\n              l.appendChild(s),\n              c(),\n              window.addEventListener(\"resize\", c);\n          })();\n      }),\n      (u.clear = function () {\n        o.ports.clear.send(\"\");\n      }),\n      (u.setModel = function (e) {\n        if (!e || e.version != PIANOROLL_VERSION) return;\n        (e.lanes = i.lanes),\n          (e.showSettings = !0),\n          (null != e.scaleName && \"yes\" == i.showScaleChooser) ||\n            (e.scaleName = i.defaultScale ? i.defaultScale : null);\n        (null != e.rootName && \"yes\" == i.showRootChooser) ||\n          (e.rootName = i.defaultRoot ? i.defaultRoot : null);\n        (e.octave = i.defaultOctave ? parseInt(i.defaultOctave) : null),\n          (e.octaveCount = i.defaultOctaveCount\n            ? parseInt(i.defaultOctaveCount)\n            : null),\n          null == e.tempo\n            ? (e.tempo = parseFloat(i.tempo))\n            : (e.tempo = parseFloat(e.tempo));\n        o.ports.importModel.send(e);\n      }),\n      (u.getModel = function (e) {\n        return r;\n      }),\n      (u.record = function (e) {\n        o.ports.record.send([e.lane, e.start]);\n      }),\n      (u.setPlayhead = function (e) {\n        if (0 < e) {\n          (s.style.transform = \"translateX(\" + (e * g() + T()) + \"px)\"),\n            (s.style.opacity = 1);\n          var t = (function () {\n              var e = r ? r.page : -1,\n                t = -1 == e || 0 == e ? 0 : 4 * e - 0.25,\n                n =\n                  -1 == e || e == i.beats / 4 - 1\n                    ? i.beats\n                    : 4 * (e + 1) + 0.25;\n              return [t / i.beats, n / i.beats];\n            })(),\n            n = pctInRange(t[0], t[1], e);\n          fitsInRange(0, 1, n)\n            ? ((a.style.transform = \"translateX(\" + (n * g() + T()) + \"px)\"),\n              (a.style.opacity = 1))\n            : (a.style.opacity = 0);\n        } else (a.style.opacity = 0), (s.style.opacity = 0);\n      }),\n      (u.setOptions = function (e) {\n        o.ports.setOptions.send(e);\n      }),\n      (u.updateTempo = function (e) {\n        o.ports.setTempo.send(parseFloat(e));\n      }),\n      (u.getEditorTooltipWrapper = function () {\n        return l.parentElement;\n      }),\n      u\n    );\n    function c() {\n      (l.style.width = m() + \"px\"),\n        (a.style.height = h() - 1 + \"px\"),\n        (d.style.width = g() + \"px\"),\n        (d.style.height = h() + \"px\"),\n        (s.style.bottom = p() + \"px\"),\n        o.ports.setSize.send([m(), f()]);\n    }\n    function p() {\n      return h() + 1;\n    }\n    function f() {\n      return h() + y();\n    }\n    function m() {\n      var e = document.getElementById(i.widgetId);\n      return parseInt(e.offsetWidth, 10);\n    }\n    function g() {\n      return m() - T();\n    }\n    function h() {\n      return (\n        (function () {\n          var e = isMobile() ? 36 : 60,\n            t = (25 - e) / 12,\n            n = e - 4 * t,\n            o = Math.round(t * v() + n);\n          return _.clamp(o, 25, e);\n        })() * v()\n      );\n    }\n    function v() {\n      return r ? r.lanes.length : i.lanes.length;\n    }\n    function y() {\n      return 4 < i.beats ? 50 : 0;\n    }\n    function T() {\n      return i ? (\"drums\" != i.material || isMobile() ? 62 : 124) : 62;\n    }\n  });\nMicroEvent.mixin(PianoRollEditor);\nvar PianoRollExport = {\n    createExportData: function (t, e, n) {\n      var o = t.events.map(function (e) {\n        return {\n          midi: PianoRollExport.laneToMidi(t, e.lane),\n          startInBeats: e.start,\n          durationInBeats: e.duration,\n        };\n      });\n      return {\n        tempo: e,\n        tracks: [{ instrument: n, clip: { lengthInBeats: t.beats, notes: o } }],\n      };\n    },\n    laneToMidi: function (e, t) {\n      var n = e.lanes.length,\n        o = e.lanes[n - 1 - t];\n      return o.freq ? Math.round(Tone.Frequency(o.freq).toMidi()) : o.midi;\n    },\n  },\n  PianoRollPlayer = (window.PianoRollPlayer = function (widget /* ARLAN CODE */) {\n    var o,\n      l,\n      d,\n      t,\n      u = this;\n    return (\n      (u.setModel = function (e) {\n        l = e;\n      }),\n      (u.setLoop = function (e) {\n        (t = e), o && (i(), (Tone.Transport.position = \"0:0:0\"), n());\n      }),\n      (u.start = n),\n      (u.stop = i),\n      (u.record = function (e) {\n        d = d || [];\n        d.push(e);\n      }),\n      (u.progress = function () {\n        if (!l || !o) return 0;\n        var e = getTotalBeats(Tone.Time(o.loopStart).toBarsBeatsSixteenths()),\n          t = getTotalBeats(Tone.Time(o.loopEnd).toBarsBeatsSixteenths()),\n          n = o.progress * (t - e);\n        return (e + n) / l.beats;\n      }),\n      (u.previewNotes = function (e) {\n        // console.log(\"previewNotes\", e)\n        var t = e.map(function (e) {\n            return e.lane;\n          }),\n          n = _.uniq(t).map(function (e) {\n            var t = l.lanes.length - 1 - e;\n            return { lane: l.lanes[t], length: \"16n\", time: \"+0.1\" };\n          });\n        // BEGIN ARLAN CODE\n        // console.log(u, o, l, d, t, widget.getConfig().widgetId)\n        if (n.length > 0 && window.arlan_ws) {\n          window.arlan_ws.send(JSON.stringify({\n            type: \"sound\",\n            model: widget.getConfig().widgetId,\n            sound: n,\n          }))\n        }\n        // END ARLAN CODE\n        u.trigger(\"playNotes\", n);\n      }),\n      u\n    );\n    function n(e) {\n      // console.log(\"n\", e)\n      l &&\n        ((function () {\n          var r = 1 / l.gridSize,\n            a = 4 * l.gridSize + \"n\",\n            e = l.gridSize * l.beats,\n            s = l.lanes.length;\n          o && o.dispose();\n          o = new Tone.Sequence(\n            function (i, e) {\n              if (l) {\n                var t = e * r;\n                d &&\n                  (function (t) {\n                    (d = d.filter(function (e) {\n                      return (e.start + e.duration) % l.beats > t;\n                    })),\n                      0 === t &&\n                        (d = d.filter(function (e) {\n                          return e.start + e.duration > l.beats;\n                        }));\n                  })(t);\n                var n = (function (t) {\n                  return l.events.filter(function (e) {\n                    return e.start == t;\n                  });\n                })(t)\n                  .filter(function (t) {\n                    return !(\n                      d &&\n                      -1 !=\n                        d.findIndex(function (e) {\n                          return e.lane == t.lane;\n                        })\n                    );\n                  })\n                  .map(function (e) {\n                    var t = e.duration / r,\n                      n = s - e.lane - 1,\n                      o = a + \" * \" + t;\n                    return { lane: l.lanes[n], length: o, time: i };\n                  });\n                u.trigger(\"playNotes\", n);\n              }\n            },\n            _.range(0, e),\n            a\n          );\n        })(),\n        t\n          ? ((o.loopStart = beatsAsBarsBeatsSixteenths(t.start)),\n            (o.loopEnd = beatsAsBarsBeatsSixteenths(t.end)),\n            (o.loop = !0),\n            o.start(e, o.loopStart))\n          : o.start(e));\n    }\n    function i(e) {\n      o && o.stop(e);\n    }\n  });\nMicroEvent.mixin(PianoRollPlayer);\nvar SimplePianoRoll = (window.SimplePianoRoll = function () {\n  var t,\n    i,\n    r,\n    n,\n    o,\n    a,\n    s,\n    l,\n    d,\n    u,\n    c = this;\n  return (\n    (c.init = function (e) {\n      if (!BrowserCompatibility.isBrowserCompatible())\n        return void BrowserCompatibility.appendCompatibilityWarning(\n          document.getElementById(e.widgetId),\n          e.lang[\"@incompatiblebrowser\"]\n        );\n      isMobile() &&\n        document.getElementById(e.widgetId).classList.add(\"widget-is-mobile\");\n      (i = e), (t = new Loader()).init(i), i.recorder && i.recorder.connect(b);\n      i.exporter && \"yes\" != i.disableExport && i.exporter.registerWidget(c);\n      (s = new PianoRollPlayer(c /* ARLAN CODE */)),\n        \"tonal\" == i.material\n          ? (d = new Piano()).init(i.instrument).then(p)\n          : \"drums\" == i.material &&\n            (d = new Drumkit()).init(i.instrument.samples).then(p),\n        T(),\n        (u = _.debounce(g, 500));\n    }),\n    (c.showTargetState = function () {\n      r.setTempo(w()), l.setModel(JSON.parse(i.targetState));\n    }),\n    (c.getExportInfo = function () {\n      return PianoRollExport.createExportData(\n        l.getModel(),\n        r.getTempo(),\n        i.instrument.livePreset\n      );\n    }),\n    (c.getConfig = function () {\n      return i;\n    }),\n    // BEGIN ARLAN CODE\n    (c.getLiveAdjustThings = function () {\n      return {transport: r, modelSetter: l, player: s};\n    }),\n    // END ARLAN CODE\n    c\n  );\n  function p() {\n    t.onAudioLoaded(),\n      SUPERVISOR.makeGestureOnElementResumeAudioContext(\n        document.getElementById(i.widgetId)\n      ),\n      (function () {\n        var e = document.createElement(\"div\");\n        (e.className = \"widget__menu\"),\n          document.getElementById(i.widgetId).appendChild(e),\n          (r = new Transport()).init({\n            node: e,\n            onStartPlayback: function () {\n              // console.log(\"onStartPlayback\")\n              s.start();\n            },\n            onStartQuantizedPlayback: function () {\n              // console.log(\"onStartQuantizedPlayback\")\n              s.start(\"@1m\");\n            },\n            onStopPlayback: function () {\n              // console.log(\"onStopPlayback\")\n              s.stop(), d.stopAll();\n            },\n            onPlay: i.onPlay, // \"join\"\n            tempo: w(),\n            onTempoChanged: function (e) {\n              l.updateTempo(e), y(), u();\n            },\n            showRecordButton: i.recorder,\n            widgetId: i.widgetId,\n          }),\n          (i.defaultState || i.tempo) &&\n            (((n = document.createElement(\"button\")).innerHTML =\n              i.lang[\"@reset\"]),\n            (n.className = \"widget-button widget-button--hidden\"),\n            (n.onclick = v),\n            e.appendChild(n));\n        ((o = document.createElement(\"button\")).innerHTML = i.lang[\"@clear\"]),\n          (o.className = \"widget-button\"),\n          (o.style.marginLeft = \"auto\"),\n          (o.onclick = function () {\n            l.clear();\n          }),\n          e.appendChild(o),\n          ((a = document.createElement(\"button\")).innerHTML =\n            i.lang[\"@exporttolive\"]),\n          (a.className = \"btn btn--link btn--cropped\"),\n          (a.onclick = function () {\n            if (!m())\n              return (\n                (a.style.pointerEvents = \"none\"),\n                (a.style.opacity = 0.25),\n                void f(\"exportnotsupportedchromeios\")\n              );\n            (a.style.pointerEvents = \"none\"),\n              (a.innerHTML = i.lang[\"@exporting\"] + \"...\"),\n              c.trigger(\"export\", c, function (e) {\n                (a.style.pointerEvents = \"initial\"),\n                  (a.innerHTML = i.lang[\"@exporttolive\"]),\n                  e && console.log(e);\n              });\n          }),\n          \"yes\" != i.disableExport &&\n            (Tooltip.appendTooltippableChild(e, a),\n            LiveSetExport.checkExportServiceAvailablility(function (e) {\n              (a.style.opacity = e ? 1 : 0.25),\n                (a.style.pointerEvents = e ? \"auto\" : \"none\");\n            }));\n      })(),\n      (l = new PianoRollEditor()).init(i),\n      l.bind(\"modelChange\", function (e) {\n        // console.log(\"modelChange\", e)\n        s.setModel(e),\n          T(),\n          y(),\n          (function () {\n            if (o) {\n              var e = (function () {\n                var e = l ? l.getModel() : void 0;\n                return !!e && 0 < e.events.length;\n              })()\n                ? \"\"\n                : \"widget-button--hidden\";\n              o.className = \"btn btn--link btn--cropped \" + e;\n            }\n          })(),\n          u();\n      }),\n      l.bind(\"pageChange\", function () {\n        !(function () {\n          if (\"takeover\" != i.onPlay) return;\n          d.stopAll();\n          var e = l ? l.getModel() : void 0;\n          e && -1 != e.page\n            ? s.setLoop({ start: 4 * e.page, end: 4 * e.page + 4 })\n            : s.setLoop({ start: 0, end: i.beats });\n        })();\n      }),\n      l.bind(\"previewNotes\", function (e, t) {\n        // console.log(\"previewNotes\", e, t);\n        (!t && r.isPlaying()) || s.previewNotes(e);\n      }),\n      l.bind(\"tempoChanged\", function (e) {\n        r.setTempo(e), y(), u();\n      }),\n      s.bind(\"playNotes\", function (e) {\n        // console.log(\"playNotes\", e)\n        \"tonal\" == i.material\n          ? e.forEach(function (e) {\n              d.playNoteAtFrequency(e.lane.freq, e.time, e.length);\n            })\n          : \"drums\" == i.material && d.playNotes(e);\n      }),\n      4 === i.beats &&\n        \"drums\" === i.material &&\n        null == i.recorder &&\n        (function () {\n          var e = document.createElement(\"div\");\n          e.className = \"widget-drumsequencer__column-labels\";\n          for (var t = 0; t < 16; t++) {\n            var n = document.createElement(\"div\");\n            (n.className = \"widget-drumsequencer__column-label\"),\n              t % 4 == 0 &&\n                n.classList.add(\"widget-drumsequencer__column-label--beat\"),\n              (n.innerHTML = t + 1),\n              e.appendChild(n);\n          }\n          document.getElementById(i.widgetId).appendChild(e);\n        })(),\n      i.defaultState && v();\n    var e = getSavedModel(i.widgetId);\n    e && (e.tempo && r.setTempo(e.tempo), l.setModel(e)),\n      i.tip && f(i.tip),\n      d3.timer(h);\n  }\n  function f(e) {\n    function t(e) {\n      var t = i.tips[e];\n      return (t.name = e), (t[\"@close\"] = i.lang[\"@close\"]), t;\n    }\n    switch (e) {\n      case \"playstop\":\n        Tooltip.inject(\n          r.playButton().parentElement,\n          t(e),\n          \"100%\",\n          \"50%\",\n          \"left\"\n        );\n        break;\n      case \"record\":\n        Tooltip.inject(r.recordButton().parentElement, t(e));\n        break;\n      case \"createdeletenotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"70%\", \"60%\");\n        break;\n      case \"dragnotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"50%\", \"55%\");\n        break;\n      case \"resizenotes\":\n      case \"selectnotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"50%\", \"65%\");\n        break;\n      case \"tempo\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"15%\", \"50%\");\n        break;\n      case \"overview\":\n        Tooltip.inject(\n          l.getEditorTooltipWrapper(),\n          t(e),\n          \"30%\",\n          \"80%\",\n          \"right\"\n        );\n        break;\n      case \"export\":\n        m() && Tooltip.inject(a.parentElement, t(e), \"100%\", \"50%\", \"right\");\n        break;\n      case \"exportnotsupportedchromeios\":\n        Tooltip.inject(a.parentElement, t(e), \"100%\", \"50%\", \"right\");\n    }\n  }\n  function m() {\n    return !isChromeOnIOS();\n  }\n  function g() {\n    var e = l.getModel();\n    e &&\n      ((e.tempo = r.getTempo()),\n      trySaveState(e, i.widgetId, PIANOROLL_VERSION));\n  }\n  function h() {\n    var e = r.isPlaying() ? s.progress() : 0;\n    l.setPlayhead(e);\n  }\n  function v() {\n    if ((r.setTempo(w()), i.defaultState))\n      l.setModel(JSON.parse(i.defaultState));\n    else if (i.defaultRoot || i.defaultScale) {\n      var e = l.getModel();\n      (e.scaleName = i.defaultScale),\n        (e.rootName = i.defaultRoot),\n        (e.tempo = w()),\n        l.setModel(e);\n    }\n  }\n  function y() {\n    if (n) {\n      var e = (function () {\n        var e = l ? l.getModel() : void 0;\n        return i.defaultState\n          ? w() === r.getTempo() &&\n              E(e) &&\n              PianoRollAssessment.modelsMatch(\n                JSON.parse(i.defaultState),\n                l.getModel(),\n                i.lanes.length\n              )\n          : w() === r.getTempo() && E(e);\n      })()\n        ? \"widget-button--hidden\"\n        : \"\";\n      n.className = \"btn btn--link btn--cropped \" + e;\n    }\n  }\n  function T() {\n    var e = document.getElementById(i.widgetId + \"correct\"),\n      t = document.getElementById(i.widgetId + \"generic\");\n    if (e && t) {\n      var n = (function () {\n        var e = l ? l.getModel() : void 0;\n        if (!i.targetState || !e) return !1;\n        {\n          if (\"tonal\" == i.material)\n            return PianoRollAssessment.modelsMatch(\n              JSON.parse(i.targetState),\n              l.getModel(),\n              e.lanes.length\n            );\n          if (\"drums\" == i.material)\n            return PianoRollAssessment.populatedLanesMatch(\n              JSON.parse(i.targetState),\n              l.getModel(),\n              e.lanes.length\n            );\n        }\n      })();\n      (e.className = n\n        ? \"widget__dynamic-text\"\n        : \"widget__dynamic-text widget__dynamic-text--hidden\"),\n        (t.className = n\n          ? \"widget__dynamic-text widget__dynamic-text--hidden\"\n          : \"widget__dynamic-text\");\n    }\n  }\n  function w() {\n    return i.tempo ? parseInt(i.tempo) : 85;\n  }\n  function E(e) {\n    if (!e) return !0;\n    var t = !i.defaultRoot || i.defaultRoot === e.rootName,\n      n = !i.defaultScale || i.defaultScale === e.scaleName;\n    return t && n;\n  }\n  function b(e) {\n    var t = i.lanes.map(function (e) {\n        return e.midi;\n      }),\n      n = i.lanes.length - t.indexOf(e.midi) - 1,\n      o = s.progress() * i.beats;\n    r.isRecording() &&\n      r.isPlaying() &&\n      (l.record({ lane: n, start: o, duration: 0.25 }),\n      s.record({ lane: n, start: o, duration: 0.25 }));\n  }\n});\nMicroEvent.mixin(SimplePianoRoll);\nvar SimpleSession = (window.SimpleSession = function () {\n    var o, n, i, r, a, s, l, d;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (o = e),\n          (r = document.getElementById(o.widgetId)),\n          (i = new Loader()).init(o),\n          (Tone.Transport.bpm.value = o.preset.tempo),\n          (l = \"stopped\"),\n          (s = new Tone.MultiPlayer(\n            (function (e) {\n              var o = {},\n                i = getAudioExtension();\n              return (\n                e.tracks.forEach(function (e, t) {\n                  e.clips.forEach(function (e, t) {\n                    var n = e.name;\n                    o[n] = pathToWidgetSounds() + e.path + i;\n                  });\n                }),\n                o\n              );\n            })(o.preset),\n            function () {\n              !(function () {\n                i.onAudioLoaded(),\n                  SUPERVISOR.makeGestureOnElementResumeAudioContext(r),\n                  (a = document.createElement(\"div\")),\n                  Tooltip.appendTooltippableChild(r, a);\n                for (var e = 0; e < o.preset.tracks.length; e++) {\n                  var t = o.preset.tracks[e];\n                  t.name = t[\"@name\"];\n                }\n                (n = Elm.SimpleSession.embed(a, o.preset)),\n                  Tone.Transport.scheduleRepeat(function (e) {\n                    n.ports.onTick.send(\"\" + e);\n                  }, \"1m\"),\n                  n.ports.playSound.subscribe(function (e) {\n                    var t = e[0],\n                      n = e[1];\n                    \"stopped\" == Tone.Transport.state &&\n                      ((Tone.Transport.position = \"0:0:0\"),\n                      Tone.Transport.start(ToneTransportStartDelay())),\n                      \"stopped\" == l && (l = \"playing\"),\n                      (function (e, t) {\n                        o.preset.tracks[t].clips.forEach(function (t) {\n                          t.name != e.name &&\n                            (Tone.Transport.clear(d[t.name]),\n                            Tone.Transport.scheduleOnce(function (e) {\n                              try {\n                                s.stop(t.name, e);\n                              } catch (e) {}\n                            }, \"@1m\"));\n                        });\n                      })(t, n),\n                      (d[t.name] = Tone.Transport.scheduleRepeat(\n                        function (e) {\n                          try {\n                            s.stop(t.name, e);\n                          } catch (e) {}\n                          s.start(t.name, e, 0, t.length),\n                            SUPERVISOR.registerPlayingWidget(o.widgetId);\n                        },\n                        t.length,\n                        \"@1m\"\n                      ));\n                  }),\n                  n.ports.unqueueSound.subscribe(function (e) {\n                    Tone.Transport.clear(d[e.name]);\n                  }),\n                  n.ports.stopSound.subscribe(function (t) {\n                    Tone.Transport.clear(d[t.name]),\n                      Tone.Transport.scheduleOnce(function (e) {\n                        try {\n                          s.stop(t.name, e);\n                        } catch (e) {}\n                      }, \"@1m\");\n                  }),\n                  n.ports.allSoundsStopped.subscribe(function (e) {\n                    SUPERVISOR.isOnlyWidgetPlaying(o.widgetId) &&\n                      ((Tone.Transport.position = \"0:0:0\"),\n                      Tone.Transport.stop()),\n                      (l = \"stopped\"),\n                      SUPERVISOR.unregisterPlayingWidget(o.widgetId);\n                  }),\n                  o.tip &&\n                    (function (e) {\n                      switch (e) {\n                        case \"devicemute\":\n                          if (!isMobile()) return;\n                          Tooltip.inject(\n                            a,\n                            (function (e) {\n                              var t = o.tips[e];\n                              return (\n                                (t.name = e),\n                                (t[\"@close\"] = o.lang[\"@close\"]),\n                                t\n                              );\n                            })(e),\n                            \"65%\",\n                            \"60%\",\n                            \"right\"\n                          );\n                      }\n                    })(o.tip);\n              })();\n            }\n          ).toMaster()),\n          (d = {});\n      }),\n      this\n    );\n  }),\n  SongFormExplorer = (window.SongFormExplorer = function () {\n    var i, r, a;\n    return (\n      (this.init = function (e) {\n        (a = e),\n          (r = document.getElementById(a.widgetId)),\n          (function () {\n            var e = document.createElement(\"div\");\n            r.appendChild(e);\n            for (var t = 0; t < a.preset.sections.length - 1; t++) {\n              var n = a.preset.sections[t],\n                o = a.preset.sections[t + 1];\n              n.end = o.start;\n            }\n            a.preset.sections[a.preset.sections.length - 1].end =\n              a.preset.songLength;\n            for (t = 0; t < a.preset.sections.length; t++) {\n              ((n = a.preset.sections[t]).description = n[\"@description\"]),\n                (n.name = n[\"@name\"]),\n                (n.label = n[\"@label\"]);\n            }\n            for (t = 0; t < a.preset.sections.length; t++) {\n              (n = a.preset.sections[t])[\"@label\"] || (n.label = n.name);\n            }\n            (i = Elm.SongFormExplorer.embed(e, a.preset)),\n              i.ports.jumpToSection.subscribe(function (e) {\n                a.player.setPlayheadToTime(e.start);\n              }),\n              a.player.setPlayheadChangedCallback(s),\n              a.tip &&\n                (function (e) {\n                  switch (e) {\n                    case \"songformsections\":\n                      (r.style.position = \"relative\"),\n                        Tooltip.inject(\n                          r,\n                          (function (e) {\n                            var t = a.tips[e];\n                            return (\n                              (t.name = e), (t[\"@close\"] = a.lang[\"@close\"]), t\n                            );\n                          })(e),\n                          \"45px\",\n                          \"65%\"\n                        );\n                  }\n                })(a.tip);\n          })();\n      }),\n      this\n    );\n    function s(e) {\n      i.ports.updatePlayhead.send(e);\n    }\n  });\nfunction onYouTubeIframeAPIReady() {\n  YOUTUBEWIDGETS.forEach(function (e) {\n    e.onYouTubeIframeAPIReady();\n  }),\n    (YOUTUBE_API_READY = !0);\n}\n(YOUTUBEWIDGETS = []), (YOUTUBE_API_READY = !1);\nvar YouTube = (window.YouTube = function () {\n  var n,\n    t,\n    o,\n    i,\n    r,\n    a,\n    s,\n    l,\n    d = this;\n  return (\n    (d.init = function (e) {\n      (n = e),\n        (o = document.getElementById(n.widgetId)),\n        ((i = document.createElement(\"div\")).className =\n          \"widget-video__holder\"),\n        (i.id = n.widgetId + \"video\"),\n        (i.style.display = \"none\"),\n        o.appendChild(i),\n        n.width && (i.style.width = n.width + \"px\");\n      (l = !1),\n        (t = new Loader()).init(n),\n        YOUTUBE_API_READY ? f() : YOUTUBEWIDGETS.push(d);\n    }),\n    (d.onYouTubeIframeAPIReady = function () {\n      f();\n    }),\n    (d.setPlayheadChangedCallback = function (e) {\n      s = e;\n    }),\n    (d.setPlayheadToTime = function (e) {\n      if (void 0 === r || void 0 === r.getPlayerState) return;\n      r.getPlayerState() != YT.PlayerState.PLAYING && s && s(e);\n      r.seekTo(e), l && r.playVideo();\n      Tone.Transport.emit(\"takeover\", n.widgetId);\n    }),\n    d\n  );\n  function e(e) {\n    t.hide(),\n      (document.getElementById(n.widgetId + \"video\").style.display = \"block\"),\n      Tone.Transport.on(\"takeover\", u),\n      document.getElementById(n.widgetId).classList.add(\"is-ready\");\n  }\n  function u(e) {\n    \"takeover\" == n.onPlay &&\n      e != n.widgetId &&\n      r.getPlayerState() === YT.PlayerState.PLAYING &&\n      (r.pauseVideo(), (l = !0));\n  }\n  function c() {\n    r &&\n      r.getPlayerState() == YT.PlayerState.PLAYING &&\n      s &&\n      s(r.getCurrentTime());\n  }\n  function p(e) {\n    if (\n      e.data == YT.PlayerState.PLAYING ||\n      e.data == YT.PlayerState.BUFFERING\n    ) {\n      var t = document.getElementById(n.widgetId);\n      t.classList.remove(\"is-ready\"), t.classList.add(\"is-playing\");\n    }\n    e.data == YT.PlayerState.PLAYING\n      ? (\"takeover\" == n.onPlay && Tone.Transport.emit(\"takeover\", n.widgetId),\n        a ? a.restart(c) : (a = d3.timer(c)),\n        SUPERVISOR.registerPlayingWidget(n.widgetId),\n        (l = !1))\n      : (SUPERVISOR.unregisterPlayingWidget(n.widgetId), a && a.stop(c));\n  }\n  function f() {\n    r = new YT.Player(n.widgetId + \"video\", {\n      videoId: n.videoId,\n      playerVars: {\n        controls: 2,\n        disablekb: 1,\n        showinfo: 0,\n        color: \"white\",\n        modestbranding: 1,\n        fs: 0,\n        playsinline: 1,\n        start: n.start ? parseInt(n.start) : 0,\n        end: n.end ? parseInt(n.end) : void 0,\n        loop: n.loop && \"yes\" === n.loop ? 1 : 0,\n        host: \"https://www.youtube-nocookie.com\",\n      },\n      events: { onReady: e, onStateChange: p },\n    });\n  }\n});\n"],"names":["window","AudioSupervisor","n","e","this","init","document","addEventListener","t","Tone","Transport","latencyHint","isMobile","makeGestureOnElementResumeAudioContext","context","resume","then","removeEventListener","registerPlayingWidget","indexOf","push","unregisterPlayingWidget","filter","isOnlyWidgetPlaying","length","areAnyWidgetsPlaying","masterEffectChain","Master","hidden","volume","rampTo","BrowserCompatibility","hasOwnProperty","createElement","className","innerHTML","appendChild","Drumkit","i","r","o","Promise","map","path","name","midi","SAMPLE_CACHE","getBuffers","MultiPlayer","toMaster","fadeOut","Buffer","on","a","playNoteAtNumber","playNotes","forEach","some","lane","choke","time","stopAll","buffers","loaded","start","Workarounds","multiplayerStopAll","LiveSetExport","KeySupervisor","keyCode","connectWidget","serviceURL","checkExportServiceAvailablility","XMLHttpRequest","timeout","open","send","createLiveSet","Date","toDateString","replace","backlink","location","href","tempo","tracks","userHasAlreadyExportedOnce","LOCALE_PATH","responseText","isValidFileId","downloadURLFromFileId","storageAvailable","localStorage","setItem","setRequestHeader","JSON","stringify","getItem","match","createDownloadLink","RegExp","exec","s","createTextNode","title","getElementById","style","display","Loader","LiveSetExporter","registerWidget","bind","getExportInfo","getConfig","onPlay","reduce","concat","id","widgetId","hide","onAudioLoaded","Piano","Metronome","metro","getAudioExtension","metroup","value","stop","dispose","Sequence","d","u","c","l","samples","connect","SUPERVISOR","fadeout","duration","val","nearest","offset","p","playNoteAtFrequency","Math","round","Frequency","toMidi","SingleTouchObserver","Recorder","recordEvent","SampleCache","Buffers","getBuffer","has","get","add","extension","d3","select","node","append","attr","event","type","button","classed","mouse","onDown","activeElement","blur","preventDefault","onMove","onUp","Tooltip","inject","userHasSeenTooltip","showalways","getBoundingClientRect","xShiftFactor","xShiftInPx","width","top","left","marginTop","marginLeft","border","borderColor","classList","setUserHasSeenTooltip","tooltipKeyForLocalStorage","appendTooltippableChild","position","onclick","m","parentElement","g","isRecording","isPlaying","getTempo","setTempo","bpm","emit","onTempoChanged","playButton","recordButton","playing","queued","stopped","showRecordButton","METRONOME","onStopPlayback","onStartPlayback","f","scheduleOnce","onStartQuantizedPlayback","getTotalBeats","parseFloat","split","getBars","getBeats","getSixteenths","beatsAsBarsBeatsSixteenths","Time","toBarsBeatsSixteenths","canPlayAudio","supportsType","Number","MAX_VALUE","abs","removeItem","getSavedModel","parse","getSavedModelString","setTimeout","connectToWebsocket","ws","WebSocket","onmessage","message","data","pianoRoll","model","transport","modelSetter","getLiveAdjustThings","state","setModel","player","trigger","sound","Error","onopen","statusElement","onclose","arlan_ws","navigator","userAgent","keyEventToPhysicalKey","code","includes","keyFromPhysicalCode","String","fromCharCode","cookie","domain","console","log","clearCookies","GLOBAL_PITCHPAD_SYNTH","PitchpadSynth","createGain","gain","createOscillator","startTouch","findIndex","frequency","setValueAtTime","currentTime","moveTouch","almostEqual","stopTouch","cancelScheduledValues","setTargetAtTime","PianoRollAssessment","ScaleExplorer","mLoader","textAlign","Elm","embed","scale","x","startNote","customNoteNames","I","frequencies","customNoteColors","color","showPiano","showPads","isQuantized","showScaleChooser","showRootChooser","availableScaleNames","availableScales","defaultScaleName","defaultScale","defaultRootName","defaultRoot","scaleCanBeMappedToPiano","keyboardMappings","keyboard","showKeyboardButton","lang","ports","exportScale","subscribe","S","keyboardActive","KEY_SUPERVISOR","y","T","b","h","E","P","w","timer","tip","tips","parseInt","changedTouches","item","touch","identifier","touches","selectAll","exit","remove","enter","merge","v","toUpperCase","noteOn","noteOff","_","clamp","floor","find","resetNoteOnState","keyboardDisconnected","scaleQuantize","range","scaleLinear","toFrequency","freq","SimpleDrumpad","kit","transition","recorder","stopPropagation","html","justifyContent","lanesMatch","events","every","populatedLanesMatch","modelsMatch","PianoRollEditor","lanes","overflow","backgroundColor","SimplePianoRoll","beats","gridSize","height","labelWidth","scaleName","rootName","octave","defaultOctave","octaveCount","defaultOctaveCount","showTempoSlider","showSettings","highlightedLanes","options","allowResize","exportModel","page","previewNotes","notesSelected","notesDragged","notesAdded","tempoChanged","mouseDown","mouseMove","mouseUp","bottom","clear","version","importModel","getModel","record","setPlayhead","transform","opacity","pctInRange","fitsInRange","setOptions","updateTempo","getEditorTooltipWrapper","setSize","offsetWidth","material","MicroEvent","mixin","PianoRollExport","createExportData","laneToMidi","startInBeats","durationInBeats","instrument","clip","lengthInBeats","notes","PianoRollPlayer","widget","setLoop","progress","loopStart","loopEnd","uniq","end","loop","exporter","disableExport","debounce","showTargetState","targetState","livePreset","defaultState","pointerEvents","trySaveState","SimpleSession","preset","clips","scheduleRepeat","onTick","playSound","unqueueSound","stopSound","allSoundsStopped","SongFormExplorer","sections","songLength","description","label","jumpToSection","setPlayheadToTime","setPlayheadChangedCallback","updatePlayhead","YOUTUBEWIDGETS","YOUTUBE_API_READY","YouTube","onYouTubeIframeAPIReady","getPlayerState","YT","PlayerState","PLAYING","seekTo","playVideo","pauseVideo","getCurrentTime","BUFFERING","restart","Player","videoId","playerVars","controls","disablekb","showinfo","modestbranding","fs","playsinline","host","onReady","onStateChange"],"version":3,"file":"index.a78246c0.js.map"}