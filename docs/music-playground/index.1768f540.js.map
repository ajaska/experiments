{"mappings":"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","sources":["./src/music-playground/widgets.min.js"],"sourcesContent":["var AudioSupervisor = (window.AudioSupervisor = function () {\n    var n,\n      e = this;\n    return (\n      (e.init = function (e) {\n        document.addEventListener &&\n          document.addEventListener(\"visibilitychange\", t),\n          (Tone.Transport.latencyHint = isMobile() ? 0.06 : \"fastest\"),\n          (n = []);\n      }),\n      (e.makeGestureOnElementResumeAudioContext = function (e) {\n        function t() {\n          Tone.context.resume().then(function () {\n            e.removeEventListener(\"touchstart\", t, !0),\n              e.removeEventListener(\"touchend\", t, !0),\n              e.removeEventListener(\"mousedown\", t, !0),\n              e.removeEventListener(\"mouseup\", t, !0),\n              e.removeEventListener(\"click\", t, !0);\n          });\n        }\n        e.addEventListener(\"touchstart\", t, !0),\n          e.addEventListener(\"touchend\", t, !0),\n          e.addEventListener(\"mousedown\", t, !0),\n          e.addEventListener(\"mouseup\", t, !0),\n          e.addEventListener(\"click\", t, !0);\n      }),\n      (e.registerPlayingWidget = function (e) {\n        console.log('registered', e);\n        -1 == n.indexOf(e) && n.push(e);\n      }),\n      (e.unregisterPlayingWidget = function (t) {\n        console.log('unregistered', t);\n        n = n.filter(function (e) {\n          return e != t;\n        });\n      }),\n      (e.isOnlyWidgetPlaying = function (e) {\n        return 1 === n.length && n[0] === e;\n      }),\n      (e.areAnyWidgetsPlaying = function () {\n        return 0 < n.length;\n      }),\n      (e.masterEffectChain = function () {\n        return Tone.Master;\n      }),\n      e\n    );\n    function t() {\n      document.hidden && Tone\n        ? Tone.Master.volume.rampTo(-1 / 0, 0.3)\n        : Tone && Tone.Master.volume.rampTo(0, 0.4);\n    }\n  }),\n  BrowserCompatibility = {\n    isBrowserCompatible: function () {\n      var e =\n          window.hasOwnProperty(\"AudioContext\") ||\n          window.hasOwnProperty(\"webkitAudioContext\"),\n        t = window.hasOwnProperty(\"Promise\"),\n        n = window.hasOwnProperty(\"Worker\");\n      return e && t && n;\n    },\n    appendCompatibilityWarning: function (e, t) {\n      var n = document.createElement(\"div\");\n      (n.className = \"widget__compatibility-message\"),\n        (n.innerHTML = t),\n        e.appendChild(n);\n    },\n  },\n  Drumkit = (window.Drumkit = function () {\n    var e,\n      i,\n      r,\n      t = this;\n    return (\n      (t.init = function (o) {\n        if (e) return e;\n        return (e = new Promise(function (e) {\n          var t = o.map(function (e) {\n              return { path: e.path, name: e.midi + \"\" };\n            }),\n            n = SAMPLE_CACHE.getBuffers(t);\n          ((r = new Tone.MultiPlayer(n).toMaster()).fadeOut = 0.01),\n            (i = e),\n            Tone.Buffer.on(\"progress\", a),\n            Tone.Buffer.on(\"load\", a),\n            a();\n        }));\n      }),\n      (t.playNoteAtNumber = n),\n      (t.playNotes = function (e) {\n        e.forEach(function (t) {\n          e.some(function (e) {\n            return t.lane.midi === e.lane.choke;\n          }) || n(t.lane.midi, t.time, t.lane.choke);\n        });\n      }),\n      (t.stopAll = function () {\n        r.stopAll();\n      }),\n      t\n    );\n    function a() {\n      r.buffers.loaded && i();\n    }\n    function n(e, t, n) {\n      r.start(e + \"\", t), n && Workarounds.multiplayerStopAll(r, n + \"\", t);\n    }\n  }),\n  KeySupervisor = (window.KeySupervisor = function () {\n    var t,\n      o,\n      i,\n      r,\n      e = this;\n    return (\n      (e.init = function (e) {\n        document.addEventListener(\n          \"keydown\",\n          function (e) {\n            !(function (e) {\n              return !0 === t[e.keyCode];\n            })(e) && ((t[e.keyCode] = !0), o && o(e));\n          },\n          !0\n        ),\n          document.addEventListener(\n            \"keyup\",\n            function (e) {\n              (t[e.keyCode] = !1), i && i(e);\n            },\n            !0\n          ),\n          document.addEventListener &&\n            document.addEventListener(\"visibilitychange\", n),\n          (t = {});\n      }),\n      (e.connectWidget = function (e, t, n) {\n        r && r();\n        (o = e), (i = t), (r = n);\n      }),\n      e\n    );\n    function n() {\n      document.hidden && r && (r(), (r = i = o = null));\n    }\n  }),\n  LiveSetExport = {\n    serviceURL: \"https://learningmusic-export.ableton.com\",\n    checkExportServiceAvailablility: function (e) {\n      var t = new XMLHttpRequest();\n      (t.timeout = 5e3),\n        t.addEventListener(\"load\", function () {\n          e(!0);\n        }),\n        t.addEventListener(\"error\", function () {\n          e(!1);\n        }),\n        t.addEventListener(\"abort\", function () {\n          e(!1);\n        }),\n        t.addEventListener(\"timeout\", function () {\n          e(!1);\n        }),\n        t.open(\"GET\", LiveSetExport.serviceURL + \"/availability\"),\n        t.send();\n    },\n    createLiveSet: function (e, t, n) {\n      var o = new Date().toDateString().replace(/[^a-z0-9]/gi, \"_\"),\n        i = {\n          backlink: window.location.href,\n          name: \"idea_\" + o,\n          tempo: e,\n          tracks: t,\n        };\n      if (!LiveSetExport.userHasAlreadyExportedOnce())\n        var r = window.open(\n          LOCALE_PATH + \"/live-set-export-waiting.html\",\n          \"_blank\"\n        );\n      var a = new XMLHttpRequest();\n      a.addEventListener(\"load\", function () {\n        n(void 0);\n        var e = this.responseText;\n        if (LiveSetExport.userHasAlreadyExportedOnce())\n          LiveSetExport.isValidFileId(e) &&\n            (window.location = LiveSetExport.downloadURLFromFileId(e));\n        else {\n          storageAvailable(\"localStorage\") &&\n            localStorage.setItem(\"__userHasExported\", \"yes\");\n          var t = \"?fileId=\" + e;\n          r.location.href = LOCALE_PATH + \"/live-set-export.html\" + t;\n        }\n      }),\n        a.addEventListener(\"error\", function () {\n          n(\"Export failed.\");\n        }),\n        a.addEventListener(\"abort\", function () {\n          n(\"Export was cancelled.\");\n        }),\n        a.open(\"POST\", LiveSetExport.serviceURL + \"/export\"),\n        a.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\"),\n        a.send(JSON.stringify(i));\n    },\n    downloadURLFromFileId: function (e) {\n      return LiveSetExport.serviceURL + \"/export?id=\" + e;\n    },\n    userHasAlreadyExportedOnce: function () {\n      return (\n        !!storageAvailable(\"localStorage\") &&\n        \"yes\" == localStorage.getItem(\"__userHasExported\")\n      );\n    },\n    isValidFileId: function (e) {\n      return e.match(\n        \"[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}\"\n      );\n    },\n    createDownloadLink: function (e, t) {\n      var n,\n        o,\n        i,\n        r =\n          ((n = \"fileId\"),\n          (o = window.location.href),\n          (i = new RegExp(\"[?&]\" + n + \"=([^&#]*)\", \"i\").exec(o))\n            ? i[1]\n            : null);\n      if (LiveSetExport.isValidFileId(r)) {\n        void 0 === t && (t = \"\");\n        var a = document.createElement(\"a\"),\n          s = document.createTextNode(\"Download\");\n        a.appendChild(s),\n          (a.title = \"Download your music as an Ableton Live Set\"),\n          (a.href = LiveSetExport.downloadURLFromFileId(r)),\n          (a.className = t),\n          document.getElementById(e).appendChild(a),\n          a.addEventListener(\"click\", function () {\n            a.style.display = \"none\";\n          });\n      } else\n        document.getElementById(e).innerHTML =\n          \"Error exporting to Live. Please try again.\";\n    },\n  },\n  LiveSetExporter = (window.LiveSetExporter = function () {\n    var i;\n    return (\n      (this.init = function () {\n        i = [];\n      }),\n      (this.registerWidget = function (e) {\n        i.push(e),\n          e.bind(\"export\", function (e, t) {\n            var n = e.getExportInfo();\n            if (\"takeover\" === e.getConfig().onPlay)\n              LiveSetExport.createLiveSet(n.tempo, n.tracks, t);\n            else {\n              var o = i.reduce(function (e, t) {\n                return e.concat(t.getExportInfo().tracks);\n              }, []);\n              LiveSetExport.createLiveSet(n.tempo, o, t);\n            }\n          });\n      }),\n      this\n    );\n  }),\n  Loader = (window.Loader = function () {\n    var t, n;\n    return (\n      (this.init = function (e) {\n        ((t = document.createElement(\"div\")).id = e.widgetId + \"loader\"),\n          (t.className = \"\"),\n          ((n = document.createElement(\"div\")).className =\n            \"widget-loader__loading-animation\"),\n          t.appendChild(n),\n          document.getElementById(e.widgetId).appendChild(t);\n      }),\n      (this.hide = function () {\n        t.style.display = \"none\";\n      }),\n      (this.onAudioLoaded = function () {\n        n.style.display = \"none\";\n      }),\n      this\n    );\n  }),\n  Metronome = (window.Metronome = function () {\n    var o, t;\n    return (\n      (this.init = function (e) {\n        var t = pathToWidgetSounds(),\n          n = {\n            metro: t + \"metronome/Metronome\" + getAudioExtension(),\n            metroup: t + \"metronome/MetronomeUp\" + getAudioExtension(),\n          };\n        (o = new Tone.MultiPlayer(n, i).toMaster()).volume.value = 12;\n      }),\n      (this.start = function (e) {\n        i(), t.start(e);\n      }),\n      (this.stop = function (e) {\n        t.stop(e), t.dispose();\n      }),\n      this\n    );\n    function i() {\n      t = new Tone.Sequence(\n        function (e, t) {\n          o.start(t, e);\n        },\n        [\"metroup\", \"metro\", \"metro\", \"metro\"],\n        \"4n\"\n      );\n    }\n  }),\n  Piano = (window.Piano = function () {\n    var e,\n      d,\n      u,\n      i,\n      c,\n      t = this;\n    return (\n      (t.init = function (l) {\n        (i = l),\n          (e =\n            e ||\n            new Promise(function (e) {\n              var t,\n                n,\n                o,\n                i,\n                r = l.samples.map(function (e) {\n                  return { path: e.path, name: e.midi + \"\" };\n                }),\n                a = SAMPLE_CACHE.getBuffers(r);\n              (u = new Tone.MultiPlayer(a)).connect(\n                SUPERVISOR.masterEffectChain()\n              ),\n                (u.fadeOut = l.fadeout.duration),\n                (c = []);\n              for (var s = 0; s < 128; s++)\n                c.push(\n                  ((t = s),\n                  (n = l.samples),\n                  void 0,\n                  (o = n.map(function (e) {\n                    return e.midi;\n                  })),\n                  { val: (i = nearest(t, o)), offset: t - i })\n                );\n              (d = e),\n                Tone.Buffer.on(\"progress\", p),\n                Tone.Buffer.on(\"load\", p),\n                p();\n            }));\n        return e;\n      }),\n      (t.playNoteAtFrequency = function (e, t, n) {\n        o(Math.round(Tone.Frequency(e).toMidi()), t, n);\n      }),\n      (t.playNoteAtNumber = o),\n      (t.stopAll = function () {\n        u.stopAll();\n      }),\n      t\n    );\n    function p() {\n      u.buffers.loaded && d();\n    }\n    function o(e, t, n) {\n      var o = c[e];\n      u.start(o.val + \"\", t, 0, n + \"-\" + i.fadeout.offset, o.offset);\n    }\n  }),\n  Recorder = (window.Recorder = function () {\n    var t;\n    return (\n      (this.init = function (e) {}),\n      (this.recordEvent = function (e) {\n        t && t(e);\n      }),\n      (this.connect = function (e) {\n        t = e;\n      }),\n      this\n    );\n  }),\n  SampleCache = (window.SampleCache = function () {\n    var i,\n      n = this;\n    return (\n      (n.init = function () {\n        i = new Tone.Buffers();\n      }),\n      (n.getBuffer = function (e, t) {\n        {\n          if (i.has(e)) return i.get(e);\n          var n = t || getAudioExtension(),\n            o = pathToWidgetSounds() + e + n;\n          return i.add(e, o), i.get(e);\n        }\n      }),\n      (n.getBuffers = function (e) {\n        var t = new Tone.Buffers();\n        return (\n          e.forEach(function (e) {\n            t.add(e.name, n.getBuffer(e.path, e.extension));\n          }),\n          t\n        );\n      }),\n      n\n    );\n  }),\n  SingleTouchObserver = (window.SingleTouchObserver = function () {\n    var r;\n    return (\n      (this.init = function (e) {\n        (r = e),\n          d3\n            .select(e.node)\n            .append(\"div\")\n            .attr(\"class\", \"mouseObserver\")\n            .style(\"width\", \"100%\")\n            .style(\"height\", \"100%\")\n            .on(\"mousedown\", t)\n            .on(\"touchstart\", t);\n      }),\n      this\n    );\n    function t() {\n      if (\"mousedown\" !== d3.event.type || 0 === d3.event.button) {\n        var t = d3.select(this).classed(\"active\", !0),\n          n = d3\n            .select(window)\n            .on(\"touchmove\", o)\n            .on(\"mousemove\", o)\n            .on(\"mouseup\", i)\n            .on(\"touchend\", i),\n          e = d3.mouse(this);\n        r.onDown(e[0], e[1]),\n          document.activeElement && document.activeElement.blur(),\n          d3.event.preventDefault();\n      }\n      function o() {\n        var e = d3.mouse(t.node());\n        r.onMove(e[0], e[1]);\n      }\n      function i() {\n        var e = d3.mouse(t.node());\n        n\n          .on(\"touchmove\", null)\n          .on(\"mousemove\", null)\n          .on(\"mouseup\", null)\n          .on(\"touchend\", null),\n          r.onUp(e[0], e[1]);\n      }\n    }\n  }),\n  Tooltip = {\n    inject: function (e, t, n, o, i) {\n      if (t && e && !(Tooltip.userHasSeenTooltip(t.name) && !t.showalways)) {\n        e.getBoundingClientRect();\n        (xShiftFactor = 0),\n          \"left\" == i\n            ? (xShiftFactor = 0.25)\n            : \"right\" == i && (xShiftFactor = -0.25),\n          (xShiftInPx = 200 * xShiftFactor);\n        var r = document.createElement(\"div\");\n        (r.className = \"widget-tooltip\"),\n          (r.style.width = \"200px\"),\n          (r.style.top = n || \"100%\"),\n          (r.style.left = o || \"50%\"),\n          (r.style.marginTop = \"12px\"),\n          (r.style.marginLeft = -100 + xShiftInPx + \"px\");\n        var a = document.createElement(\"div\");\n        (a.className = \"widget-tooltip__triangle\"),\n          (a.style.top = \"-20px\"),\n          (a.style.left = 90 - xShiftInPx + \"px\"),\n          (a.style.border = \"solid 10px\"),\n          (a.style.borderColor = \"transparent transparent black transparent\"),\n          r.appendChild(a);\n        var s = document.createElement(\"div\");\n        (s.className = \"widget-tooltip__text\"),\n          (s.innerHTML = t[\"@text\"]),\n          r.appendChild(s);\n        var l = document.createElement(\"div\");\n        (l.className = \"widget-tooltip__dismiss\"),\n          (l.innerHTML = t[\"@close\"] ? t[\"@close\"] : \"Close\"),\n          r.appendChild(l),\n          r.addEventListener(\"click\", function () {\n            r.classList.add(\"widget-tooltip--hide\"),\n              Tooltip.setUserHasSeenTooltip(t.name);\n          }),\n          e.appendChild(r);\n      }\n    },\n    tooltipKeyForLocalStorage: function (e) {\n      return \"__tooltip_\" + e;\n    },\n    userHasSeenTooltip: function (e) {\n      return (\n        !!storageAvailable(\"localStorage\") &&\n        \"dismissed\" ==\n          localStorage.getItem(Tooltip.tooltipKeyForLocalStorage(e))\n      );\n    },\n    setUserHasSeenTooltip: function (e) {\n      storageAvailable(\"localStorage\") &&\n        localStorage.setItem(Tooltip.tooltipKeyForLocalStorage(e), \"dismissed\");\n    },\n    appendTooltippableChild: function (e, t) {\n      var n = document.createElement(\"div\");\n      (n.style.position = \"relative\"), n.appendChild(t), e.appendChild(n);\n    },\n  },\n  Transport = (window.Transport = function () {\n    var t,\n      n,\n      o,\n      i,\n      r,\n      a,\n      s,\n      e = this;\n    return (\n      (e.init = function (e) {\n        (n = e),\n          ((t = document.createElement(\"div\")).className = \"widget-transport\"),\n          e.node.appendChild(t),\n          ((o = document.createElement(\"button\")).onclick = m),\n          Tooltip.appendTooltippableChild(t, o),\n          o.parentElement.classList.add(\"widget__transport-btn-wrapper\"),\n          ((i = document.createElement(\"button\")).onclick = g),\n          Tooltip.appendTooltippableChild(t, i),\n          i.parentElement.classList.add(\"widget__transport-btn-wrapper\"),\n          (r = \"stopped\"),\n          (a = !1),\n          (s = e.tempo),\n          Tone.Transport.on(\"takeover\", c),\n          Tone.Transport.on(\"sessionTempoChanged\", l),\n          d();\n      }),\n      (e.isRecording = function () {\n        return a;\n      }),\n      (e.isPlaying = function () {\n        return \"playing\" == r;\n      }),\n      (e.getTempo = function () {\n        return s;\n      }),\n      (e.setTempo = function (e) {\n        (s = e),\n          (\"join\" == n.onPlay || (\"takeover\" == n.onPlay && \"playing\" == r)) &&\n            ((Tone.Transport.bpm.value = s),\n            Tone.Transport.emit(\"sessionTempoChanged\", s));\n        n.onTempoChanged && n.onTempoChanged(s);\n      }),\n      (e.playButton = function () {\n        return o;\n      }),\n      (e.recordButton = function () {\n        return i;\n      }),\n      e\n    );\n    function l(e) {\n      // console.log(\"l\", \"e\");\n      \"join\" == n.onPlay && ((s = e), n.onTempoChanged && n.onTempoChanged(s));\n    }\n    function d() {\n      (o.innerHTML = {\n        playing: \"<i class='icon-pause'></i>\",\n        queued: \"<i class='icon-play widget_transport-icon--queued'></i>\",\n        stopped: \"<i class='icon-play'></i>\",\n      }[r]),\n        (o.className = \"btn widget__transport-btn\"),\n        (function () {\n          i.innerHTML = \"<i class='icon-record'></i>\";\n          var e = n.showRecordButton ? \"\" : \" hidden\";\n          i.className =\n            a && \"playing\" == r\n              ? \"btn widget__transport-btn widget-button--recording\" + e\n              : \"btn widget__transport-btn\" + e;\n        })();\n    }\n    function u() {\n      a && ((a = !1), METRONOME.stop()),\n        n.onStopPlayback(),\n        SUPERVISOR.unregisterPlayingWidget(n.widgetId),\n        (r = \"stopped\"),\n        d();\n    }\n    function c(e) {\n      \"playing\" == r && u();\n    }\n    function p() {\n      (Tone.Transport.bpm.value = s),\n        (Tone.Transport.position = \"0:0:0\"),\n        Tone.Transport.start(ToneTransportStartDelay()),\n        a && METRONOME.start(),\n        n.onStartPlayback(),\n        SUPERVISOR.registerPlayingWidget(n.widgetId),\n        (r = \"playing\"),\n        d();\n    }\n    function f() {\n      (Tone.Transport.position = \"0:0:0\"), Tone.Transport.stop(), u();\n    }\n    // \"Toggle playback\"\n    function m() {\n      // console.log(\"m\", n.widgetId);\n      if ((!0, \"queued\" != r))\n        if (SUPERVISOR.areAnyWidgetsPlaying()) {\n          if (SUPERVISOR.areAnyWidgetsPlaying()) {\n            var e = \"playing\" == r;\n            \"takeover\" == n.onPlay\n              ? e\n                ? f()\n                : (Tone.Transport.emit(\"takeover\"), f(), p())\n              : \"join\" == n.onPlay &&\n                (e\n                  ? SUPERVISOR.isOnlyWidgetPlaying(n.widgetId)\n                    ? f()\n                    : c()\n                  : (a && METRONOME.start(\"@1m\"),\n                    Tone.Transport.scheduleOnce(function (e) {\n                      (r = \"playing\"), d();\n                    }, \"@1m\"),\n                    n.onStartQuantizedPlayback(),\n                    SUPERVISOR.registerPlayingWidget(n.widgetId),\n                    (r = \"queued\"),\n                    d()));\n          }\n        } else p();\n      console.log(r)\n    }\n    function g() {\n      (a = !a),\n        \"playing\" == r\n          ? a\n            ? METRONOME.start(\"0:0:0\")\n            : METRONOME.stop()\n          : m(),\n        d();\n    }\n  });\nfunction getSixteenths(e) {\n  return parseFloat(e.split(\":\")[2]);\n}\nfunction getBeats(e) {\n  return parseFloat(e.split(\":\")[1]);\n}\nfunction getBars(e) {\n  return parseFloat(e.split(\":\")[0]);\n}\nfunction getTotalBeats(e) {\n  return 4 * getBars(e) + getBeats(e) + getSixteenths(e) / 4;\n}\nfunction beatsAsBarsBeatsSixteenths(e) {\n  return Tone.Time(\"0:1:0 * \" + e).toBarsBeatsSixteenths();\n}\nfunction canPlayAudio(e) {\n  return Tone.Buffer.supportsType(e);\n}\nfunction getAudioExtension() {\n  var e = \".wav\";\n  return (\n    canPlayAudio(\"ogg\") ? (e = \".ogg\") : canPlayAudio(\"mp4\") && (e = \".mp4\"), e\n  );\n}\nfunction pathToWidgetSounds() {\n  return \"./sounds/\";\n}\nfunction pctInRange(e, t, n) {\n  return (n - e) / (t - e);\n}\nfunction fitsInRange(e, t, n) {\n  return e <= n && n <= t;\n}\nfunction almostEqual(e, t, n) {\n  return null == n && (n = 0.001), Math.abs(e - t) < n;\n}\nfunction nearest(e, t) {\n  for (var n = Number.MAX_VALUE, o = 0; o < t.length; o++) {\n    var i = t[o],\n      r = Math.abs(e - n);\n    Math.abs(e - i) <= r && (n = i);\n  }\n  return n;\n}\nfunction assert(e, t) {\n  if (!e) {\n    if (((t = t || \"Assertion failed\"), \"undefined\" != typeof Error))\n      throw new Error(t);\n    throw t;\n  }\n}\nfunction storageAvailable(e) {\n  try {\n    var t = window[e],\n      n = \"__storage_test__\";\n    return t.setItem(n, n), t.removeItem(n), !0;\n  } catch (e) {\n    return !1;\n  }\n}\n\n// BEGIN ARLAN CODE\nfunction connectToWebsocket() {\n  const ws_url =\n    process.env.NODE_ENV === \"development\"\n      ? \"ws://localhost:1238\"\n      : \"wss://experiments-do.ajaska.com:443/music-playground/\";\n  const ws = new WebSocket(ws_url);\n  ws.onmessage = (e) => {\n    const message = JSON.parse(e.data)\n    switch (message.type) {\n      case \"state\": {\n        const pianoRoll = window[message.model]\n        const { transport, modelSetter } = pianoRoll.getLiveAdjustThings()\n        const state = JSON.parse(message.state)\n        if (transport)\n          transport.setTempo(state.tempo)\n        if (modelSetter)\n          modelSetter.setModel(state)\n        return\n      }\n      case \"sound\": {\n        const pianoRoll = window[message.model]\n        const { player } = pianoRoll.getLiveAdjustThings()\n        player.trigger(\"playNotes\", message.sound);\n        return\n      }\n      default: {\n        throw new Error(\"Unable to handle message\", message)\n      }\n    }\n  }\n\n  ws.onopen = () => {\n    const statusElement = document.getElementById(\"connection-status\");\n    statusElement.innerHTML = \"[[ CONNECTION: Online ]]\"\n    statusElement.className = \"online\"\n  }\n  ws.onclose = () => {\n    const statusElement = document.getElementById(\"connection-status\");\n    statusElement.innerHTML = \"[[ CONNECTION: Lost, reconnecting... ]]\"\n    statusElement.className = \"\"\n\n    window.setTimeout(() => connectToWebsocket(), 5000)\n  }\n\n  window.arlan_ws = ws\n}\nwindow.setTimeout(() => connectToWebsocket(), 500)\n\n// END ARLAN CODE\n\n// ARLAN NOTE: use these functions\nfunction getSavedModelString(e) {\n// console.log(\"gsms\", e)\n// console.trace()\n  return storageAvailable(\"localStorage\") ? localStorage.getItem(e) : void 0;\n}\nfunction getSavedModel(e) {\n  try {\n    return JSON.parse(getSavedModelString(e));\n  } catch (e) {\n    return;\n  }\n}\nfunction tryRestoreApp(e, t, n) {\n  var o = getSavedModel(e);\n  if (o && o.version == n) return t.ports.importModel.send(o), o;\n}\nfunction trySaveState(e, t, n) {\n  // ARLAN NOTE: reliably called on every update\n  // console.log(\"persisting state\", e /* state */, t /* name */, n /* version */) \n  if (storageAvailable(\"localStorage\"))\n    try {\n      var o = e;\n      o.version = n;\n      var i = JSON.stringify(o);\n      localStorage.setItem(t, i); // , isDeveloperMode() && console.log(i);\n\n      // BEGIN ARLAN CODE\n      if (window.arlan_ws) {\n        window.arlan_ws.send(JSON.stringify({ type: \"state\", model: t, state: i }))\n      }\n      // END ARLAN CODE\n    } catch (e) {\n      return;\n    }\n}\nvar DEVELOPER_MODE = !1;\nfunction isDeveloperMode() {\n  return window.location.href.includes(\"localhost\") || DEVELOPER_MODE;\n}\nfunction isMobile() {\n  return !!(\n    navigator.userAgent.match(/Android/i) ||\n    navigator.userAgent.match(/webOS/i) ||\n    navigator.userAgent.match(/iPhone/i) ||\n    navigator.userAgent.match(/iPad/i) ||\n    navigator.userAgent.match(/iPod/i) ||\n    navigator.userAgent.match(/BlackBerry/i) ||\n    navigator.userAgent.match(/Windows Phone/i)\n  );\n}\nfunction isChromeOnIOS() {\n  return !!navigator.userAgent.match(\"CriOS\");\n}\nfunction keyFromPhysicalCode(e) {\n  return e.includes(\"Digit\")\n    ? e.split(\"Digit\")[1]\n    : e.includes(\"Key\")\n    ? e.split(\"Key\")[1]\n    : void 0;\n}\nfunction keyEventToPhysicalKey(e) {\n  return e.code ? keyFromPhysicalCode(e.code) : String.fromCharCode(e.keyCode);\n}\nfunction clearCookies() {\n  function n(e, t) {\n    document.cookie = t\n      ? e +\n        \"=; Path=/; Domain=\" +\n        t +\n        \"; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\"\n      : e + \"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\n  }\n  try {\n    document.cookie.split(\";\").forEach(function (e) {\n      var t = e.split(\"=\")[0];\n      t && 0 === t.indexOf(\"_g\") ? n(t, document.domain) : t && n(t);\n    });\n  } catch (e) {\n    console.log();\n  }\n}\nfunction ToneTransportStartDelay() {\n  return \"+0.1\";\n}\nclearCookies();\nvar GLOBAL_PITCHPAD_SYNTH,\n  Workarounds = {\n    multiplayerStopAll: function (e, t, n) {\n      try {\n        for (;;) e.stop(t, n);\n      } catch (e) {}\n    },\n  },\n  PitchpadSynth = (window.PitchpadSynth = function () {\n    var i,\n      r,\n      a,\n      s,\n      l,\n      d,\n      e = this;\n    return (\n      (e.init = function (e) {\n        (i = []),\n          (r = 3),\n          (a = []),\n          (s = []),\n          (l = []),\n          (d = Tone.context.createGain()).connect(Tone.Master),\n          (d.gain.value = 0.5);\n        for (var t = 0; t < r; t++) {\n          i[t] = null;\n          var n = Tone.context.createOscillator(),\n            o = Tone.context.createGain();\n          (n.type = \"triangle\"),\n            n.connect(o),\n            o.connect(d),\n            (o.gain.value = 1e-6),\n            n.start(0),\n            a.push(n),\n            s.push(o),\n            l.push(-1);\n        }\n      }),\n      (e.startTouch = function (e, t) {\n        var n = i.findIndex(function (e) {\n          return null === e;\n        });\n        if (-1 == n) return;\n        (i[n] = e),\n          a[n].frequency.setValueAtTime(t, Tone.context.currentTime),\n          (l[n] = t),\n          c(n);\n      }),\n      (e.moveTouch = function (e, t, n) {\n        var o = u(e);\n        if (-1 == o) return;\n        a[o].frequency.setValueAtTime(t, Tone.context.currentTime),\n          n && !almostEqual(t, l[o]) && c(o);\n        l[o] = t;\n      }),\n      (e.stopTouch = t),\n      (e.stopAll = function () {\n        for (var e = 0; e < r; e++) t(i[e]);\n      }),\n      e\n    );\n    function u(t) {\n      return i.findIndex(function (e) {\n        return e === t;\n      });\n    }\n    function c(e) {\n      var t = Tone.context.currentTime;\n      s[e].gain.cancelScheduledValues(t),\n        s[e].gain.setTargetAtTime(1, t + 0.02, 0.001),\n        s[e].gain.setTargetAtTime(0.3, t + 0.02 + 0.1, 0.01);\n    }\n    function t(e) {\n      var t = u(e);\n      -1 != t &&\n        ((function (e) {\n          var t = Tone.context.currentTime;\n          s[e].gain.cancelScheduledValues(t),\n            s[e].gain.setTargetAtTime(0, t + 0.05, 0.1);\n        })(t),\n        (i[t] = null),\n        (l[t] = -1));\n    }\n  }),\n  ScaleExplorer = (window.ScaleExplorer = function () {\n    var i, r, a, t, n, s, l, d, u, o, c;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (i = e),\n          (mLoader = new Loader()),\n          mLoader.init(e),\n          mLoader.onAudioLoaded(),\n          (function () {\n            SUPERVISOR.makeGestureOnElementResumeAudioContext(\n              document.getElementById(i.widgetId)\n            );\n            var e = document.getElementById(i.widgetId);\n            e.style.position = \"relative\";\n            var t = document.createElement(\"div\");\n            (t.id = i.widgetId + \"appHolder\"),\n              (t.style.textAlign = \"center\"),\n              e.appendChild(t),\n              (c = Elm.ScaleExplorer.embed(t, {\n                scale: x(),\n                startNote: (function () {\n                  var e = x()[0];\n                  return e - (e % 12);\n                })(),\n                customNoteNames: I()\n                  ? null\n                  : i.frequencies.map(function (e) {\n                      return e.name;\n                    }),\n                customNoteColors: I()\n                  ? null\n                  : i.frequencies.map(function (e) {\n                      return e.color ? e.color : \"\";\n                    }),\n                showPiano: \"yes\" == i.showPiano,\n                showPads: i.isQuantized,\n                showScaleChooser: \"yes\" == i.showScaleChooser,\n                showRootChooser: \"yes\" == i.showRootChooser,\n                availableScaleNames: i.availableScales.split(\",\"),\n                defaultScaleName: i.defaultScale,\n                defaultRootName: i.defaultRoot,\n                scaleCanBeMappedToPiano: !(\"no\" == i.scaleCanBeMappedToPiano),\n                keyboardMappings: i.keyboard ? i.keyboard.split(\"\") : [],\n                showKeyboardButton: i.isQuantized && !isMobile(),\n                lang: i.lang,\n              })).ports.exportScale.subscribe(function (e) {\n                (o = e), S(), a.stopAll();\n              }),\n              c.ports.keyboardActive.subscribe(function (e) {\n                e\n                  ? KEY_SUPERVISOR.connectWidget(y, T, b)\n                  : KEY_SUPERVISOR.connectWidget(null, null, null);\n              }),\n              GLOBAL_PITCHPAD_SYNTH ||\n                (GLOBAL_PITCHPAD_SYNTH = new PitchpadSynth()).init();\n            (a = GLOBAL_PITCHPAD_SYNTH),\n              (r = d3\n                .select(\"#\" + i.widgetId)\n                .append(\"svg\")\n                .attr(\n                  \"class\",\n                  \"widget-scale-explorer__mouse-observer grabbable\"\n                )\n                .style(\"left\", \"0\")\n                .style(\"bottom\", \"0\")\n                .style(\"width\", \"100%\")).on(\"mousedown\", h),\n              r.on(\"mousemove\", function () {\n                d3.event.preventDefault();\n              }),\n              r.on(\"mouseup\", function () {\n                d3.event.preventDefault();\n              }),\n              r.on(\"touchstart\", m),\n              E(),\n              window.addEventListener(\"resize\", E),\n              (d = P().map(function (e) {\n                return !1;\n              })),\n              (u = P().map(function (e) {\n                return !1;\n              })),\n              w([]),\n              d3.timer(g),\n              i.tip &&\n                (function (e) {\n                  switch (e) {\n                    case \"lowhighpitch\":\n                      Tooltip.inject(\n                        document.getElementById(i.widgetId),\n                        (function (e) {\n                          var t = i.tips[e];\n                          return (\n                            (t.name = e), (t[\"@close\"] = i.lang[\"@close\"]), t\n                          );\n                        })(e),\n                        \"80%\"\n                      );\n                  }\n                })(i.tip);\n          })();\n      }),\n      this\n    );\n    function p(e) {\n      return i.isQuantized ? n(e) : t(e);\n    }\n    function f() {\n      return parseInt(r.style(\"width\"), 10);\n    }\n    function m() {\n      d3.event.preventDefault();\n      var o = d3.select(this).classed(\"active\", !0);\n      o.on(\"touchmove\", function () {\n        d3.event.preventDefault();\n        for (var e = 0; e < d3.event.changedTouches.length; e++) {\n          var t = d3.event.changedTouches.item(e),\n            n = d3.touch(o.node(), t.identifier)[0];\n          a.moveTouch(t.identifier, p(n), i.isQuantized);\n        }\n        w(d3.touches(r.node()));\n      })\n        .on(\"touchend\", function () {\n          d3.event.preventDefault();\n          for (var e = 0; e < d3.event.changedTouches.length; e++) {\n            var t = d3.event.changedTouches.item(e),\n              n = d3.touch(o.node(), t.identifier)[0];\n            a.stopTouch(t.identifier, p(n));\n          }\n          w(d3.touches(r.node()));\n        })\n        .on(\"touchcancel\", function () {\n          d3.event.preventDefault();\n          for (var e = 0; e < d3.event.changedTouches.length; e++) {\n            var t = d3.event.changedTouches.item(e),\n              n = d3.touch(o.node(), t.identifier)[0];\n            a.stopTouch(t.identifier, p(n));\n          }\n          w(d3.touches(r.node()));\n        });\n      for (var e = 0; e < d3.event.changedTouches.length; e++) {\n        var t = d3.event.changedTouches.item(e),\n          n = d3.touch(o.node(), t.identifier)[0];\n        a.startTouch(t.identifier, p(n));\n      }\n      w(d3.touches(r.node()));\n    }\n    function g() {\n      if (l) {\n        l = !1;\n        var e = r.selectAll(\"circle.widget-scale-explorer__touch\").data(s);\n        e.exit().remove(),\n          e\n            .enter()\n            .append(\"circle\")\n            .attr(\"class\", \"widget-scale-explorer__touch\")\n            .attr(\"r\", \"15px\")\n            .merge(e)\n            .attr(\"cx\", function (e) {\n              return e[0];\n            })\n            .attr(\"cy\", function (e) {\n              return parseInt(r.style(\"height\"), 10) / 2;\n            });\n      }\n    }\n    function h() {\n      var t = d3.select(this).classed(\"active\", !0),\n        e = d3\n          .select(window)\n          .on(\"mousemove\", function () {\n            var e = d3.mouse(t.node());\n            w([e]), a.moveTouch(\"mouse\", p(e[0]), i.isQuantized);\n          })\n          .on(\"mouseup\", function () {\n            w([]),\n              a.stopTouch(\"mouse\"),\n              e.on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n      a.startTouch(\"mouse\", p(d3.mouse(this)[0])),\n        w([d3.mouse(this)]),\n        d3.event.preventDefault();\n    }\n    function v(e) {\n      var t = keyEventToPhysicalKey(e);\n      return null == t\n        ? -1\n        : i.keyboard.split(\"\").findIndex(function (e) {\n            return e.toUpperCase() == t.toUpperCase();\n          });\n    }\n    function y(e) {\n      var t = v(e);\n      if (!(t < 0)) {\n        var n = P()[t];\n        if ((a.startTouch(\"key\" + t, n), (d[t] = !0), c)) {\n          var o = x()[t];\n          c.ports.noteOn.send(o);\n        }\n      }\n    }\n    function T(e) {\n      var t = v(e);\n      if (!(t < 0) && (a.stopTouch(\"key\" + t), (d[t] = !1), c)) {\n        var n = x()[t];\n        c.ports.noteOff.send(n);\n      }\n    }\n    function w(e) {\n      if (((l = !0), (s = e), u && c)) {\n        var o = P().length,\n          i = [],\n          r = f() / o;\n        s.forEach(function (e) {\n          var t = e[0],\n            n = _.clamp(Math.floor(t / r), 0, o - 1);\n          i.push(n);\n        });\n        for (var t = 0; t < u.length; t++) {\n          var n = u[t];\n          if (\n            null !=\n            i.find(function (e) {\n              return e == t;\n            })\n          ) {\n            if (!n) {\n              u[t] = !0;\n              var a = x()[t];\n              c.ports.noteOn.send(a);\n            }\n          } else if (n) {\n            u[t] = !1;\n            a = x()[t];\n            c.ports.noteOff.send(a);\n          }\n        }\n      }\n    }\n    function E() {\n      S(), w([]);\n    }\n    function b() {\n      c.ports.resetNoteOnState.send(!0), c.ports.keyboardDisconnected.send(!0);\n      for (var e = 0; e < d.length; e++)\n        d[e] && (a.stopTouch(\"key\" + e), (d[e] = !1));\n    }\n    function S() {\n      (n = d3.scaleQuantize().domain([0, f()]).range(P())),\n        (t = d3.scaleLinear().domain([0, f()]).range(P()).clamp(!0));\n    }\n    function I() {\n      return i.defaultRoot || i.defaultScale;\n    }\n    function P() {\n      return I()\n        ? x().map(function (e) {\n            return Tone.Frequency(e, \"midi\").toFrequency();\n          })\n        : i.frequencies.map(function (e) {\n            return e.freq;\n          });\n    }\n    function x() {\n      return I()\n        ? o ||\n            [0, 2, 4, 5, 7, 9, 11, 12].map(function (e) {\n              return e + 60;\n            })\n        : \"no\" != i.scaleCanBeMappedToPiano\n        ? i.frequencies.map(function (e) {\n            return Math.round(Tone.Frequency(e.freq).toMidi());\n          })\n        : i.frequencies.map(function (e, t) {\n            return t;\n          });\n    }\n  }),\n  SimpleDrumpad = (window.SimpleDrumpad = function () {\n    var n, t, o, i, r, a, s, l;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (n = e), (t = new Loader()).init(n), v() && t.hide();\n        (s = !1), (a = new Drumkit()).init(e.kit.samples).then(y);\n      }),\n      this\n    );\n    function d(e) {\n      return e.name.replace(/\\s/g, \"\");\n    }\n    function u(e) {\n      !(function (e) {\n        o.select(\"#\" + d(e))\n          .transition()\n          .duration(50)\n          .style(\"background-color\", \"#FED134\")\n          .transition()\n          .duration(200)\n          .style(\"background-color\", \"#858585\");\n      })(e),\n        a.playNoteAtNumber(e.midi, 0, e.choke),\n        n.recorder && n.recorder.recordEvent(e);\n    }\n    function e() {\n      var e = i.selectAll(\".widget__pad\").data(n.kit.samples);\n      e.enter()\n        .append(\"div\")\n        .attr(\"class\", \"widget__pad widget__pad--drum\")\n        .attr(\"id\", function (e, t) {\n          return d(e);\n        })\n        .on(\"mousedown\", function (e, t) {\n          u(e), d3.event.preventDefault();\n        })\n        .on(\"touchstart\", function (e, t) {\n          d3.event.stopPropagation(), d3.event.preventDefault(), u(e);\n        })\n        .merge(e)\n        .html(function (e, t) {\n          return s\n            ? \"<kbd class='widget__pad__key'>\" +\n                n.keyboard.split(\"\")[t].toUpperCase() +\n                \"</kbd><div class='widget__pad__label'>\" +\n                e.name +\n                \"</div>\"\n            : \"<div class='widget__pad__label'>\" + e.name + \"</div>\";\n        });\n    }\n    function c(e) {\n      var t = (function (e) {\n        var t = keyEventToPhysicalKey(e);\n        return null == t\n          ? -1\n          : n.keyboard.split(\"\").findIndex(function (e) {\n              return e.toUpperCase() == t.toUpperCase();\n            });\n      })(e);\n      -1 != t && u(n.kit.samples[t]);\n    }\n    function p(e) {}\n    function f() {\n      (s = !1), g(), e();\n    }\n    function m() {\n      s\n        ? (KEY_SUPERVISOR.connectWidget(null, null, null), f())\n        : (KEY_SUPERVISOR.connectWidget(c, p, f), (s = !0)),\n        g(),\n        e();\n    }\n    function g() {\n      var e = s\n        ? \"widget__keyboard-button--on\"\n        : \"widget__keyboard-button--off\";\n      l.className = \"btn btn--link btn--cropped widget__keyboard-button \" + e;\n    }\n    function h() {\n      if (!isMobile()) {\n        var e = document.getElementById(n.widgetId);\n        ((r = document.createElement(\"div\")).className =\n          \"widget-drumpad__header\"),\n          (r.style.justifyContent = \"flex-end\"),\n          e.appendChild(r),\n          ((l = document.createElement(\"button\")).innerHTML =\n            n.lang[\"@keyboard\"]),\n          (l.onclick = m),\n          Tooltip.appendTooltippableChild(r, l),\n          (l.parentElement.style.width = \"80px\"),\n          l.parentElement.classList.add(\"widget__keyboard-button__wrapper\"),\n          g();\n      }\n    }\n    function v() {\n      return null != n.recorder;\n    }\n    function y() {\n      t.onAudioLoaded(),\n        SUPERVISOR.makeGestureOnElementResumeAudioContext(\n          document.getElementById(n.widgetId)\n        ),\n        (o = d3.select(\"#\" + n.widgetId)),\n        v()\n          ? ((i = o\n              .append(\"div\")\n              .attr(\"id\", \"padHolder\")\n              .attr(\"class\", \"widget__pads\")),\n            h())\n          : (h(),\n            (i = o\n              .append(\"div\")\n              .attr(\"id\", \"padHolder\")\n              .attr(\"class\", \"widget__pads\"))),\n        e(),\n        n.tip &&\n          (function (e) {\n            function t(e) {\n              var t = n.tips[e];\n              return (t.name = e), (t[\"@close\"] = n.lang[\"@close\"]), t;\n            }\n            switch (e) {\n              case \"keyboard\":\n                if (isMobile()) return;\n                Tooltip.inject(l.parentElement, t(e));\n                break;\n              case \"drumpad\":\n                (document.getElementById(n.widgetId).style.position =\n                  \"relative\"),\n                  Tooltip.inject(\n                    document.getElementById(n.widgetId),\n                    t(e),\n                    \"95%\",\n                    \"25%\",\n                    \"left\"\n                  );\n            }\n          })(n.tip);\n    }\n  }),\n  PianoRollAssessment = {\n    lanesMatch: function (e, t, n) {\n      var o = e.events.filter(function (e) {\n          return e.lane == n;\n        }),\n        i = t.events.filter(function (e) {\n          return e.lane == n;\n        });\n      return (\n        o.length == i.length &&\n        o.every(function (t) {\n          return i.find(function (e) {\n            return (\n              t.start === e.start &&\n              t.duration === e.duration &&\n              t.lane === e.lane\n            );\n          });\n        })\n      );\n    },\n    populatedLanesMatch: function (e, t, n) {\n      if (!e || !t) return !1;\n      for (var o = 0; o < n; o++) {\n        if (\n          0 <\n            e.events.filter(function (e) {\n              return e.lane == o;\n            }).length &&\n          !PianoRollAssessment.lanesMatch(e, t, o)\n        )\n          return !1;\n      }\n      return !0;\n    },\n    modelsMatch: function (e, t, n) {\n      if (!e || !t) return !1;\n      if (e.events.length != t.events.length) return !1;\n      for (var o = 0; o < n; o++)\n        if (!PianoRollAssessment.lanesMatch(e, t, o)) return !1;\n      return !0;\n    },\n  },\n  PIANOROLL_VERSION = 2,\n  PianoRollEditor = (window.PianoRollEditor = function () {\n    var o,\n      i,\n      r,\n      a,\n      s,\n      l,\n      d,\n      u = this;\n    return (\n      (u.init = function (e) {\n        (i = e),\n          (function () {\n            for (var e = i.lanes, t = 0; t < e.length; t++)\n              void 0 === e[t].color && (e[t].color = \"none\"),\n                void 0 === e[t].freq && (e[t].freq = null),\n                void 0 === e[t].midi && (e[t].midi = null),\n                void 0 === e[t].choke && (e[t].choke = null);\n            ((l = document.createElement(\"div\")).style.width = m() + \"px\"),\n              (l.style.position = \"relative\"),\n              (l.style.overflow = \"hidden\"),\n              (l.style.backgroundColor = \"#666\"),\n              Tooltip.appendTooltippableChild(\n                document.getElementById(i.widgetId),\n                l\n              );\n            var n = document.createElement(\"div\");\n            l.appendChild(n),\n              (o = Elm.SimplePianoRoll.embed(n, {\n                lanes: e,\n                beats: i.beats,\n                gridSize: i.gridSize / 4,\n                width: m(),\n                height: f(),\n                labelWidth: T(),\n                scaleName: i.defaultScale ? i.defaultScale : null,\n                rootName: i.defaultRoot ? i.defaultRoot : null,\n                octave: i.defaultOctave ? parseInt(i.defaultOctave) : null,\n                octaveCount: i.defaultOctaveCount\n                  ? parseInt(i.defaultOctaveCount)\n                  : null,\n                showRootChooser: \"yes\" == i.showRootChooser,\n                showScaleChooser: \"yes\" == i.showScaleChooser,\n                availableScales: i.availableScales\n                  ? i.availableScales.split(\",\")\n                  : [],\n                showTempoSlider: \"no\" != i.showTempoSlider,\n                showSettings: !0,\n                tempo: parseFloat(i.tempo),\n                highlightedLanes: i.highlightedLanes ? i.highlightedLanes : [],\n                options: {\n                  allowResize: null == i.allowResize || i.allowResize,\n                },\n              })),\n              o.ports.exportModel.subscribe(function (e) {\n                var t = !r || e.page != r.page,\n                  n = !r || e.lanes.length != r.lanes.length;\n                (r = e),\n                  u.trigger(\"modelChange\", e),\n                  t && u.trigger(\"pageChange\"),\n                  n && c();\n              }),\n              o.ports.previewNotes.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesSelected.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesDragged.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesAdded.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !1);\n              }),\n              o.ports.tempoChanged.subscribe(function (e) {\n                u.trigger(\"tempoChanged\", e);\n              }),\n              ((d = document.createElement(\"div\")).className =\n                \"widget-pianoroll__mouse-observer-holder\"),\n              (d.style.left = T() + \"px\"),\n              (d.style.width = g() + \"px\"),\n              (d.style.height = h() + \"px\"),\n              l.appendChild(d),\n              new SingleTouchObserver().init({\n                node: d,\n                onDown: function (e, t) {\n                  o.ports.mouseDown.send([e, t]);\n                },\n                onMove: function (e, t) {\n                  o.ports.mouseMove.send([e, t]);\n                },\n                onUp: function (e, t) {\n                  o.ports.mouseUp.send([e, t]);\n                },\n              }),\n              ((a = document.createElement(\"div\")).className =\n                \"widget-pianoroll__playhead\"),\n              (a.style.bottom = \"0px\"),\n              (a.style.height = h() - 2 + \"px\"),\n              l.appendChild(a),\n              ((s = document.createElement(\"div\")).className =\n                \"widget-pianoroll__playhead\"),\n              (s.style.bottom = p() + \"px\"),\n              (s.style.height = y() - 1 + \"px\"),\n              l.appendChild(s),\n              c(),\n              window.addEventListener(\"resize\", c);\n          })();\n      }),\n      (u.clear = function () {\n        o.ports.clear.send(\"\");\n      }),\n      (u.setModel = function (e) {\n        if (!e || e.version != PIANOROLL_VERSION) return;\n        (e.lanes = i.lanes),\n          (e.showSettings = !0),\n          (null != e.scaleName && \"yes\" == i.showScaleChooser) ||\n            (e.scaleName = i.defaultScale ? i.defaultScale : null);\n        (null != e.rootName && \"yes\" == i.showRootChooser) ||\n          (e.rootName = i.defaultRoot ? i.defaultRoot : null);\n        (e.octave = i.defaultOctave ? parseInt(i.defaultOctave) : null),\n          (e.octaveCount = i.defaultOctaveCount\n            ? parseInt(i.defaultOctaveCount)\n            : null),\n          null == e.tempo\n            ? (e.tempo = parseFloat(i.tempo))\n            : (e.tempo = parseFloat(e.tempo));\n        o.ports.importModel.send(e);\n      }),\n      (u.getModel = function (e) {\n        return r;\n      }),\n      (u.record = function (e) {\n        o.ports.record.send([e.lane, e.start]);\n      }),\n      (u.setPlayhead = function (e) {\n        if (0 < e) {\n          (s.style.transform = \"translateX(\" + (e * g() + T()) + \"px)\"),\n            (s.style.opacity = 1);\n          var t = (function () {\n              var e = r ? r.page : -1,\n                t = -1 == e || 0 == e ? 0 : 4 * e - 0.25,\n                n =\n                  -1 == e || e == i.beats / 4 - 1\n                    ? i.beats\n                    : 4 * (e + 1) + 0.25;\n              return [t / i.beats, n / i.beats];\n            })(),\n            n = pctInRange(t[0], t[1], e);\n          fitsInRange(0, 1, n)\n            ? ((a.style.transform = \"translateX(\" + (n * g() + T()) + \"px)\"),\n              (a.style.opacity = 1))\n            : (a.style.opacity = 0);\n        } else (a.style.opacity = 0), (s.style.opacity = 0);\n      }),\n      (u.setOptions = function (e) {\n        o.ports.setOptions.send(e);\n      }),\n      (u.updateTempo = function (e) {\n        o.ports.setTempo.send(parseFloat(e));\n      }),\n      (u.getEditorTooltipWrapper = function () {\n        return l.parentElement;\n      }),\n      u\n    );\n    function c() {\n      (l.style.width = m() + \"px\"),\n        (a.style.height = h() - 1 + \"px\"),\n        (d.style.width = g() + \"px\"),\n        (d.style.height = h() + \"px\"),\n        (s.style.bottom = p() + \"px\"),\n        o.ports.setSize.send([m(), f()]);\n    }\n    function p() {\n      return h() + 1;\n    }\n    function f() {\n      return h() + y();\n    }\n    function m() {\n      var e = document.getElementById(i.widgetId);\n      return parseInt(e.offsetWidth, 10);\n    }\n    function g() {\n      return m() - T();\n    }\n    function h() {\n      return (\n        (function () {\n          var e = isMobile() ? 36 : 60,\n            t = (25 - e) / 12,\n            n = e - 4 * t,\n            o = Math.round(t * v() + n);\n          return _.clamp(o, 25, e);\n        })() * v()\n      );\n    }\n    function v() {\n      return r ? r.lanes.length : i.lanes.length;\n    }\n    function y() {\n      return 4 < i.beats ? 50 : 0;\n    }\n    function T() {\n      return i ? (\"drums\" != i.material || isMobile() ? 62 : 124) : 62;\n    }\n  });\nMicroEvent.mixin(PianoRollEditor);\nvar PianoRollExport = {\n    createExportData: function (t, e, n) {\n      var o = t.events.map(function (e) {\n        return {\n          midi: PianoRollExport.laneToMidi(t, e.lane),\n          startInBeats: e.start,\n          durationInBeats: e.duration,\n        };\n      });\n      return {\n        tempo: e,\n        tracks: [{ instrument: n, clip: { lengthInBeats: t.beats, notes: o } }],\n      };\n    },\n    laneToMidi: function (e, t) {\n      var n = e.lanes.length,\n        o = e.lanes[n - 1 - t];\n      return o.freq ? Math.round(Tone.Frequency(o.freq).toMidi()) : o.midi;\n    },\n  },\n  PianoRollPlayer = (window.PianoRollPlayer = function (widget /* ARLAN CODE */) {\n    var o,\n      l,\n      d,\n      t,\n      u = this;\n    return (\n      (u.setModel = function (e) {\n        l = e;\n      }),\n      (u.setLoop = function (e) {\n        (t = e), o && (i(), (Tone.Transport.position = \"0:0:0\"), n());\n      }),\n      (u.start = n),\n      (u.stop = i),\n      (u.record = function (e) {\n        d = d || [];\n        d.push(e);\n      }),\n      (u.progress = function () {\n        if (!l || !o) return 0;\n        var e = getTotalBeats(Tone.Time(o.loopStart).toBarsBeatsSixteenths()),\n          t = getTotalBeats(Tone.Time(o.loopEnd).toBarsBeatsSixteenths()),\n          n = o.progress * (t - e);\n        return (e + n) / l.beats;\n      }),\n      (u.previewNotes = function (e) {\n        console.log(\"previewNotes\", e)\n        var t = e.map(function (e) {\n            return e.lane;\n          }),\n          n = _.uniq(t).map(function (e) {\n            var t = l.lanes.length - 1 - e;\n            return { lane: l.lanes[t], length: \"16n\", time: \"+0.1\" };\n          });\n        // BEGIN ARLAN CODE\n        console.log(u, o, l, d, t, widget.getConfig().widgetId)\n        if (n.length > 0 && window.arlan_ws) {\n          window.arlan_ws.send(JSON.stringify({\n            type: \"sound\",\n            model: widget.getConfig().widgetId,\n            sound: n,\n          }))\n        }\n        // END ARLAN CODE\n        u.trigger(\"playNotes\", n);\n      }),\n      u\n    );\n    function n(e) {\n      console.log(\"n\", e)\n      l &&\n        ((function () {\n          var r = 1 / l.gridSize,\n            a = 4 * l.gridSize + \"n\",\n            e = l.gridSize * l.beats,\n            s = l.lanes.length;\n          o && o.dispose();\n          o = new Tone.Sequence(\n            function (i, e) {\n              if (l) {\n                var t = e * r;\n                d &&\n                  (function (t) {\n                    (d = d.filter(function (e) {\n                      return (e.start + e.duration) % l.beats > t;\n                    })),\n                      0 === t &&\n                        (d = d.filter(function (e) {\n                          return e.start + e.duration > l.beats;\n                        }));\n                  })(t);\n                var n = (function (t) {\n                  return l.events.filter(function (e) {\n                    return e.start == t;\n                  });\n                })(t)\n                  .filter(function (t) {\n                    return !(\n                      d &&\n                      -1 !=\n                        d.findIndex(function (e) {\n                          return e.lane == t.lane;\n                        })\n                    );\n                  })\n                  .map(function (e) {\n                    var t = e.duration / r,\n                      n = s - e.lane - 1,\n                      o = a + \" * \" + t;\n                    return { lane: l.lanes[n], length: o, time: i };\n                  });\n                u.trigger(\"playNotes\", n);\n              }\n            },\n            _.range(0, e),\n            a\n          );\n        })(),\n        t\n          ? ((o.loopStart = beatsAsBarsBeatsSixteenths(t.start)),\n            (o.loopEnd = beatsAsBarsBeatsSixteenths(t.end)),\n            (o.loop = !0),\n            o.start(e, o.loopStart))\n          : o.start(e));\n    }\n    function i(e) {\n      o && o.stop(e);\n    }\n  });\nMicroEvent.mixin(PianoRollPlayer);\nvar SimplePianoRoll = (window.SimplePianoRoll = function () {\n  var t,\n    i,\n    r,\n    n,\n    o,\n    a,\n    s,\n    l,\n    d,\n    u,\n    c = this;\n  return (\n    (c.init = function (e) {\n      if (!BrowserCompatibility.isBrowserCompatible())\n        return void BrowserCompatibility.appendCompatibilityWarning(\n          document.getElementById(e.widgetId),\n          e.lang[\"@incompatiblebrowser\"]\n        );\n      isMobile() &&\n        document.getElementById(e.widgetId).classList.add(\"widget-is-mobile\");\n      (i = e), (t = new Loader()).init(i), i.recorder && i.recorder.connect(b);\n      i.exporter && \"yes\" != i.disableExport && i.exporter.registerWidget(c);\n      (s = new PianoRollPlayer(c /* ARLAN CODE */)),\n        \"tonal\" == i.material\n          ? (d = new Piano()).init(i.instrument).then(p)\n          : \"drums\" == i.material &&\n            (d = new Drumkit()).init(i.instrument.samples).then(p),\n        T(),\n        (u = _.debounce(g, 500));\n    }),\n    (c.showTargetState = function () {\n      r.setTempo(w()), l.setModel(JSON.parse(i.targetState));\n    }),\n    (c.getExportInfo = function () {\n      return PianoRollExport.createExportData(\n        l.getModel(),\n        r.getTempo(),\n        i.instrument.livePreset\n      );\n    }),\n    (c.getConfig = function () {\n      return i;\n    }),\n    // BEGIN ARLAN CODE\n    (c.getLiveAdjustThings = function () {\n      return {transport: r, modelSetter: l, player: s};\n    }),\n    // END ARLAN CODE\n    c\n  );\n  function p() {\n    t.onAudioLoaded(),\n      SUPERVISOR.makeGestureOnElementResumeAudioContext(\n        document.getElementById(i.widgetId)\n      ),\n      (function () {\n        var e = document.createElement(\"div\");\n        (e.className = \"widget__menu\"),\n          document.getElementById(i.widgetId).appendChild(e),\n          (r = new Transport()).init({\n            node: e,\n            onStartPlayback: function () {\n              console.log(\"onStartPlayback\")\n              s.start();\n            },\n            onStartQuantizedPlayback: function () {\n              console.log(\"onStartQuantizedPlayback\")\n              s.start(\"@1m\");\n            },\n            onStopPlayback: function () {\n              console.log(\"onStopPlayback\")\n              s.stop(), d.stopAll();\n            },\n            onPlay: i.onPlay, // \"join\"\n            tempo: w(),\n            onTempoChanged: function (e) {\n              l.updateTempo(e), y(), u();\n            },\n            showRecordButton: i.recorder,\n            widgetId: i.widgetId,\n          }),\n          (i.defaultState || i.tempo) &&\n            (((n = document.createElement(\"button\")).innerHTML =\n              i.lang[\"@reset\"]),\n            (n.className = \"widget-button widget-button--hidden\"),\n            (n.onclick = v),\n            e.appendChild(n));\n        ((o = document.createElement(\"button\")).innerHTML = i.lang[\"@clear\"]),\n          (o.className = \"widget-button\"),\n          (o.style.marginLeft = \"auto\"),\n          (o.onclick = function () {\n            l.clear();\n          }),\n          e.appendChild(o),\n          ((a = document.createElement(\"button\")).innerHTML =\n            i.lang[\"@exporttolive\"]),\n          (a.className = \"btn btn--link btn--cropped\"),\n          (a.onclick = function () {\n            if (!m())\n              return (\n                (a.style.pointerEvents = \"none\"),\n                (a.style.opacity = 0.25),\n                void f(\"exportnotsupportedchromeios\")\n              );\n            (a.style.pointerEvents = \"none\"),\n              (a.innerHTML = i.lang[\"@exporting\"] + \"...\"),\n              c.trigger(\"export\", c, function (e) {\n                (a.style.pointerEvents = \"initial\"),\n                  (a.innerHTML = i.lang[\"@exporttolive\"]),\n                  e && console.log(e);\n              });\n          }),\n          \"yes\" != i.disableExport &&\n            (Tooltip.appendTooltippableChild(e, a),\n            LiveSetExport.checkExportServiceAvailablility(function (e) {\n              (a.style.opacity = e ? 1 : 0.25),\n                (a.style.pointerEvents = e ? \"auto\" : \"none\");\n            }));\n      })(),\n      (l = new PianoRollEditor()).init(i),\n      l.bind(\"modelChange\", function (e) {\n        // console.log(\"modelChange\", e)\n        s.setModel(e),\n          T(),\n          y(),\n          (function () {\n            if (o) {\n              var e = (function () {\n                var e = l ? l.getModel() : void 0;\n                return !!e && 0 < e.events.length;\n              })()\n                ? \"\"\n                : \"widget-button--hidden\";\n              o.className = \"btn btn--link btn--cropped \" + e;\n            }\n          })(),\n          u();\n      }),\n      l.bind(\"pageChange\", function () {\n        !(function () {\n          if (\"takeover\" != i.onPlay) return;\n          d.stopAll();\n          var e = l ? l.getModel() : void 0;\n          e && -1 != e.page\n            ? s.setLoop({ start: 4 * e.page, end: 4 * e.page + 4 })\n            : s.setLoop({ start: 0, end: i.beats });\n        })();\n      }),\n      l.bind(\"previewNotes\", function (e, t) {\n        console.log(\"previewNotes\", e, t);\n        (!t && r.isPlaying()) || s.previewNotes(e);\n      }),\n      l.bind(\"tempoChanged\", function (e) {\n        r.setTempo(e), y(), u();\n      }),\n      s.bind(\"playNotes\", function (e) {\n        // console.log(\"playNotes\", e)\n        \"tonal\" == i.material\n          ? e.forEach(function (e) {\n              d.playNoteAtFrequency(e.lane.freq, e.time, e.length);\n            })\n          : \"drums\" == i.material && d.playNotes(e);\n      }),\n      4 === i.beats &&\n        \"drums\" === i.material &&\n        null == i.recorder &&\n        (function () {\n          var e = document.createElement(\"div\");\n          e.className = \"widget-drumsequencer__column-labels\";\n          for (var t = 0; t < 16; t++) {\n            var n = document.createElement(\"div\");\n            (n.className = \"widget-drumsequencer__column-label\"),\n              t % 4 == 0 &&\n                n.classList.add(\"widget-drumsequencer__column-label--beat\"),\n              (n.innerHTML = t + 1),\n              e.appendChild(n);\n          }\n          document.getElementById(i.widgetId).appendChild(e);\n        })(),\n      i.defaultState && v();\n    var e = getSavedModel(i.widgetId);\n    e && (e.tempo && r.setTempo(e.tempo), l.setModel(e)),\n      i.tip && f(i.tip),\n      d3.timer(h);\n  }\n  function f(e) {\n    function t(e) {\n      var t = i.tips[e];\n      return (t.name = e), (t[\"@close\"] = i.lang[\"@close\"]), t;\n    }\n    switch (e) {\n      case \"playstop\":\n        Tooltip.inject(\n          r.playButton().parentElement,\n          t(e),\n          \"100%\",\n          \"50%\",\n          \"left\"\n        );\n        break;\n      case \"record\":\n        Tooltip.inject(r.recordButton().parentElement, t(e));\n        break;\n      case \"createdeletenotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"70%\", \"60%\");\n        break;\n      case \"dragnotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"50%\", \"55%\");\n        break;\n      case \"resizenotes\":\n      case \"selectnotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"50%\", \"65%\");\n        break;\n      case \"tempo\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"15%\", \"50%\");\n        break;\n      case \"overview\":\n        Tooltip.inject(\n          l.getEditorTooltipWrapper(),\n          t(e),\n          \"30%\",\n          \"80%\",\n          \"right\"\n        );\n        break;\n      case \"export\":\n        m() && Tooltip.inject(a.parentElement, t(e), \"100%\", \"50%\", \"right\");\n        break;\n      case \"exportnotsupportedchromeios\":\n        Tooltip.inject(a.parentElement, t(e), \"100%\", \"50%\", \"right\");\n    }\n  }\n  function m() {\n    return !isChromeOnIOS();\n  }\n  function g() {\n    var e = l.getModel();\n    e &&\n      ((e.tempo = r.getTempo()),\n      trySaveState(e, i.widgetId, PIANOROLL_VERSION));\n  }\n  function h() {\n    var e = r.isPlaying() ? s.progress() : 0;\n    l.setPlayhead(e);\n  }\n  function v() {\n    if ((r.setTempo(w()), i.defaultState))\n      l.setModel(JSON.parse(i.defaultState));\n    else if (i.defaultRoot || i.defaultScale) {\n      var e = l.getModel();\n      (e.scaleName = i.defaultScale),\n        (e.rootName = i.defaultRoot),\n        (e.tempo = w()),\n        l.setModel(e);\n    }\n  }\n  function y() {\n    if (n) {\n      var e = (function () {\n        var e = l ? l.getModel() : void 0;\n        return i.defaultState\n          ? w() === r.getTempo() &&\n              E(e) &&\n              PianoRollAssessment.modelsMatch(\n                JSON.parse(i.defaultState),\n                l.getModel(),\n                i.lanes.length\n              )\n          : w() === r.getTempo() && E(e);\n      })()\n        ? \"widget-button--hidden\"\n        : \"\";\n      n.className = \"btn btn--link btn--cropped \" + e;\n    }\n  }\n  function T() {\n    var e = document.getElementById(i.widgetId + \"correct\"),\n      t = document.getElementById(i.widgetId + \"generic\");\n    if (e && t) {\n      var n = (function () {\n        var e = l ? l.getModel() : void 0;\n        if (!i.targetState || !e) return !1;\n        {\n          if (\"tonal\" == i.material)\n            return PianoRollAssessment.modelsMatch(\n              JSON.parse(i.targetState),\n              l.getModel(),\n              e.lanes.length\n            );\n          if (\"drums\" == i.material)\n            return PianoRollAssessment.populatedLanesMatch(\n              JSON.parse(i.targetState),\n              l.getModel(),\n              e.lanes.length\n            );\n        }\n      })();\n      (e.className = n\n        ? \"widget__dynamic-text\"\n        : \"widget__dynamic-text widget__dynamic-text--hidden\"),\n        (t.className = n\n          ? \"widget__dynamic-text widget__dynamic-text--hidden\"\n          : \"widget__dynamic-text\");\n    }\n  }\n  function w() {\n    return i.tempo ? parseInt(i.tempo) : 85;\n  }\n  function E(e) {\n    if (!e) return !0;\n    var t = !i.defaultRoot || i.defaultRoot === e.rootName,\n      n = !i.defaultScale || i.defaultScale === e.scaleName;\n    return t && n;\n  }\n  function b(e) {\n    var t = i.lanes.map(function (e) {\n        return e.midi;\n      }),\n      n = i.lanes.length - t.indexOf(e.midi) - 1,\n      o = s.progress() * i.beats;\n    r.isRecording() &&\n      r.isPlaying() &&\n      (l.record({ lane: n, start: o, duration: 0.25 }),\n      s.record({ lane: n, start: o, duration: 0.25 }));\n  }\n});\nMicroEvent.mixin(SimplePianoRoll);\nvar SimpleSession = (window.SimpleSession = function () {\n    var o, n, i, r, a, s, l, d;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (o = e),\n          (r = document.getElementById(o.widgetId)),\n          (i = new Loader()).init(o),\n          (Tone.Transport.bpm.value = o.preset.tempo),\n          (l = \"stopped\"),\n          (s = new Tone.MultiPlayer(\n            (function (e) {\n              var o = {},\n                i = getAudioExtension();\n              return (\n                e.tracks.forEach(function (e, t) {\n                  e.clips.forEach(function (e, t) {\n                    var n = e.name;\n                    o[n] = pathToWidgetSounds() + e.path + i;\n                  });\n                }),\n                o\n              );\n            })(o.preset),\n            function () {\n              !(function () {\n                i.onAudioLoaded(),\n                  SUPERVISOR.makeGestureOnElementResumeAudioContext(r),\n                  (a = document.createElement(\"div\")),\n                  Tooltip.appendTooltippableChild(r, a);\n                for (var e = 0; e < o.preset.tracks.length; e++) {\n                  var t = o.preset.tracks[e];\n                  t.name = t[\"@name\"];\n                }\n                (n = Elm.SimpleSession.embed(a, o.preset)),\n                  Tone.Transport.scheduleRepeat(function (e) {\n                    n.ports.onTick.send(\"\" + e);\n                  }, \"1m\"),\n                  n.ports.playSound.subscribe(function (e) {\n                    var t = e[0],\n                      n = e[1];\n                    \"stopped\" == Tone.Transport.state &&\n                      ((Tone.Transport.position = \"0:0:0\"),\n                      Tone.Transport.start(ToneTransportStartDelay())),\n                      \"stopped\" == l && (l = \"playing\"),\n                      (function (e, t) {\n                        o.preset.tracks[t].clips.forEach(function (t) {\n                          t.name != e.name &&\n                            (Tone.Transport.clear(d[t.name]),\n                            Tone.Transport.scheduleOnce(function (e) {\n                              try {\n                                s.stop(t.name, e);\n                              } catch (e) {}\n                            }, \"@1m\"));\n                        });\n                      })(t, n),\n                      (d[t.name] = Tone.Transport.scheduleRepeat(\n                        function (e) {\n                          try {\n                            s.stop(t.name, e);\n                          } catch (e) {}\n                          s.start(t.name, e, 0, t.length),\n                            SUPERVISOR.registerPlayingWidget(o.widgetId);\n                        },\n                        t.length,\n                        \"@1m\"\n                      ));\n                  }),\n                  n.ports.unqueueSound.subscribe(function (e) {\n                    Tone.Transport.clear(d[e.name]);\n                  }),\n                  n.ports.stopSound.subscribe(function (t) {\n                    Tone.Transport.clear(d[t.name]),\n                      Tone.Transport.scheduleOnce(function (e) {\n                        try {\n                          s.stop(t.name, e);\n                        } catch (e) {}\n                      }, \"@1m\");\n                  }),\n                  n.ports.allSoundsStopped.subscribe(function (e) {\n                    SUPERVISOR.isOnlyWidgetPlaying(o.widgetId) &&\n                      ((Tone.Transport.position = \"0:0:0\"),\n                      Tone.Transport.stop()),\n                      (l = \"stopped\"),\n                      SUPERVISOR.unregisterPlayingWidget(o.widgetId);\n                  }),\n                  o.tip &&\n                    (function (e) {\n                      switch (e) {\n                        case \"devicemute\":\n                          if (!isMobile()) return;\n                          Tooltip.inject(\n                            a,\n                            (function (e) {\n                              var t = o.tips[e];\n                              return (\n                                (t.name = e),\n                                (t[\"@close\"] = o.lang[\"@close\"]),\n                                t\n                              );\n                            })(e),\n                            \"65%\",\n                            \"60%\",\n                            \"right\"\n                          );\n                      }\n                    })(o.tip);\n              })();\n            }\n          ).toMaster()),\n          (d = {});\n      }),\n      this\n    );\n  }),\n  SongFormExplorer = (window.SongFormExplorer = function () {\n    var i, r, a;\n    return (\n      (this.init = function (e) {\n        (a = e),\n          (r = document.getElementById(a.widgetId)),\n          (function () {\n            var e = document.createElement(\"div\");\n            r.appendChild(e);\n            for (var t = 0; t < a.preset.sections.length - 1; t++) {\n              var n = a.preset.sections[t],\n                o = a.preset.sections[t + 1];\n              n.end = o.start;\n            }\n            a.preset.sections[a.preset.sections.length - 1].end =\n              a.preset.songLength;\n            for (t = 0; t < a.preset.sections.length; t++) {\n              ((n = a.preset.sections[t]).description = n[\"@description\"]),\n                (n.name = n[\"@name\"]),\n                (n.label = n[\"@label\"]);\n            }\n            for (t = 0; t < a.preset.sections.length; t++) {\n              (n = a.preset.sections[t])[\"@label\"] || (n.label = n.name);\n            }\n            (i = Elm.SongFormExplorer.embed(e, a.preset)),\n              i.ports.jumpToSection.subscribe(function (e) {\n                a.player.setPlayheadToTime(e.start);\n              }),\n              a.player.setPlayheadChangedCallback(s),\n              a.tip &&\n                (function (e) {\n                  switch (e) {\n                    case \"songformsections\":\n                      (r.style.position = \"relative\"),\n                        Tooltip.inject(\n                          r,\n                          (function (e) {\n                            var t = a.tips[e];\n                            return (\n                              (t.name = e), (t[\"@close\"] = a.lang[\"@close\"]), t\n                            );\n                          })(e),\n                          \"45px\",\n                          \"65%\"\n                        );\n                  }\n                })(a.tip);\n          })();\n      }),\n      this\n    );\n    function s(e) {\n      i.ports.updatePlayhead.send(e);\n    }\n  });\nfunction onYouTubeIframeAPIReady() {\n  YOUTUBEWIDGETS.forEach(function (e) {\n    e.onYouTubeIframeAPIReady();\n  }),\n    (YOUTUBE_API_READY = !0);\n}\n(YOUTUBEWIDGETS = []), (YOUTUBE_API_READY = !1);\nvar YouTube = (window.YouTube = function () {\n  var n,\n    t,\n    o,\n    i,\n    r,\n    a,\n    s,\n    l,\n    d = this;\n  return (\n    (d.init = function (e) {\n      (n = e),\n        (o = document.getElementById(n.widgetId)),\n        ((i = document.createElement(\"div\")).className =\n          \"widget-video__holder\"),\n        (i.id = n.widgetId + \"video\"),\n        (i.style.display = \"none\"),\n        o.appendChild(i),\n        n.width && (i.style.width = n.width + \"px\");\n      (l = !1),\n        (t = new Loader()).init(n),\n        YOUTUBE_API_READY ? f() : YOUTUBEWIDGETS.push(d);\n    }),\n    (d.onYouTubeIframeAPIReady = function () {\n      f();\n    }),\n    (d.setPlayheadChangedCallback = function (e) {\n      s = e;\n    }),\n    (d.setPlayheadToTime = function (e) {\n      if (void 0 === r || void 0 === r.getPlayerState) return;\n      r.getPlayerState() != YT.PlayerState.PLAYING && s && s(e);\n      r.seekTo(e), l && r.playVideo();\n      Tone.Transport.emit(\"takeover\", n.widgetId);\n    }),\n    d\n  );\n  function e(e) {\n    t.hide(),\n      (document.getElementById(n.widgetId + \"video\").style.display = \"block\"),\n      Tone.Transport.on(\"takeover\", u),\n      document.getElementById(n.widgetId).classList.add(\"is-ready\");\n  }\n  function u(e) {\n    \"takeover\" == n.onPlay &&\n      e != n.widgetId &&\n      r.getPlayerState() === YT.PlayerState.PLAYING &&\n      (r.pauseVideo(), (l = !0));\n  }\n  function c() {\n    r &&\n      r.getPlayerState() == YT.PlayerState.PLAYING &&\n      s &&\n      s(r.getCurrentTime());\n  }\n  function p(e) {\n    if (\n      e.data == YT.PlayerState.PLAYING ||\n      e.data == YT.PlayerState.BUFFERING\n    ) {\n      var t = document.getElementById(n.widgetId);\n      t.classList.remove(\"is-ready\"), t.classList.add(\"is-playing\");\n    }\n    e.data == YT.PlayerState.PLAYING\n      ? (\"takeover\" == n.onPlay && Tone.Transport.emit(\"takeover\", n.widgetId),\n        a ? a.restart(c) : (a = d3.timer(c)),\n        SUPERVISOR.registerPlayingWidget(n.widgetId),\n        (l = !1))\n      : (SUPERVISOR.unregisterPlayingWidget(n.widgetId), a && a.stop(c));\n  }\n  function f() {\n    r = new YT.Player(n.widgetId + \"video\", {\n      videoId: n.videoId,\n      playerVars: {\n        controls: 2,\n        disablekb: 1,\n        showinfo: 0,\n        color: \"white\",\n        modestbranding: 1,\n        fs: 0,\n        playsinline: 1,\n        start: n.start ? parseInt(n.start) : 0,\n        end: n.end ? parseInt(n.end) : void 0,\n        loop: n.loop && \"yes\" === n.loop ? 1 : 0,\n        host: \"https://www.youtube-nocookie.com\",\n      },\n      events: { onReady: e, onStateChange: p },\n    });\n  }\n});\n"],"names":["window","AudioSupervisor","n","e","this","init","document","addEventListener","t","Tone","Transport","latencyHint","isMobile","makeGestureOnElementResumeAudioContext","context","resume","then","removeEventListener","registerPlayingWidget","console","log","indexOf","push","unregisterPlayingWidget","filter","isOnlyWidgetPlaying","length","areAnyWidgetsPlaying","masterEffectChain","Master","hidden","volume","rampTo","BrowserCompatibility","hasOwnProperty","createElement","className","innerHTML","appendChild","Drumkit","i","r","o","Promise","map","path","name","midi","SAMPLE_CACHE","getBuffers","MultiPlayer","toMaster","fadeOut","Buffer","on","a","playNoteAtNumber","playNotes","forEach","some","lane","choke","time","stopAll","buffers","loaded","start","Workarounds","multiplayerStopAll","LiveSetExport","KeySupervisor","keyCode","connectWidget","serviceURL","checkExportServiceAvailablility","XMLHttpRequest","timeout","open","send","createLiveSet","Date","toDateString","replace","backlink","location","href","tempo","tracks","userHasAlreadyExportedOnce","LOCALE_PATH","responseText","isValidFileId","downloadURLFromFileId","storageAvailable","localStorage","setItem","setRequestHeader","JSON","stringify","getItem","match","createDownloadLink","RegExp","exec","s","createTextNode","title","getElementById","style","display","Loader","LiveSetExporter","registerWidget","bind","getExportInfo","getConfig","onPlay","reduce","concat","id","widgetId","hide","onAudioLoaded","Piano","Metronome","metro","getAudioExtension","metroup","value","stop","dispose","Sequence","d","u","c","l","samples","connect","SUPERVISOR","fadeout","duration","val","nearest","offset","p","playNoteAtFrequency","Math","round","Frequency","toMidi","SingleTouchObserver","Recorder","recordEvent","SampleCache","Buffers","getBuffer","has","get","add","extension","d3","select","node","append","attr","event","type","button","classed","mouse","onDown","activeElement","blur","preventDefault","onMove","onUp","Tooltip","inject","userHasSeenTooltip","showalways","getBoundingClientRect","xShiftFactor","xShiftInPx","width","top","left","marginTop","marginLeft","border","borderColor","classList","setUserHasSeenTooltip","tooltipKeyForLocalStorage","appendTooltippableChild","position","onclick","m","parentElement","g","isRecording","isPlaying","getTempo","setTempo","bpm","emit","onTempoChanged","playButton","recordButton","playing","queued","stopped","showRecordButton","METRONOME","onStopPlayback","onStartPlayback","f","scheduleOnce","onStartQuantizedPlayback","getTotalBeats","parseFloat","split","getBars","getBeats","getSixteenths","beatsAsBarsBeatsSixteenths","Time","toBarsBeatsSixteenths","canPlayAudio","supportsType","Number","MAX_VALUE","abs","removeItem","getSavedModel","parse","getSavedModelString","setTimeout","connectToWebsocket","ws","WebSocket","onmessage","message","data","pianoRoll","model","transport","modelSetter","getLiveAdjustThings","state","setModel","player","trigger","sound","Error","onopen","statusElement","onclose","arlan_ws","navigator","userAgent","keyEventToPhysicalKey","code","includes","keyFromPhysicalCode","String","fromCharCode","cookie","domain","clearCookies","GLOBAL_PITCHPAD_SYNTH","PitchpadSynth","createGain","gain","createOscillator","startTouch","findIndex","frequency","setValueAtTime","currentTime","moveTouch","almostEqual","stopTouch","cancelScheduledValues","setTargetAtTime","PianoRollAssessment","ScaleExplorer","mLoader","textAlign","Elm","embed","scale","x","startNote","customNoteNames","I","frequencies","customNoteColors","color","showPiano","showPads","isQuantized","showScaleChooser","showRootChooser","availableScaleNames","availableScales","defaultScaleName","defaultScale","defaultRootName","defaultRoot","scaleCanBeMappedToPiano","keyboardMappings","keyboard","showKeyboardButton","lang","ports","exportScale","subscribe","S","keyboardActive","KEY_SUPERVISOR","y","T","b","h","E","P","w","timer","tip","tips","parseInt","changedTouches","item","touch","identifier","touches","selectAll","exit","remove","enter","merge","v","toUpperCase","noteOn","noteOff","_","clamp","floor","find","resetNoteOnState","keyboardDisconnected","scaleQuantize","range","scaleLinear","toFrequency","freq","SimpleDrumpad","kit","transition","recorder","stopPropagation","html","justifyContent","lanesMatch","events","every","populatedLanesMatch","modelsMatch","PianoRollEditor","lanes","overflow","backgroundColor","SimplePianoRoll","beats","gridSize","height","labelWidth","scaleName","rootName","octave","defaultOctave","octaveCount","defaultOctaveCount","showTempoSlider","showSettings","highlightedLanes","options","allowResize","exportModel","page","previewNotes","notesSelected","notesDragged","notesAdded","tempoChanged","mouseDown","mouseMove","mouseUp","bottom","clear","version","importModel","getModel","record","setPlayhead","transform","opacity","pctInRange","fitsInRange","setOptions","updateTempo","getEditorTooltipWrapper","setSize","offsetWidth","material","MicroEvent","mixin","PianoRollExport","createExportData","laneToMidi","startInBeats","durationInBeats","instrument","clip","lengthInBeats","notes","PianoRollPlayer","widget","setLoop","progress","loopStart","loopEnd","uniq","end","loop","exporter","disableExport","debounce","showTargetState","targetState","livePreset","defaultState","pointerEvents","trySaveState","SimpleSession","preset","clips","scheduleRepeat","onTick","playSound","unqueueSound","stopSound","allSoundsStopped","SongFormExplorer","sections","songLength","description","label","jumpToSection","setPlayheadToTime","setPlayheadChangedCallback","updatePlayhead","YOUTUBEWIDGETS","YOUTUBE_API_READY","YouTube","onYouTubeIframeAPIReady","getPlayerState","YT","PlayerState","PLAYING","seekTo","playVideo","pauseVideo","getCurrentTime","BUFFERING","restart","Player","videoId","playerVars","controls","disablekb","showinfo","modestbranding","fs","playsinline","host","onReady","onStateChange"],"version":3,"file":"index.1768f540.js.map"}