{"mappings":"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","sources":["./src/music-playground/widgets.min.js","./node_modules/lodash.throttle/index.js"],"sourcesContent":["import throttle from 'lodash.throttle'\n\nvar AudioSupervisor = (window.AudioSupervisor = function () {\n    var n,\n      e = this;\n    return (\n      (e.init = function (e) {\n        document.addEventListener &&\n          document.addEventListener(\"visibilitychange\", t),\n          (Tone.Transport.latencyHint = isMobile() ? 0.06 : \"fastest\"),\n          (n = []);\n      }),\n      (e.makeGestureOnElementResumeAudioContext = function (e) {\n        function t() {\n          Tone.context.resume().then(function () {\n            e.removeEventListener(\"touchstart\", t, !0),\n              e.removeEventListener(\"touchend\", t, !0),\n              e.removeEventListener(\"mousedown\", t, !0),\n              e.removeEventListener(\"mouseup\", t, !0),\n              e.removeEventListener(\"click\", t, !0);\n          });\n        }\n        e.addEventListener(\"touchstart\", t, !0),\n          e.addEventListener(\"touchend\", t, !0),\n          e.addEventListener(\"mousedown\", t, !0),\n          e.addEventListener(\"mouseup\", t, !0),\n          e.addEventListener(\"click\", t, !0);\n      }),\n      (e.registerPlayingWidget = function (e) {\n        // console.log('registered', e);\n        -1 == n.indexOf(e) && n.push(e);\n      }),\n      (e.unregisterPlayingWidget = function (t) {\n        // console.log('unregistered', t);\n        n = n.filter(function (e) {\n          return e != t;\n        });\n      }),\n      (e.isOnlyWidgetPlaying = function (e) {\n        return 1 === n.length && n[0] === e;\n      }),\n      (e.areAnyWidgetsPlaying = function () {\n        return 0 < n.length;\n      }),\n      (e.masterEffectChain = function () {\n        return Tone.Master;\n      }),\n      e\n    );\n    function t() {\n      document.hidden && Tone\n        ? Tone.Master.volume.rampTo(-1 / 0, 0.3)\n        : Tone && Tone.Master.volume.rampTo(0, 0.4);\n    }\n  }),\n  BrowserCompatibility = {\n    isBrowserCompatible: function () {\n      var e =\n          window.hasOwnProperty(\"AudioContext\") ||\n          window.hasOwnProperty(\"webkitAudioContext\"),\n        t = window.hasOwnProperty(\"Promise\"),\n        n = window.hasOwnProperty(\"Worker\");\n      return e && t && n;\n    },\n    appendCompatibilityWarning: function (e, t) {\n      var n = document.createElement(\"div\");\n      (n.className = \"widget__compatibility-message\"),\n        (n.innerHTML = t),\n        e.appendChild(n);\n    },\n  },\n  Drumkit = (window.Drumkit = function () {\n    var e,\n      i,\n      r,\n      t = this;\n    return (\n      (t.init = function (o) {\n        if (e) return e;\n        return (e = new Promise(function (e) {\n          var t = o.map(function (e) {\n              return { path: e.path, name: e.midi + \"\" };\n            }),\n            n = SAMPLE_CACHE.getBuffers(t);\n          ((r = new Tone.MultiPlayer(n).toMaster()).fadeOut = 0.01),\n            (i = e),\n            Tone.Buffer.on(\"progress\", a),\n            Tone.Buffer.on(\"load\", a),\n            a();\n        }));\n      }),\n      (t.playNoteAtNumber = n),\n      (t.playNotes = function (e) {\n        e.forEach(function (t) {\n          e.some(function (e) {\n            return t.lane.midi === e.lane.choke;\n          }) || n(t.lane.midi, t.time, t.lane.choke);\n        });\n      }),\n      (t.stopAll = function () {\n        r.stopAll();\n      }),\n      t\n    );\n    function a() {\n      r.buffers.loaded && i();\n    }\n    function n(e, t, n) {\n      r.start(e + \"\", t), n && Workarounds.multiplayerStopAll(r, n + \"\", t);\n    }\n  }),\n  KeySupervisor = (window.KeySupervisor = function () {\n    var t,\n      o,\n      i,\n      r,\n      e = this;\n    return (\n      (e.init = function (e) {\n        document.addEventListener(\n          \"keydown\",\n          function (e) {\n            !(function (e) {\n              return !0 === t[e.keyCode];\n            })(e) && ((t[e.keyCode] = !0), o && o(e));\n          },\n          !0\n        ),\n          document.addEventListener(\n            \"keyup\",\n            function (e) {\n              (t[e.keyCode] = !1), i && i(e);\n            },\n            !0\n          ),\n          document.addEventListener &&\n            document.addEventListener(\"visibilitychange\", n),\n          (t = {});\n      }),\n      (e.connectWidget = function (e, t, n) {\n        r && r();\n        (o = e), (i = t), (r = n);\n      }),\n      e\n    );\n    function n() {\n      document.hidden && r && (r(), (r = i = o = null));\n    }\n  }),\n  LiveSetExport = {\n    serviceURL: \"https://learningmusic-export.ableton.com\",\n    checkExportServiceAvailablility: function (e) {\n      var t = new XMLHttpRequest();\n      (t.timeout = 5e3),\n        t.addEventListener(\"load\", function () {\n          e(!0);\n        }),\n        t.addEventListener(\"error\", function () {\n          e(!1);\n        }),\n        t.addEventListener(\"abort\", function () {\n          e(!1);\n        }),\n        t.addEventListener(\"timeout\", function () {\n          e(!1);\n        }),\n        t.open(\"GET\", LiveSetExport.serviceURL + \"/availability\"),\n        t.send();\n    },\n    createLiveSet: function (e, t, n) {\n      var o = new Date().toDateString().replace(/[^a-z0-9]/gi, \"_\"),\n        i = {\n          backlink: window.location.href,\n          name: \"idea_\" + o,\n          tempo: e,\n          tracks: t,\n        };\n      if (!LiveSetExport.userHasAlreadyExportedOnce())\n        var r = window.open(\n          LOCALE_PATH + \"/live-set-export-waiting.html\",\n          \"_blank\"\n        );\n      var a = new XMLHttpRequest();\n      a.addEventListener(\"load\", function () {\n        n(void 0);\n        var e = this.responseText;\n        if (LiveSetExport.userHasAlreadyExportedOnce())\n          LiveSetExport.isValidFileId(e) &&\n            (window.location = LiveSetExport.downloadURLFromFileId(e));\n        else {\n          storageAvailable(\"localStorage\") &&\n            localStorage.setItem(\"__userHasExported\", \"yes\");\n          var t = \"?fileId=\" + e;\n          r.location.href = LOCALE_PATH + \"/live-set-export.html\" + t;\n        }\n      }),\n        a.addEventListener(\"error\", function () {\n          n(\"Export failed.\");\n        }),\n        a.addEventListener(\"abort\", function () {\n          n(\"Export was cancelled.\");\n        }),\n        a.open(\"POST\", LiveSetExport.serviceURL + \"/export\"),\n        a.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\"),\n        a.send(JSON.stringify(i));\n    },\n    downloadURLFromFileId: function (e) {\n      return LiveSetExport.serviceURL + \"/export?id=\" + e;\n    },\n    userHasAlreadyExportedOnce: function () {\n      return (\n        !!storageAvailable(\"localStorage\") &&\n        \"yes\" == localStorage.getItem(\"__userHasExported\")\n      );\n    },\n    isValidFileId: function (e) {\n      return e.match(\n        \"[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}\"\n      );\n    },\n    createDownloadLink: function (e, t) {\n      var n,\n        o,\n        i,\n        r =\n          ((n = \"fileId\"),\n          (o = window.location.href),\n          (i = new RegExp(\"[?&]\" + n + \"=([^&#]*)\", \"i\").exec(o))\n            ? i[1]\n            : null);\n      if (LiveSetExport.isValidFileId(r)) {\n        void 0 === t && (t = \"\");\n        var a = document.createElement(\"a\"),\n          s = document.createTextNode(\"Download\");\n        a.appendChild(s),\n          (a.title = \"Download your music as an Ableton Live Set\"),\n          (a.href = LiveSetExport.downloadURLFromFileId(r)),\n          (a.className = t),\n          document.getElementById(e).appendChild(a),\n          a.addEventListener(\"click\", function () {\n            a.style.display = \"none\";\n          });\n      } else\n        document.getElementById(e).innerHTML =\n          \"Error exporting to Live. Please try again.\";\n    },\n  },\n  LiveSetExporter = (window.LiveSetExporter = function () {\n    var i;\n    return (\n      (this.init = function () {\n        i = [];\n      }),\n      (this.registerWidget = function (e) {\n        i.push(e),\n          e.bind(\"export\", function (e, t) {\n            var n = e.getExportInfo();\n            if (\"takeover\" === e.getConfig().onPlay)\n              LiveSetExport.createLiveSet(n.tempo, n.tracks, t);\n            else {\n              var o = i.reduce(function (e, t) {\n                return e.concat(t.getExportInfo().tracks);\n              }, []);\n              LiveSetExport.createLiveSet(n.tempo, o, t);\n            }\n          });\n      }),\n      this\n    );\n  }),\n  Loader = (window.Loader = function () {\n    var t, n;\n    return (\n      (this.init = function (e) {\n        ((t = document.createElement(\"div\")).id = e.widgetId + \"loader\"),\n          (t.className = \"\"),\n          ((n = document.createElement(\"div\")).className =\n            \"widget-loader__loading-animation\"),\n          t.appendChild(n),\n          document.getElementById(e.widgetId).appendChild(t);\n      }),\n      (this.hide = function () {\n        t.style.display = \"none\";\n      }),\n      (this.onAudioLoaded = function () {\n        n.style.display = \"none\";\n      }),\n      this\n    );\n  }),\n  Metronome = (window.Metronome = function () {\n    var o, t;\n    return (\n      (this.init = function (e) {\n        var t = pathToWidgetSounds(),\n          n = {\n            metro: t + \"metronome/Metronome\" + getAudioExtension(),\n            metroup: t + \"metronome/MetronomeUp\" + getAudioExtension(),\n          };\n        (o = new Tone.MultiPlayer(n, i).toMaster()).volume.value = 12;\n      }),\n      (this.start = function (e) {\n        i(), t.start(e);\n      }),\n      (this.stop = function (e) {\n        t.stop(e), t.dispose();\n      }),\n      this\n    );\n    function i() {\n      t = new Tone.Sequence(\n        function (e, t) {\n          o.start(t, e);\n        },\n        [\"metroup\", \"metro\", \"metro\", \"metro\"],\n        \"4n\"\n      );\n    }\n  }),\n  Piano = (window.Piano = function () {\n    var e,\n      d,\n      u,\n      i,\n      c,\n      t = this;\n    return (\n      (t.init = function (l) {\n        (i = l),\n          (e =\n            e ||\n            new Promise(function (e) {\n              var t,\n                n,\n                o,\n                i,\n                r = l.samples.map(function (e) {\n                  return { path: e.path, name: e.midi + \"\" };\n                }),\n                a = SAMPLE_CACHE.getBuffers(r);\n              (u = new Tone.MultiPlayer(a)).connect(\n                SUPERVISOR.masterEffectChain()\n              ),\n                (u.fadeOut = l.fadeout.duration),\n                (c = []);\n              for (var s = 0; s < 128; s++)\n                c.push(\n                  ((t = s),\n                  (n = l.samples),\n                  void 0,\n                  (o = n.map(function (e) {\n                    return e.midi;\n                  })),\n                  { val: (i = nearest(t, o)), offset: t - i })\n                );\n              (d = e),\n                Tone.Buffer.on(\"progress\", p),\n                Tone.Buffer.on(\"load\", p),\n                p();\n            }));\n        return e;\n      }),\n      (t.playNoteAtFrequency = function (e, t, n) {\n        o(Math.round(Tone.Frequency(e).toMidi()), t, n);\n      }),\n      (t.playNoteAtNumber = o),\n      (t.stopAll = function () {\n        u.stopAll();\n      }),\n      t\n    );\n    function p() {\n      u.buffers.loaded && d();\n    }\n    function o(e, t, n) {\n      var o = c[e];\n      u.start(o.val + \"\", t, 0, n + \"-\" + i.fadeout.offset, o.offset);\n    }\n  }),\n  Recorder = (window.Recorder = function () {\n    var t;\n    return (\n      (this.init = function (e) {}),\n      (this.recordEvent = function (e) {\n        t && t(e);\n      }),\n      (this.connect = function (e) {\n        t = e;\n      }),\n      this\n    );\n  }),\n  SampleCache = (window.SampleCache = function () {\n    var i,\n      n = this;\n    return (\n      (n.init = function () {\n        i = new Tone.Buffers();\n      }),\n      (n.getBuffer = function (e, t) {\n        {\n          if (i.has(e)) return i.get(e);\n          var n = t || getAudioExtension(),\n            o = pathToWidgetSounds() + e + n;\n          return i.add(e, o), i.get(e);\n        }\n      }),\n      (n.getBuffers = function (e) {\n        var t = new Tone.Buffers();\n        return (\n          e.forEach(function (e) {\n            t.add(e.name, n.getBuffer(e.path, e.extension));\n          }),\n          t\n        );\n      }),\n      n\n    );\n  }),\n  SingleTouchObserver = (window.SingleTouchObserver = function () {\n    var r;\n    return (\n      (this.init = function (e) {\n        (r = e),\n          d3\n            .select(e.node)\n            .append(\"div\")\n            .attr(\"class\", \"mouseObserver\")\n            .style(\"width\", \"100%\")\n            .style(\"height\", \"100%\")\n            .on(\"mousedown\", t)\n            .on(\"touchstart\", t);\n      }),\n      this\n    );\n    function t() {\n      if (\"mousedown\" !== d3.event.type || 0 === d3.event.button) {\n        var t = d3.select(this).classed(\"active\", !0),\n          n = d3\n            .select(window)\n            .on(\"touchmove\", o)\n            .on(\"mousemove\", o)\n            .on(\"mouseup\", i)\n            .on(\"touchend\", i),\n          e = d3.mouse(this);\n        r.onDown(e[0], e[1]),\n          document.activeElement && document.activeElement.blur(),\n          d3.event.preventDefault();\n      }\n      function o() {\n        var e = d3.mouse(t.node());\n        r.onMove(e[0], e[1]);\n      }\n      function i() {\n        var e = d3.mouse(t.node());\n        n\n          .on(\"touchmove\", null)\n          .on(\"mousemove\", null)\n          .on(\"mouseup\", null)\n          .on(\"touchend\", null),\n          r.onUp(e[0], e[1]);\n      }\n    }\n  }),\n  Tooltip = {\n    inject: function (e, t, n, o, i) {\n      if (t && e && !(Tooltip.userHasSeenTooltip(t.name) && !t.showalways)) {\n        e.getBoundingClientRect();\n        (xShiftFactor = 0),\n          \"left\" == i\n            ? (xShiftFactor = 0.25)\n            : \"right\" == i && (xShiftFactor = -0.25),\n          (xShiftInPx = 200 * xShiftFactor);\n        var r = document.createElement(\"div\");\n        (r.className = \"widget-tooltip\"),\n          (r.style.width = \"200px\"),\n          (r.style.top = n || \"100%\"),\n          (r.style.left = o || \"50%\"),\n          (r.style.marginTop = \"12px\"),\n          (r.style.marginLeft = -100 + xShiftInPx + \"px\");\n        var a = document.createElement(\"div\");\n        (a.className = \"widget-tooltip__triangle\"),\n          (a.style.top = \"-20px\"),\n          (a.style.left = 90 - xShiftInPx + \"px\"),\n          (a.style.border = \"solid 10px\"),\n          (a.style.borderColor = \"transparent transparent black transparent\"),\n          r.appendChild(a);\n        var s = document.createElement(\"div\");\n        (s.className = \"widget-tooltip__text\"),\n          (s.innerHTML = t[\"@text\"]),\n          r.appendChild(s);\n        var l = document.createElement(\"div\");\n        (l.className = \"widget-tooltip__dismiss\"),\n          (l.innerHTML = t[\"@close\"] ? t[\"@close\"] : \"Close\"),\n          r.appendChild(l),\n          r.addEventListener(\"click\", function () {\n            r.classList.add(\"widget-tooltip--hide\"),\n              Tooltip.setUserHasSeenTooltip(t.name);\n          }),\n          e.appendChild(r);\n      }\n    },\n    tooltipKeyForLocalStorage: function (e) {\n      return \"__tooltip_\" + e;\n    },\n    userHasSeenTooltip: function (e) {\n      return (\n        !!storageAvailable(\"localStorage\") &&\n        \"dismissed\" ==\n          localStorage.getItem(Tooltip.tooltipKeyForLocalStorage(e))\n      );\n    },\n    setUserHasSeenTooltip: function (e) {\n      storageAvailable(\"localStorage\") &&\n        localStorage.setItem(Tooltip.tooltipKeyForLocalStorage(e), \"dismissed\");\n    },\n    appendTooltippableChild: function (e, t) {\n      var n = document.createElement(\"div\");\n      (n.style.position = \"relative\"), n.appendChild(t), e.appendChild(n);\n    },\n  },\n  Transport = (window.Transport = function () {\n    var t,\n      n,\n      o,\n      i,\n      r,\n      a,\n      s,\n      e = this;\n    return (\n      (e.init = function (e) {\n        (n = e),\n          ((t = document.createElement(\"div\")).className = \"widget-transport\"),\n          e.node.appendChild(t),\n          ((o = document.createElement(\"button\")).onclick = m),\n          Tooltip.appendTooltippableChild(t, o),\n          o.parentElement.classList.add(\"widget__transport-btn-wrapper\"),\n          ((i = document.createElement(\"button\")).onclick = g),\n          Tooltip.appendTooltippableChild(t, i),\n          i.parentElement.classList.add(\"widget__transport-btn-wrapper\"),\n          (r = \"stopped\"),\n          (a = !1),\n          (s = e.tempo),\n          Tone.Transport.on(\"takeover\", c),\n          Tone.Transport.on(\"sessionTempoChanged\", l),\n          d();\n      }),\n      (e.isRecording = function () {\n        return a;\n      }),\n      (e.isPlaying = function () {\n        return \"playing\" == r;\n      }),\n      (e.getTempo = function () {\n        return s;\n      }),\n      (e.setTempo = function (e) {\n        (s = e),\n          (\"join\" == n.onPlay || (\"takeover\" == n.onPlay && \"playing\" == r)) &&\n            ((Tone.Transport.bpm.value = s),\n            Tone.Transport.emit(\"sessionTempoChanged\", s));\n        n.onTempoChanged && n.onTempoChanged(s);\n      }),\n      (e.playButton = function () {\n        return o;\n      }),\n      (e.recordButton = function () {\n        return i;\n      }),\n      e\n    );\n    function l(e) {\n      // console.log(\"l\", \"e\");\n      \"join\" == n.onPlay && ((s = e), n.onTempoChanged && n.onTempoChanged(s));\n    }\n    function d() {\n      (o.innerHTML = {\n        playing: \"<i class='icon-pause'></i>\",\n        queued: \"<i class='icon-play widget_transport-icon--queued'></i>\",\n        stopped: \"<i class='icon-play'></i>\",\n      }[r]),\n        (o.className = \"btn widget__transport-btn\"),\n        (function () {\n          i.innerHTML = \"<i class='icon-record'></i>\";\n          var e = n.showRecordButton ? \"\" : \" hidden\";\n          i.className =\n            a && \"playing\" == r\n              ? \"btn widget__transport-btn widget-button--recording\" + e\n              : \"btn widget__transport-btn\" + e;\n        })();\n    }\n    function u() {\n      a && ((a = !1), METRONOME.stop()),\n        n.onStopPlayback(),\n        SUPERVISOR.unregisterPlayingWidget(n.widgetId),\n        (r = \"stopped\"),\n        d();\n    }\n    function c(e) {\n      \"playing\" == r && u();\n    }\n    function p() {\n      (Tone.Transport.bpm.value = s),\n        (Tone.Transport.position = \"0:0:0\"),\n        Tone.Transport.start(ToneTransportStartDelay()),\n        a && METRONOME.start(),\n        n.onStartPlayback(),\n        SUPERVISOR.registerPlayingWidget(n.widgetId),\n        (r = \"playing\"),\n        d();\n    }\n    function f() {\n      (Tone.Transport.position = \"0:0:0\"), Tone.Transport.stop(), u();\n    }\n    // \"Toggle playback\"\n    function m() {\n      // console.log(\"m\", n.widgetId);\n      if ((!0, \"queued\" != r))\n        if (SUPERVISOR.areAnyWidgetsPlaying()) {\n          if (SUPERVISOR.areAnyWidgetsPlaying()) {\n            var e = \"playing\" == r;\n            \"takeover\" == n.onPlay\n              ? e\n                ? f()\n                : (Tone.Transport.emit(\"takeover\"), f(), p())\n              : \"join\" == n.onPlay &&\n                (e\n                  ? SUPERVISOR.isOnlyWidgetPlaying(n.widgetId)\n                    ? f()\n                    : c()\n                  : (a && METRONOME.start(\"@1m\"),\n                    Tone.Transport.scheduleOnce(function (e) {\n                      (r = \"playing\"), d();\n                    }, \"@1m\"),\n                    n.onStartQuantizedPlayback(),\n                    SUPERVISOR.registerPlayingWidget(n.widgetId),\n                    (r = \"queued\"),\n                    d()));\n          }\n        } else p();\n      // console.log(r)\n    }\n    function g() {\n      (a = !a),\n        \"playing\" == r\n          ? a\n            ? METRONOME.start(\"0:0:0\")\n            : METRONOME.stop()\n          : m(),\n        d();\n    }\n  });\nfunction getSixteenths(e) {\n  return parseFloat(e.split(\":\")[2]);\n}\nfunction getBeats(e) {\n  return parseFloat(e.split(\":\")[1]);\n}\nfunction getBars(e) {\n  return parseFloat(e.split(\":\")[0]);\n}\nfunction getTotalBeats(e) {\n  return 4 * getBars(e) + getBeats(e) + getSixteenths(e) / 4;\n}\nfunction beatsAsBarsBeatsSixteenths(e) {\n  return Tone.Time(\"0:1:0 * \" + e).toBarsBeatsSixteenths();\n}\nfunction canPlayAudio(e) {\n  return Tone.Buffer.supportsType(e);\n}\nfunction getAudioExtension() {\n  var e = \".wav\";\n  return (\n    canPlayAudio(\"ogg\") ? (e = \".ogg\") : canPlayAudio(\"mp4\") && (e = \".mp4\"), e\n  );\n}\nfunction pathToWidgetSounds() {\n  return \"./sounds/\";\n}\nfunction pctInRange(e, t, n) {\n  return (n - e) / (t - e);\n}\nfunction fitsInRange(e, t, n) {\n  return e <= n && n <= t;\n}\nfunction almostEqual(e, t, n) {\n  return null == n && (n = 0.001), Math.abs(e - t) < n;\n}\nfunction nearest(e, t) {\n  for (var n = Number.MAX_VALUE, o = 0; o < t.length; o++) {\n    var i = t[o],\n      r = Math.abs(e - n);\n    Math.abs(e - i) <= r && (n = i);\n  }\n  return n;\n}\nfunction assert(e, t) {\n  if (!e) {\n    if (((t = t || \"Assertion failed\"), \"undefined\" != typeof Error))\n      throw new Error(t);\n    throw t;\n  }\n}\nfunction storageAvailable(e) {\n  try {\n    var t = window[e],\n      n = \"__storage_test__\";\n    return t.setItem(n, n), t.removeItem(n), !0;\n  } catch (e) {\n    return !1;\n  }\n}\n\n// BEGIN ARLAN CODE\n\nconst svg_path = \"M429.742,319.31L82.49,0l-0.231,471.744l105.375-100.826l61.89,141.083l96.559-42.358l-61.89-141.083L429.742,319.31z\"\n\nfunction establishCursorListeners() {\n  const observables = document.querySelectorAll('.mouseObserver');\n  console.log('loading ecl', observables)\n\n  if (observables.length < 4) {\n    return setTimeout(establishCursorListeners, 1000)\n  }\n\n  observables.forEach(observable => {\n    let widget = null;\n    let ptr = observable;\n    while (ptr != null && Array.from(ptr.classList).indexOf('widget-pianoroll') === -1 ) {\n      ptr = ptr.parentElement;\n    }\n    if (ptr == null) return\n    widget = ptr.id;\n\n    let activeElement = null\n\n    // Use throttle so we only fire these max every 200ms (experimentally chosen)\n    observable.addEventListener('mousemove', _.throttle(e => {\n      if (window.arlan_ws) {\n        arlan_ws.send(JSON.stringify({\n          type: \"cursor\",\n          cursor: {\n            widget,\n            rel_x: e.offsetX / e.target.offsetWidth,\n            rel_y: e.offsetY / e.target.offsetHeight,\n          }\n        }));\n      }\n    }, 200));\n  })\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  establishCursorListeners()\n})\n\nwindow.arlan_cursor_pool = window.arlan_cursor_pool || []\n\nfunction connectToWebsocket() {\n  const ws_url =\n    process.env.NODE_ENV === \"development\"\n      ? \"ws://localhost:1238\"\n      : \"wss://experiments-do.ajaska.com:443/music-playground/\";\n  const ws = new WebSocket(ws_url);\n  ws.onmessage = (e) => {\n    const message = JSON.parse(e.data)\n    switch (message.type) {\n      case \"state\": {\n        const pianoRoll = window[message.model]\n        const { transport, modelSetter } = pianoRoll.getLiveAdjustThings()\n        const state = JSON.parse(message.state)\n        if (transport)\n          transport.setTempo(state.tempo)\n        if (modelSetter)\n          modelSetter.setModel(state)\n        return\n      }\n      case \"sound\": {\n        const pianoRoll = window[message.model]\n        const { player } = pianoRoll.getLiveAdjustThings()\n        player.trigger(\"playNotes\", message.sound);\n        return\n      }\n      case \"cursor\": {\n        const cursors = message.cursors;\n        let svgs = window.arlan_cursor_pool\n        if (svgs.length !== cursors.length) {\n          svgs.map(svg => svg.remove());\n          svgs = cursors.map(cursor => {\n            const bodySelection = d3.select(\"body\");\n            const svgSelection = bodySelection.append(\"svg\")\n                                            .attr(\"width\", 20)\n                                            .attr(\"height\", 20)\n                                            .attr(\"viewBox\", \"0 0 512 512\");\n            const circleSelection = svgSelection.append(\"path\")\n                                              .attr(\"fill\", cursor.color)\n                                              .attr(\"d\", svg_path);\n            const node = svgSelection.node();\n            node.style.position = 'absolute';\n            node.style.zIndex = '300';\n            return node;\n          })\n          window.arlan_cursor_pool = svgs\n        }\n\n        const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n        for (let i = 0; i < cursors.length; i++) {\n          if (cursors[i].widget == null) {\n            svgs[i].style.left = \"0px\";\n            svgs[i].style.top = \"0px\";\n          } else {\n            const elem = document.querySelector(\"#\" + cursors[i].widget + ' .mouseObserver');\n            const box = elem.getBoundingClientRect();\n            const scaledOffsetX = box.width * cursors[i].rel_x;\n            const scaledOffsetY = box.height* cursors[i].rel_y;\n            svgs[i].style.left = scrollLeft + box.x + scaledOffsetX + \"px\";\n            svgs[i].style.top = scrollTop + box.y + scaledOffsetY + \"px\";\n          }\n        }\n        return;\n      }\n      default: {\n        throw new Error(\"Unable to handle message\", message)\n      }\n    }\n  }\n\n  ws.onopen = () => {\n    const statusElement = document.getElementById(\"connection-status\");\n    statusElement.innerHTML = \"[[ CONNECTION: Online ]]\"\n    statusElement.className = \"online\"\n  }\n  ws.onclose = () => {\n    const statusElement = document.getElementById(\"connection-status\");\n    statusElement.innerHTML = \"[[ CONNECTION: Lost, reconnecting... ]]\"\n    statusElement.className = \"\"\n\n    window.setTimeout(() => connectToWebsocket(), 5000)\n  }\n\n  window.arlan_ws = ws\n}\nwindow.setTimeout(() => connectToWebsocket(), 500)\n\n// END ARLAN CODE\n\n// ARLAN NOTE: use these functions\nfunction getSavedModelString(e) {\n// console.log(\"gsms\", e)\n// console.trace()\n  return storageAvailable(\"localStorage\") ? localStorage.getItem(e) : void 0;\n}\nfunction getSavedModel(e) {\n  try {\n    return JSON.parse(getSavedModelString(e));\n  } catch (e) {\n    return;\n  }\n}\nfunction tryRestoreApp(e, t, n) {\n  var o = getSavedModel(e);\n  if (o && o.version == n) return t.ports.importModel.send(o), o;\n}\nfunction trySaveState(e, t, n) {\n  // ARLAN NOTE: reliably called on every update\n  // console.log(\"persisting state\", e /* state */, t /* name */, n /* version */) \n  if (storageAvailable(\"localStorage\"))\n    try {\n      var o = e;\n      o.version = n;\n      var i = JSON.stringify(o);\n      localStorage.setItem(t, i); // , isDeveloperMode() && console.log(i);\n\n      // BEGIN ARLAN CODE\n      if (window.arlan_ws) {\n        window.arlan_ws.send(JSON.stringify({ type: \"state\", model: t, state: i }))\n      }\n      // END ARLAN CODE\n    } catch (e) {\n      return;\n    }\n}\nvar DEVELOPER_MODE = !1;\nfunction isDeveloperMode() {\n  return window.location.href.includes(\"localhost\") || DEVELOPER_MODE;\n}\nfunction isMobile() {\n  return !!(\n    navigator.userAgent.match(/Android/i) ||\n    navigator.userAgent.match(/webOS/i) ||\n    navigator.userAgent.match(/iPhone/i) ||\n    navigator.userAgent.match(/iPad/i) ||\n    navigator.userAgent.match(/iPod/i) ||\n    navigator.userAgent.match(/BlackBerry/i) ||\n    navigator.userAgent.match(/Windows Phone/i)\n  );\n}\nfunction isChromeOnIOS() {\n  return !!navigator.userAgent.match(\"CriOS\");\n}\nfunction keyFromPhysicalCode(e) {\n  return e.includes(\"Digit\")\n    ? e.split(\"Digit\")[1]\n    : e.includes(\"Key\")\n    ? e.split(\"Key\")[1]\n    : void 0;\n}\nfunction keyEventToPhysicalKey(e) {\n  return e.code ? keyFromPhysicalCode(e.code) : String.fromCharCode(e.keyCode);\n}\nfunction clearCookies() {\n  function n(e, t) {\n    document.cookie = t\n      ? e +\n        \"=; Path=/; Domain=\" +\n        t +\n        \"; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\"\n      : e + \"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\n  }\n  try {\n    document.cookie.split(\";\").forEach(function (e) {\n      var t = e.split(\"=\")[0];\n      t && 0 === t.indexOf(\"_g\") ? n(t, document.domain) : t && n(t);\n    });\n  } catch (e) {\n    console.log();\n  }\n}\nfunction ToneTransportStartDelay() {\n  return \"+0.1\";\n}\nclearCookies();\nvar GLOBAL_PITCHPAD_SYNTH,\n  Workarounds = {\n    multiplayerStopAll: function (e, t, n) {\n      try {\n        for (;;) e.stop(t, n);\n      } catch (e) {}\n    },\n  },\n  PitchpadSynth = (window.PitchpadSynth = function () {\n    var i,\n      r,\n      a,\n      s,\n      l,\n      d,\n      e = this;\n    return (\n      (e.init = function (e) {\n        (i = []),\n          (r = 3),\n          (a = []),\n          (s = []),\n          (l = []),\n          (d = Tone.context.createGain()).connect(Tone.Master),\n          (d.gain.value = 0.5);\n        for (var t = 0; t < r; t++) {\n          i[t] = null;\n          var n = Tone.context.createOscillator(),\n            o = Tone.context.createGain();\n          (n.type = \"triangle\"),\n            n.connect(o),\n            o.connect(d),\n            (o.gain.value = 1e-6),\n            n.start(0),\n            a.push(n),\n            s.push(o),\n            l.push(-1);\n        }\n      }),\n      (e.startTouch = function (e, t) {\n        var n = i.findIndex(function (e) {\n          return null === e;\n        });\n        if (-1 == n) return;\n        (i[n] = e),\n          a[n].frequency.setValueAtTime(t, Tone.context.currentTime),\n          (l[n] = t),\n          c(n);\n      }),\n      (e.moveTouch = function (e, t, n) {\n        var o = u(e);\n        if (-1 == o) return;\n        a[o].frequency.setValueAtTime(t, Tone.context.currentTime),\n          n && !almostEqual(t, l[o]) && c(o);\n        l[o] = t;\n      }),\n      (e.stopTouch = t),\n      (e.stopAll = function () {\n        for (var e = 0; e < r; e++) t(i[e]);\n      }),\n      e\n    );\n    function u(t) {\n      return i.findIndex(function (e) {\n        return e === t;\n      });\n    }\n    function c(e) {\n      var t = Tone.context.currentTime;\n      s[e].gain.cancelScheduledValues(t),\n        s[e].gain.setTargetAtTime(1, t + 0.02, 0.001),\n        s[e].gain.setTargetAtTime(0.3, t + 0.02 + 0.1, 0.01);\n    }\n    function t(e) {\n      var t = u(e);\n      -1 != t &&\n        ((function (e) {\n          var t = Tone.context.currentTime;\n          s[e].gain.cancelScheduledValues(t),\n            s[e].gain.setTargetAtTime(0, t + 0.05, 0.1);\n        })(t),\n        (i[t] = null),\n        (l[t] = -1));\n    }\n  }),\n  ScaleExplorer = (window.ScaleExplorer = function () {\n    var i, r, a, t, n, s, l, d, u, o, c;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (i = e),\n          (mLoader = new Loader()),\n          mLoader.init(e),\n          mLoader.onAudioLoaded(),\n          (function () {\n            SUPERVISOR.makeGestureOnElementResumeAudioContext(\n              document.getElementById(i.widgetId)\n            );\n            var e = document.getElementById(i.widgetId);\n            e.style.position = \"relative\";\n            var t = document.createElement(\"div\");\n            (t.id = i.widgetId + \"appHolder\"),\n              (t.style.textAlign = \"center\"),\n              e.appendChild(t),\n              (c = Elm.ScaleExplorer.embed(t, {\n                scale: x(),\n                startNote: (function () {\n                  var e = x()[0];\n                  return e - (e % 12);\n                })(),\n                customNoteNames: I()\n                  ? null\n                  : i.frequencies.map(function (e) {\n                      return e.name;\n                    }),\n                customNoteColors: I()\n                  ? null\n                  : i.frequencies.map(function (e) {\n                      return e.color ? e.color : \"\";\n                    }),\n                showPiano: \"yes\" == i.showPiano,\n                showPads: i.isQuantized,\n                showScaleChooser: \"yes\" == i.showScaleChooser,\n                showRootChooser: \"yes\" == i.showRootChooser,\n                availableScaleNames: i.availableScales.split(\",\"),\n                defaultScaleName: i.defaultScale,\n                defaultRootName: i.defaultRoot,\n                scaleCanBeMappedToPiano: !(\"no\" == i.scaleCanBeMappedToPiano),\n                keyboardMappings: i.keyboard ? i.keyboard.split(\"\") : [],\n                showKeyboardButton: i.isQuantized && !isMobile(),\n                lang: i.lang,\n              })).ports.exportScale.subscribe(function (e) {\n                (o = e), S(), a.stopAll();\n              }),\n              c.ports.keyboardActive.subscribe(function (e) {\n                e\n                  ? KEY_SUPERVISOR.connectWidget(y, T, b)\n                  : KEY_SUPERVISOR.connectWidget(null, null, null);\n              }),\n              GLOBAL_PITCHPAD_SYNTH ||\n                (GLOBAL_PITCHPAD_SYNTH = new PitchpadSynth()).init();\n            (a = GLOBAL_PITCHPAD_SYNTH),\n              (r = d3\n                .select(\"#\" + i.widgetId)\n                .append(\"svg\")\n                .attr(\n                  \"class\",\n                  \"widget-scale-explorer__mouse-observer grabbable\"\n                )\n                .style(\"left\", \"0\")\n                .style(\"bottom\", \"0\")\n                .style(\"width\", \"100%\")).on(\"mousedown\", h),\n              r.on(\"mousemove\", function () {\n                d3.event.preventDefault();\n              }),\n              r.on(\"mouseup\", function () {\n                d3.event.preventDefault();\n              }),\n              r.on(\"touchstart\", m),\n              E(),\n              window.addEventListener(\"resize\", E),\n              (d = P().map(function (e) {\n                return !1;\n              })),\n              (u = P().map(function (e) {\n                return !1;\n              })),\n              w([]),\n              d3.timer(g),\n              i.tip &&\n                (function (e) {\n                  switch (e) {\n                    case \"lowhighpitch\":\n                      Tooltip.inject(\n                        document.getElementById(i.widgetId),\n                        (function (e) {\n                          var t = i.tips[e];\n                          return (\n                            (t.name = e), (t[\"@close\"] = i.lang[\"@close\"]), t\n                          );\n                        })(e),\n                        \"80%\"\n                      );\n                  }\n                })(i.tip);\n          })();\n      }),\n      this\n    );\n    function p(e) {\n      return i.isQuantized ? n(e) : t(e);\n    }\n    function f() {\n      return parseInt(r.style(\"width\"), 10);\n    }\n    function m() {\n      d3.event.preventDefault();\n      var o = d3.select(this).classed(\"active\", !0);\n      o.on(\"touchmove\", function () {\n        d3.event.preventDefault();\n        for (var e = 0; e < d3.event.changedTouches.length; e++) {\n          var t = d3.event.changedTouches.item(e),\n            n = d3.touch(o.node(), t.identifier)[0];\n          a.moveTouch(t.identifier, p(n), i.isQuantized);\n        }\n        w(d3.touches(r.node()));\n      })\n        .on(\"touchend\", function () {\n          d3.event.preventDefault();\n          for (var e = 0; e < d3.event.changedTouches.length; e++) {\n            var t = d3.event.changedTouches.item(e),\n              n = d3.touch(o.node(), t.identifier)[0];\n            a.stopTouch(t.identifier, p(n));\n          }\n          w(d3.touches(r.node()));\n        })\n        .on(\"touchcancel\", function () {\n          d3.event.preventDefault();\n          for (var e = 0; e < d3.event.changedTouches.length; e++) {\n            var t = d3.event.changedTouches.item(e),\n              n = d3.touch(o.node(), t.identifier)[0];\n            a.stopTouch(t.identifier, p(n));\n          }\n          w(d3.touches(r.node()));\n        });\n      for (var e = 0; e < d3.event.changedTouches.length; e++) {\n        var t = d3.event.changedTouches.item(e),\n          n = d3.touch(o.node(), t.identifier)[0];\n        a.startTouch(t.identifier, p(n));\n      }\n      w(d3.touches(r.node()));\n    }\n    function g() {\n      if (l) {\n        l = !1;\n        var e = r.selectAll(\"circle.widget-scale-explorer__touch\").data(s);\n        e.exit().remove(),\n          e\n            .enter()\n            .append(\"circle\")\n            .attr(\"class\", \"widget-scale-explorer__touch\")\n            .attr(\"r\", \"15px\")\n            .merge(e)\n            .attr(\"cx\", function (e) {\n              return e[0];\n            })\n            .attr(\"cy\", function (e) {\n              return parseInt(r.style(\"height\"), 10) / 2;\n            });\n      }\n    }\n    function h() {\n      var t = d3.select(this).classed(\"active\", !0),\n        e = d3\n          .select(window)\n          .on(\"mousemove\", function () {\n            var e = d3.mouse(t.node());\n            w([e]), a.moveTouch(\"mouse\", p(e[0]), i.isQuantized);\n          })\n          .on(\"mouseup\", function () {\n            w([]),\n              a.stopTouch(\"mouse\"),\n              e.on(\"mousemove\", null).on(\"mouseup\", null);\n          });\n      a.startTouch(\"mouse\", p(d3.mouse(this)[0])),\n        w([d3.mouse(this)]),\n        d3.event.preventDefault();\n    }\n    function v(e) {\n      var t = keyEventToPhysicalKey(e);\n      return null == t\n        ? -1\n        : i.keyboard.split(\"\").findIndex(function (e) {\n            return e.toUpperCase() == t.toUpperCase();\n          });\n    }\n    function y(e) {\n      var t = v(e);\n      if (!(t < 0)) {\n        var n = P()[t];\n        if ((a.startTouch(\"key\" + t, n), (d[t] = !0), c)) {\n          var o = x()[t];\n          c.ports.noteOn.send(o);\n        }\n      }\n    }\n    function T(e) {\n      var t = v(e);\n      if (!(t < 0) && (a.stopTouch(\"key\" + t), (d[t] = !1), c)) {\n        var n = x()[t];\n        c.ports.noteOff.send(n);\n      }\n    }\n    function w(e) {\n      if (((l = !0), (s = e), u && c)) {\n        var o = P().length,\n          i = [],\n          r = f() / o;\n        s.forEach(function (e) {\n          var t = e[0],\n            n = _.clamp(Math.floor(t / r), 0, o - 1);\n          i.push(n);\n        });\n        for (var t = 0; t < u.length; t++) {\n          var n = u[t];\n          if (\n            null !=\n            i.find(function (e) {\n              return e == t;\n            })\n          ) {\n            if (!n) {\n              u[t] = !0;\n              var a = x()[t];\n              c.ports.noteOn.send(a);\n            }\n          } else if (n) {\n            u[t] = !1;\n            a = x()[t];\n            c.ports.noteOff.send(a);\n          }\n        }\n      }\n    }\n    function E() {\n      S(), w([]);\n    }\n    function b() {\n      c.ports.resetNoteOnState.send(!0), c.ports.keyboardDisconnected.send(!0);\n      for (var e = 0; e < d.length; e++)\n        d[e] && (a.stopTouch(\"key\" + e), (d[e] = !1));\n    }\n    function S() {\n      (n = d3.scaleQuantize().domain([0, f()]).range(P())),\n        (t = d3.scaleLinear().domain([0, f()]).range(P()).clamp(!0));\n    }\n    function I() {\n      return i.defaultRoot || i.defaultScale;\n    }\n    function P() {\n      return I()\n        ? x().map(function (e) {\n            return Tone.Frequency(e, \"midi\").toFrequency();\n          })\n        : i.frequencies.map(function (e) {\n            return e.freq;\n          });\n    }\n    function x() {\n      return I()\n        ? o ||\n            [0, 2, 4, 5, 7, 9, 11, 12].map(function (e) {\n              return e + 60;\n            })\n        : \"no\" != i.scaleCanBeMappedToPiano\n        ? i.frequencies.map(function (e) {\n            return Math.round(Tone.Frequency(e.freq).toMidi());\n          })\n        : i.frequencies.map(function (e, t) {\n            return t;\n          });\n    }\n  }),\n  SimpleDrumpad = (window.SimpleDrumpad = function () {\n    var n, t, o, i, r, a, s, l;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (n = e), (t = new Loader()).init(n), v() && t.hide();\n        (s = !1), (a = new Drumkit()).init(e.kit.samples).then(y);\n      }),\n      this\n    );\n    function d(e) {\n      return e.name.replace(/\\s/g, \"\");\n    }\n    function u(e) {\n      !(function (e) {\n        o.select(\"#\" + d(e))\n          .transition()\n          .duration(50)\n          .style(\"background-color\", \"#FED134\")\n          .transition()\n          .duration(200)\n          .style(\"background-color\", \"#858585\");\n      })(e),\n        a.playNoteAtNumber(e.midi, 0, e.choke),\n        n.recorder && n.recorder.recordEvent(e);\n    }\n    function e() {\n      var e = i.selectAll(\".widget__pad\").data(n.kit.samples);\n      e.enter()\n        .append(\"div\")\n        .attr(\"class\", \"widget__pad widget__pad--drum\")\n        .attr(\"id\", function (e, t) {\n          return d(e);\n        })\n        .on(\"mousedown\", function (e, t) {\n          u(e), d3.event.preventDefault();\n        })\n        .on(\"touchstart\", function (e, t) {\n          d3.event.stopPropagation(), d3.event.preventDefault(), u(e);\n        })\n        .merge(e)\n        .html(function (e, t) {\n          return s\n            ? \"<kbd class='widget__pad__key'>\" +\n                n.keyboard.split(\"\")[t].toUpperCase() +\n                \"</kbd><div class='widget__pad__label'>\" +\n                e.name +\n                \"</div>\"\n            : \"<div class='widget__pad__label'>\" + e.name + \"</div>\";\n        });\n    }\n    function c(e) {\n      var t = (function (e) {\n        var t = keyEventToPhysicalKey(e);\n        return null == t\n          ? -1\n          : n.keyboard.split(\"\").findIndex(function (e) {\n              return e.toUpperCase() == t.toUpperCase();\n            });\n      })(e);\n      -1 != t && u(n.kit.samples[t]);\n    }\n    function p(e) {}\n    function f() {\n      (s = !1), g(), e();\n    }\n    function m() {\n      s\n        ? (KEY_SUPERVISOR.connectWidget(null, null, null), f())\n        : (KEY_SUPERVISOR.connectWidget(c, p, f), (s = !0)),\n        g(),\n        e();\n    }\n    function g() {\n      var e = s\n        ? \"widget__keyboard-button--on\"\n        : \"widget__keyboard-button--off\";\n      l.className = \"btn btn--link btn--cropped widget__keyboard-button \" + e;\n    }\n    function h() {\n      if (!isMobile()) {\n        var e = document.getElementById(n.widgetId);\n        ((r = document.createElement(\"div\")).className =\n          \"widget-drumpad__header\"),\n          (r.style.justifyContent = \"flex-end\"),\n          e.appendChild(r),\n          ((l = document.createElement(\"button\")).innerHTML =\n            n.lang[\"@keyboard\"]),\n          (l.onclick = m),\n          Tooltip.appendTooltippableChild(r, l),\n          (l.parentElement.style.width = \"80px\"),\n          l.parentElement.classList.add(\"widget__keyboard-button__wrapper\"),\n          g();\n      }\n    }\n    function v() {\n      return null != n.recorder;\n    }\n    function y() {\n      t.onAudioLoaded(),\n        SUPERVISOR.makeGestureOnElementResumeAudioContext(\n          document.getElementById(n.widgetId)\n        ),\n        (o = d3.select(\"#\" + n.widgetId)),\n        v()\n          ? ((i = o\n              .append(\"div\")\n              .attr(\"id\", \"padHolder\")\n              .attr(\"class\", \"widget__pads\")),\n            h())\n          : (h(),\n            (i = o\n              .append(\"div\")\n              .attr(\"id\", \"padHolder\")\n              .attr(\"class\", \"widget__pads\"))),\n        e(),\n        n.tip &&\n          (function (e) {\n            function t(e) {\n              var t = n.tips[e];\n              return (t.name = e), (t[\"@close\"] = n.lang[\"@close\"]), t;\n            }\n            switch (e) {\n              case \"keyboard\":\n                if (isMobile()) return;\n                Tooltip.inject(l.parentElement, t(e));\n                break;\n              case \"drumpad\":\n                (document.getElementById(n.widgetId).style.position =\n                  \"relative\"),\n                  Tooltip.inject(\n                    document.getElementById(n.widgetId),\n                    t(e),\n                    \"95%\",\n                    \"25%\",\n                    \"left\"\n                  );\n            }\n          })(n.tip);\n    }\n  }),\n  PianoRollAssessment = {\n    lanesMatch: function (e, t, n) {\n      var o = e.events.filter(function (e) {\n          return e.lane == n;\n        }),\n        i = t.events.filter(function (e) {\n          return e.lane == n;\n        });\n      return (\n        o.length == i.length &&\n        o.every(function (t) {\n          return i.find(function (e) {\n            return (\n              t.start === e.start &&\n              t.duration === e.duration &&\n              t.lane === e.lane\n            );\n          });\n        })\n      );\n    },\n    populatedLanesMatch: function (e, t, n) {\n      if (!e || !t) return !1;\n      for (var o = 0; o < n; o++) {\n        if (\n          0 <\n            e.events.filter(function (e) {\n              return e.lane == o;\n            }).length &&\n          !PianoRollAssessment.lanesMatch(e, t, o)\n        )\n          return !1;\n      }\n      return !0;\n    },\n    modelsMatch: function (e, t, n) {\n      if (!e || !t) return !1;\n      if (e.events.length != t.events.length) return !1;\n      for (var o = 0; o < n; o++)\n        if (!PianoRollAssessment.lanesMatch(e, t, o)) return !1;\n      return !0;\n    },\n  },\n  PIANOROLL_VERSION = 2,\n  PianoRollEditor = (window.PianoRollEditor = function () {\n    var o,\n      i,\n      r,\n      a,\n      s,\n      l,\n      d,\n      u = this;\n    return (\n      (u.init = function (e) {\n        (i = e),\n          (function () {\n            for (var e = i.lanes, t = 0; t < e.length; t++)\n              void 0 === e[t].color && (e[t].color = \"none\"),\n                void 0 === e[t].freq && (e[t].freq = null),\n                void 0 === e[t].midi && (e[t].midi = null),\n                void 0 === e[t].choke && (e[t].choke = null);\n            ((l = document.createElement(\"div\")).style.width = m() + \"px\"),\n              (l.style.position = \"relative\"),\n              (l.style.overflow = \"hidden\"),\n              (l.style.backgroundColor = \"#666\"),\n              Tooltip.appendTooltippableChild(\n                document.getElementById(i.widgetId),\n                l\n              );\n            var n = document.createElement(\"div\");\n            l.appendChild(n),\n              (o = Elm.SimplePianoRoll.embed(n, {\n                lanes: e,\n                beats: i.beats,\n                gridSize: i.gridSize / 4,\n                width: m(),\n                height: f(),\n                labelWidth: T(),\n                scaleName: i.defaultScale ? i.defaultScale : null,\n                rootName: i.defaultRoot ? i.defaultRoot : null,\n                octave: i.defaultOctave ? parseInt(i.defaultOctave) : null,\n                octaveCount: i.defaultOctaveCount\n                  ? parseInt(i.defaultOctaveCount)\n                  : null,\n                showRootChooser: \"yes\" == i.showRootChooser,\n                showScaleChooser: \"yes\" == i.showScaleChooser,\n                availableScales: i.availableScales\n                  ? i.availableScales.split(\",\")\n                  : [],\n                showTempoSlider: \"no\" != i.showTempoSlider,\n                showSettings: !0,\n                tempo: parseFloat(i.tempo),\n                highlightedLanes: i.highlightedLanes ? i.highlightedLanes : [],\n                options: {\n                  allowResize: null == i.allowResize || i.allowResize,\n                },\n              })),\n              o.ports.exportModel.subscribe(function (e) {\n                var t = !r || e.page != r.page,\n                  n = !r || e.lanes.length != r.lanes.length;\n                (r = e),\n                  u.trigger(\"modelChange\", e),\n                  t && u.trigger(\"pageChange\"),\n                  n && c();\n              }),\n              o.ports.previewNotes.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesSelected.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesDragged.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !0);\n              }),\n              o.ports.notesAdded.subscribe(function (e) {\n                u.trigger(\"previewNotes\", e, !1);\n              }),\n              o.ports.tempoChanged.subscribe(function (e) {\n                u.trigger(\"tempoChanged\", e);\n              }),\n              ((d = document.createElement(\"div\")).className =\n                \"widget-pianoroll__mouse-observer-holder\"),\n              (d.style.left = T() + \"px\"),\n              (d.style.width = g() + \"px\"),\n              (d.style.height = h() + \"px\"),\n              l.appendChild(d),\n              new SingleTouchObserver().init({\n                node: d,\n                onDown: function (e, t) {\n                  o.ports.mouseDown.send([e, t]);\n                },\n                onMove: function (e, t) {\n                  o.ports.mouseMove.send([e, t]);\n                },\n                onUp: function (e, t) {\n                  o.ports.mouseUp.send([e, t]);\n                },\n              }),\n              ((a = document.createElement(\"div\")).className =\n                \"widget-pianoroll__playhead\"),\n              (a.style.bottom = \"0px\"),\n              (a.style.height = h() - 2 + \"px\"),\n              l.appendChild(a),\n              ((s = document.createElement(\"div\")).className =\n                \"widget-pianoroll__playhead\"),\n              (s.style.bottom = p() + \"px\"),\n              (s.style.height = y() - 1 + \"px\"),\n              l.appendChild(s),\n              c(),\n              window.addEventListener(\"resize\", c);\n          })();\n      }),\n      (u.clear = function () {\n        o.ports.clear.send(\"\");\n      }),\n      (u.setModel = function (e) {\n        if (!e || e.version != PIANOROLL_VERSION) return;\n        (e.lanes = i.lanes),\n          (e.showSettings = !0),\n          (null != e.scaleName && \"yes\" == i.showScaleChooser) ||\n            (e.scaleName = i.defaultScale ? i.defaultScale : null);\n        (null != e.rootName && \"yes\" == i.showRootChooser) ||\n          (e.rootName = i.defaultRoot ? i.defaultRoot : null);\n        (e.octave = i.defaultOctave ? parseInt(i.defaultOctave) : null),\n          (e.octaveCount = i.defaultOctaveCount\n            ? parseInt(i.defaultOctaveCount)\n            : null),\n          null == e.tempo\n            ? (e.tempo = parseFloat(i.tempo))\n            : (e.tempo = parseFloat(e.tempo));\n        o.ports.importModel.send(e);\n      }),\n      (u.getModel = function (e) {\n        return r;\n      }),\n      (u.record = function (e) {\n        o.ports.record.send([e.lane, e.start]);\n      }),\n      (u.setPlayhead = function (e) {\n        if (0 < e) {\n          (s.style.transform = \"translateX(\" + (e * g() + T()) + \"px)\"),\n            (s.style.opacity = 1);\n          var t = (function () {\n              var e = r ? r.page : -1,\n                t = -1 == e || 0 == e ? 0 : 4 * e - 0.25,\n                n =\n                  -1 == e || e == i.beats / 4 - 1\n                    ? i.beats\n                    : 4 * (e + 1) + 0.25;\n              return [t / i.beats, n / i.beats];\n            })(),\n            n = pctInRange(t[0], t[1], e);\n          fitsInRange(0, 1, n)\n            ? ((a.style.transform = \"translateX(\" + (n * g() + T()) + \"px)\"),\n              (a.style.opacity = 1))\n            : (a.style.opacity = 0);\n        } else (a.style.opacity = 0), (s.style.opacity = 0);\n      }),\n      (u.setOptions = function (e) {\n        o.ports.setOptions.send(e);\n      }),\n      (u.updateTempo = function (e) {\n        o.ports.setTempo.send(parseFloat(e));\n      }),\n      (u.getEditorTooltipWrapper = function () {\n        return l.parentElement;\n      }),\n      u\n    );\n    function c() {\n      (l.style.width = m() + \"px\"),\n        (a.style.height = h() - 1 + \"px\"),\n        (d.style.width = g() + \"px\"),\n        (d.style.height = h() + \"px\"),\n        (s.style.bottom = p() + \"px\"),\n        o.ports.setSize.send([m(), f()]);\n    }\n    function p() {\n      return h() + 1;\n    }\n    function f() {\n      return h() + y();\n    }\n    function m() {\n      var e = document.getElementById(i.widgetId);\n      return parseInt(e.offsetWidth, 10);\n    }\n    function g() {\n      return m() - T();\n    }\n    function h() {\n      return (\n        (function () {\n          var e = isMobile() ? 36 : 60,\n            t = (25 - e) / 12,\n            n = e - 4 * t,\n            o = Math.round(t * v() + n);\n          return _.clamp(o, 25, e);\n        })() * v()\n      );\n    }\n    function v() {\n      return r ? r.lanes.length : i.lanes.length;\n    }\n    function y() {\n      return 4 < i.beats ? 50 : 0;\n    }\n    function T() {\n      return i ? (\"drums\" != i.material || isMobile() ? 62 : 124) : 62;\n    }\n  });\nMicroEvent.mixin(PianoRollEditor);\nvar PianoRollExport = {\n    createExportData: function (t, e, n) {\n      var o = t.events.map(function (e) {\n        return {\n          midi: PianoRollExport.laneToMidi(t, e.lane),\n          startInBeats: e.start,\n          durationInBeats: e.duration,\n        };\n      });\n      return {\n        tempo: e,\n        tracks: [{ instrument: n, clip: { lengthInBeats: t.beats, notes: o } }],\n      };\n    },\n    laneToMidi: function (e, t) {\n      var n = e.lanes.length,\n        o = e.lanes[n - 1 - t];\n      return o.freq ? Math.round(Tone.Frequency(o.freq).toMidi()) : o.midi;\n    },\n  },\n  PianoRollPlayer = (window.PianoRollPlayer = function (widget /* ARLAN CODE */) {\n    var o,\n      l,\n      d,\n      t,\n      u = this;\n    return (\n      (u.setModel = function (e) {\n        l = e;\n      }),\n      (u.setLoop = function (e) {\n        (t = e), o && (i(), (Tone.Transport.position = \"0:0:0\"), n());\n      }),\n      (u.start = n),\n      (u.stop = i),\n      (u.record = function (e) {\n        d = d || [];\n        d.push(e);\n      }),\n      (u.progress = function () {\n        if (!l || !o) return 0;\n        var e = getTotalBeats(Tone.Time(o.loopStart).toBarsBeatsSixteenths()),\n          t = getTotalBeats(Tone.Time(o.loopEnd).toBarsBeatsSixteenths()),\n          n = o.progress * (t - e);\n        return (e + n) / l.beats;\n      }),\n      (u.previewNotes = function (e) {\n        // console.log(\"previewNotes\", e)\n        var t = e.map(function (e) {\n            return e.lane;\n          }),\n          n = _.uniq(t).map(function (e) {\n            var t = l.lanes.length - 1 - e;\n            return { lane: l.lanes[t], length: \"16n\", time: \"+0.1\" };\n          });\n        // BEGIN ARLAN CODE\n        // console.log(u, o, l, d, t, widget.getConfig().widgetId)\n        if (n.length > 0 && window.arlan_ws) {\n          window.arlan_ws.send(JSON.stringify({\n            type: \"sound\",\n            model: widget.getConfig().widgetId,\n            sound: n,\n          }))\n        }\n        // END ARLAN CODE\n        u.trigger(\"playNotes\", n);\n      }),\n      u\n    );\n    function n(e) {\n      // console.log(\"n\", e)\n      l &&\n        ((function () {\n          var r = 1 / l.gridSize,\n            a = 4 * l.gridSize + \"n\",\n            e = l.gridSize * l.beats,\n            s = l.lanes.length;\n          o && o.dispose();\n          o = new Tone.Sequence(\n            function (i, e) {\n              if (l) {\n                var t = e * r;\n                d &&\n                  (function (t) {\n                    (d = d.filter(function (e) {\n                      return (e.start + e.duration) % l.beats > t;\n                    })),\n                      0 === t &&\n                        (d = d.filter(function (e) {\n                          return e.start + e.duration > l.beats;\n                        }));\n                  })(t);\n                var n = (function (t) {\n                  return l.events.filter(function (e) {\n                    return e.start == t;\n                  });\n                })(t)\n                  .filter(function (t) {\n                    return !(\n                      d &&\n                      -1 !=\n                        d.findIndex(function (e) {\n                          return e.lane == t.lane;\n                        })\n                    );\n                  })\n                  .map(function (e) {\n                    var t = e.duration / r,\n                      n = s - e.lane - 1,\n                      o = a + \" * \" + t;\n                    return { lane: l.lanes[n], length: o, time: i };\n                  });\n                u.trigger(\"playNotes\", n);\n              }\n            },\n            _.range(0, e),\n            a\n          );\n        })(),\n        t\n          ? ((o.loopStart = beatsAsBarsBeatsSixteenths(t.start)),\n            (o.loopEnd = beatsAsBarsBeatsSixteenths(t.end)),\n            (o.loop = !0),\n            o.start(e, o.loopStart))\n          : o.start(e));\n    }\n    function i(e) {\n      o && o.stop(e);\n    }\n  });\nMicroEvent.mixin(PianoRollPlayer);\nvar SimplePianoRoll = (window.SimplePianoRoll = function () {\n  var t,\n    i,\n    r,\n    n,\n    o,\n    a,\n    s,\n    l,\n    d,\n    u,\n    c = this;\n  return (\n    (c.init = function (e) {\n      if (!BrowserCompatibility.isBrowserCompatible())\n        return void BrowserCompatibility.appendCompatibilityWarning(\n          document.getElementById(e.widgetId),\n          e.lang[\"@incompatiblebrowser\"]\n        );\n      isMobile() &&\n        document.getElementById(e.widgetId).classList.add(\"widget-is-mobile\");\n      (i = e), (t = new Loader()).init(i), i.recorder && i.recorder.connect(b);\n      i.exporter && \"yes\" != i.disableExport && i.exporter.registerWidget(c);\n      (s = new PianoRollPlayer(c /* ARLAN CODE */)),\n        \"tonal\" == i.material\n          ? (d = new Piano()).init(i.instrument).then(p)\n          : \"drums\" == i.material &&\n            (d = new Drumkit()).init(i.instrument.samples).then(p),\n        T(),\n        (u = _.debounce(g, 500));\n    }),\n    (c.showTargetState = function () {\n      r.setTempo(w()), l.setModel(JSON.parse(i.targetState));\n    }),\n    (c.getExportInfo = function () {\n      return PianoRollExport.createExportData(\n        l.getModel(),\n        r.getTempo(),\n        i.instrument.livePreset\n      );\n    }),\n    (c.getConfig = function () {\n      return i;\n    }),\n    // BEGIN ARLAN CODE\n    (c.getLiveAdjustThings = function () {\n      return {transport: r, modelSetter: l, player: s};\n    }),\n    // END ARLAN CODE\n    c\n  );\n  function p() {\n    t.onAudioLoaded(),\n      SUPERVISOR.makeGestureOnElementResumeAudioContext(\n        document.getElementById(i.widgetId)\n      ),\n      (function () {\n        var e = document.createElement(\"div\");\n        (e.className = \"widget__menu\"),\n          document.getElementById(i.widgetId).appendChild(e),\n          (r = new Transport()).init({\n            node: e,\n            onStartPlayback: function () {\n              // console.log(\"onStartPlayback\")\n              s.start();\n            },\n            onStartQuantizedPlayback: function () {\n              // console.log(\"onStartQuantizedPlayback\")\n              s.start(\"@1m\");\n            },\n            onStopPlayback: function () {\n              // console.log(\"onStopPlayback\")\n              s.stop(), d.stopAll();\n            },\n            onPlay: i.onPlay, // \"join\"\n            tempo: w(),\n            onTempoChanged: function (e) {\n              l.updateTempo(e), y(), u();\n            },\n            showRecordButton: i.recorder,\n            widgetId: i.widgetId,\n          }),\n          (i.defaultState || i.tempo) &&\n            (((n = document.createElement(\"button\")).innerHTML =\n              i.lang[\"@reset\"]),\n            (n.className = \"widget-button widget-button--hidden\"),\n            (n.onclick = v),\n            e.appendChild(n));\n        ((o = document.createElement(\"button\")).innerHTML = i.lang[\"@clear\"]),\n          (o.className = \"widget-button\"),\n          (o.style.marginLeft = \"auto\"),\n          (o.onclick = function () {\n            l.clear();\n          }),\n          e.appendChild(o),\n          ((a = document.createElement(\"button\")).innerHTML =\n            i.lang[\"@exporttolive\"]),\n          (a.className = \"btn btn--link btn--cropped\"),\n          (a.onclick = function () {\n            if (!m())\n              return (\n                (a.style.pointerEvents = \"none\"),\n                (a.style.opacity = 0.25),\n                void f(\"exportnotsupportedchromeios\")\n              );\n            (a.style.pointerEvents = \"none\"),\n              (a.innerHTML = i.lang[\"@exporting\"] + \"...\"),\n              c.trigger(\"export\", c, function (e) {\n                (a.style.pointerEvents = \"initial\"),\n                  (a.innerHTML = i.lang[\"@exporttolive\"]),\n                  e && console.log(e);\n              });\n          }),\n          \"yes\" != i.disableExport &&\n            (Tooltip.appendTooltippableChild(e, a),\n            LiveSetExport.checkExportServiceAvailablility(function (e) {\n              (a.style.opacity = e ? 1 : 0.25),\n                (a.style.pointerEvents = e ? \"auto\" : \"none\");\n            }));\n      })(),\n      (l = new PianoRollEditor()).init(i),\n      l.bind(\"modelChange\", function (e) {\n        // console.log(\"modelChange\", e)\n        s.setModel(e),\n          T(),\n          y(),\n          (function () {\n            if (o) {\n              var e = (function () {\n                var e = l ? l.getModel() : void 0;\n                return !!e && 0 < e.events.length;\n              })()\n                ? \"\"\n                : \"widget-button--hidden\";\n              o.className = \"btn btn--link btn--cropped \" + e;\n            }\n          })(),\n          u();\n      }),\n      l.bind(\"pageChange\", function () {\n        !(function () {\n          if (\"takeover\" != i.onPlay) return;\n          d.stopAll();\n          var e = l ? l.getModel() : void 0;\n          e && -1 != e.page\n            ? s.setLoop({ start: 4 * e.page, end: 4 * e.page + 4 })\n            : s.setLoop({ start: 0, end: i.beats });\n        })();\n      }),\n      l.bind(\"previewNotes\", function (e, t) {\n        // console.log(\"previewNotes\", e, t);\n        (!t && r.isPlaying()) || s.previewNotes(e);\n      }),\n      l.bind(\"tempoChanged\", function (e) {\n        r.setTempo(e), y(), u();\n      }),\n      s.bind(\"playNotes\", function (e) {\n        // console.log(\"playNotes\", e)\n        \"tonal\" == i.material\n          ? e.forEach(function (e) {\n              d.playNoteAtFrequency(e.lane.freq, e.time, e.length);\n            })\n          : \"drums\" == i.material && d.playNotes(e);\n      }),\n      4 === i.beats &&\n        \"drums\" === i.material &&\n        null == i.recorder &&\n        (function () {\n          var e = document.createElement(\"div\");\n          e.className = \"widget-drumsequencer__column-labels\";\n          for (var t = 0; t < 16; t++) {\n            var n = document.createElement(\"div\");\n            (n.className = \"widget-drumsequencer__column-label\"),\n              t % 4 == 0 &&\n                n.classList.add(\"widget-drumsequencer__column-label--beat\"),\n              (n.innerHTML = t + 1),\n              e.appendChild(n);\n          }\n          document.getElementById(i.widgetId).appendChild(e);\n        })(),\n      i.defaultState && v();\n    var e = getSavedModel(i.widgetId);\n    e && (e.tempo && r.setTempo(e.tempo), l.setModel(e)),\n      i.tip && f(i.tip),\n      d3.timer(h);\n  }\n  function f(e) {\n    function t(e) {\n      var t = i.tips[e];\n      return (t.name = e), (t[\"@close\"] = i.lang[\"@close\"]), t;\n    }\n    switch (e) {\n      case \"playstop\":\n        Tooltip.inject(\n          r.playButton().parentElement,\n          t(e),\n          \"100%\",\n          \"50%\",\n          \"left\"\n        );\n        break;\n      case \"record\":\n        Tooltip.inject(r.recordButton().parentElement, t(e));\n        break;\n      case \"createdeletenotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"70%\", \"60%\");\n        break;\n      case \"dragnotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"50%\", \"55%\");\n        break;\n      case \"resizenotes\":\n      case \"selectnotes\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"50%\", \"65%\");\n        break;\n      case \"tempo\":\n        Tooltip.inject(l.getEditorTooltipWrapper(), t(e), \"15%\", \"50%\");\n        break;\n      case \"overview\":\n        Tooltip.inject(\n          l.getEditorTooltipWrapper(),\n          t(e),\n          \"30%\",\n          \"80%\",\n          \"right\"\n        );\n        break;\n      case \"export\":\n        m() && Tooltip.inject(a.parentElement, t(e), \"100%\", \"50%\", \"right\");\n        break;\n      case \"exportnotsupportedchromeios\":\n        Tooltip.inject(a.parentElement, t(e), \"100%\", \"50%\", \"right\");\n    }\n  }\n  function m() {\n    return !isChromeOnIOS();\n  }\n  function g() {\n    var e = l.getModel();\n    e &&\n      ((e.tempo = r.getTempo()),\n      trySaveState(e, i.widgetId, PIANOROLL_VERSION));\n  }\n  function h() {\n    var e = r.isPlaying() ? s.progress() : 0;\n    l.setPlayhead(e);\n  }\n  function v() {\n    if ((r.setTempo(w()), i.defaultState))\n      l.setModel(JSON.parse(i.defaultState));\n    else if (i.defaultRoot || i.defaultScale) {\n      var e = l.getModel();\n      (e.scaleName = i.defaultScale),\n        (e.rootName = i.defaultRoot),\n        (e.tempo = w()),\n        l.setModel(e);\n    }\n  }\n  function y() {\n    if (n) {\n      var e = (function () {\n        var e = l ? l.getModel() : void 0;\n        return i.defaultState\n          ? w() === r.getTempo() &&\n              E(e) &&\n              PianoRollAssessment.modelsMatch(\n                JSON.parse(i.defaultState),\n                l.getModel(),\n                i.lanes.length\n              )\n          : w() === r.getTempo() && E(e);\n      })()\n        ? \"widget-button--hidden\"\n        : \"\";\n      n.className = \"btn btn--link btn--cropped \" + e;\n    }\n  }\n  function T() {\n    var e = document.getElementById(i.widgetId + \"correct\"),\n      t = document.getElementById(i.widgetId + \"generic\");\n    if (e && t) {\n      var n = (function () {\n        var e = l ? l.getModel() : void 0;\n        if (!i.targetState || !e) return !1;\n        {\n          if (\"tonal\" == i.material)\n            return PianoRollAssessment.modelsMatch(\n              JSON.parse(i.targetState),\n              l.getModel(),\n              e.lanes.length\n            );\n          if (\"drums\" == i.material)\n            return PianoRollAssessment.populatedLanesMatch(\n              JSON.parse(i.targetState),\n              l.getModel(),\n              e.lanes.length\n            );\n        }\n      })();\n      (e.className = n\n        ? \"widget__dynamic-text\"\n        : \"widget__dynamic-text widget__dynamic-text--hidden\"),\n        (t.className = n\n          ? \"widget__dynamic-text widget__dynamic-text--hidden\"\n          : \"widget__dynamic-text\");\n    }\n  }\n  function w() {\n    return i.tempo ? parseInt(i.tempo) : 85;\n  }\n  function E(e) {\n    if (!e) return !0;\n    var t = !i.defaultRoot || i.defaultRoot === e.rootName,\n      n = !i.defaultScale || i.defaultScale === e.scaleName;\n    return t && n;\n  }\n  function b(e) {\n    var t = i.lanes.map(function (e) {\n        return e.midi;\n      }),\n      n = i.lanes.length - t.indexOf(e.midi) - 1,\n      o = s.progress() * i.beats;\n    r.isRecording() &&\n      r.isPlaying() &&\n      (l.record({ lane: n, start: o, duration: 0.25 }),\n      s.record({ lane: n, start: o, duration: 0.25 }));\n  }\n});\nMicroEvent.mixin(SimplePianoRoll);\nvar SimpleSession = (window.SimpleSession = function () {\n    var o, n, i, r, a, s, l, d;\n    return (\n      (this.init = function (e) {\n        if (!BrowserCompatibility.isBrowserCompatible())\n          return void BrowserCompatibility.appendCompatibilityWarning(\n            document.getElementById(e.widgetId),\n            e.lang[\"@incompatiblebrowser\"]\n          );\n        (o = e),\n          (r = document.getElementById(o.widgetId)),\n          (i = new Loader()).init(o),\n          (Tone.Transport.bpm.value = o.preset.tempo),\n          (l = \"stopped\"),\n          (s = new Tone.MultiPlayer(\n            (function (e) {\n              var o = {},\n                i = getAudioExtension();\n              return (\n                e.tracks.forEach(function (e, t) {\n                  e.clips.forEach(function (e, t) {\n                    var n = e.name;\n                    o[n] = pathToWidgetSounds() + e.path + i;\n                  });\n                }),\n                o\n              );\n            })(o.preset),\n            function () {\n              !(function () {\n                i.onAudioLoaded(),\n                  SUPERVISOR.makeGestureOnElementResumeAudioContext(r),\n                  (a = document.createElement(\"div\")),\n                  Tooltip.appendTooltippableChild(r, a);\n                for (var e = 0; e < o.preset.tracks.length; e++) {\n                  var t = o.preset.tracks[e];\n                  t.name = t[\"@name\"];\n                }\n                (n = Elm.SimpleSession.embed(a, o.preset)),\n                  Tone.Transport.scheduleRepeat(function (e) {\n                    n.ports.onTick.send(\"\" + e);\n                  }, \"1m\"),\n                  n.ports.playSound.subscribe(function (e) {\n                    var t = e[0],\n                      n = e[1];\n                    \"stopped\" == Tone.Transport.state &&\n                      ((Tone.Transport.position = \"0:0:0\"),\n                      Tone.Transport.start(ToneTransportStartDelay())),\n                      \"stopped\" == l && (l = \"playing\"),\n                      (function (e, t) {\n                        o.preset.tracks[t].clips.forEach(function (t) {\n                          t.name != e.name &&\n                            (Tone.Transport.clear(d[t.name]),\n                            Tone.Transport.scheduleOnce(function (e) {\n                              try {\n                                s.stop(t.name, e);\n                              } catch (e) {}\n                            }, \"@1m\"));\n                        });\n                      })(t, n),\n                      (d[t.name] = Tone.Transport.scheduleRepeat(\n                        function (e) {\n                          try {\n                            s.stop(t.name, e);\n                          } catch (e) {}\n                          s.start(t.name, e, 0, t.length),\n                            SUPERVISOR.registerPlayingWidget(o.widgetId);\n                        },\n                        t.length,\n                        \"@1m\"\n                      ));\n                  }),\n                  n.ports.unqueueSound.subscribe(function (e) {\n                    Tone.Transport.clear(d[e.name]);\n                  }),\n                  n.ports.stopSound.subscribe(function (t) {\n                    Tone.Transport.clear(d[t.name]),\n                      Tone.Transport.scheduleOnce(function (e) {\n                        try {\n                          s.stop(t.name, e);\n                        } catch (e) {}\n                      }, \"@1m\");\n                  }),\n                  n.ports.allSoundsStopped.subscribe(function (e) {\n                    SUPERVISOR.isOnlyWidgetPlaying(o.widgetId) &&\n                      ((Tone.Transport.position = \"0:0:0\"),\n                      Tone.Transport.stop()),\n                      (l = \"stopped\"),\n                      SUPERVISOR.unregisterPlayingWidget(o.widgetId);\n                  }),\n                  o.tip &&\n                    (function (e) {\n                      switch (e) {\n                        case \"devicemute\":\n                          if (!isMobile()) return;\n                          Tooltip.inject(\n                            a,\n                            (function (e) {\n                              var t = o.tips[e];\n                              return (\n                                (t.name = e),\n                                (t[\"@close\"] = o.lang[\"@close\"]),\n                                t\n                              );\n                            })(e),\n                            \"65%\",\n                            \"60%\",\n                            \"right\"\n                          );\n                      }\n                    })(o.tip);\n              })();\n            }\n          ).toMaster()),\n          (d = {});\n      }),\n      this\n    );\n  }),\n  SongFormExplorer = (window.SongFormExplorer = function () {\n    var i, r, a;\n    return (\n      (this.init = function (e) {\n        (a = e),\n          (r = document.getElementById(a.widgetId)),\n          (function () {\n            var e = document.createElement(\"div\");\n            r.appendChild(e);\n            for (var t = 0; t < a.preset.sections.length - 1; t++) {\n              var n = a.preset.sections[t],\n                o = a.preset.sections[t + 1];\n              n.end = o.start;\n            }\n            a.preset.sections[a.preset.sections.length - 1].end =\n              a.preset.songLength;\n            for (t = 0; t < a.preset.sections.length; t++) {\n              ((n = a.preset.sections[t]).description = n[\"@description\"]),\n                (n.name = n[\"@name\"]),\n                (n.label = n[\"@label\"]);\n            }\n            for (t = 0; t < a.preset.sections.length; t++) {\n              (n = a.preset.sections[t])[\"@label\"] || (n.label = n.name);\n            }\n            (i = Elm.SongFormExplorer.embed(e, a.preset)),\n              i.ports.jumpToSection.subscribe(function (e) {\n                a.player.setPlayheadToTime(e.start);\n              }),\n              a.player.setPlayheadChangedCallback(s),\n              a.tip &&\n                (function (e) {\n                  switch (e) {\n                    case \"songformsections\":\n                      (r.style.position = \"relative\"),\n                        Tooltip.inject(\n                          r,\n                          (function (e) {\n                            var t = a.tips[e];\n                            return (\n                              (t.name = e), (t[\"@close\"] = a.lang[\"@close\"]), t\n                            );\n                          })(e),\n                          \"45px\",\n                          \"65%\"\n                        );\n                  }\n                })(a.tip);\n          })();\n      }),\n      this\n    );\n    function s(e) {\n      i.ports.updatePlayhead.send(e);\n    }\n  });\nfunction onYouTubeIframeAPIReady() {\n  YOUTUBEWIDGETS.forEach(function (e) {\n    e.onYouTubeIframeAPIReady();\n  }),\n    (YOUTUBE_API_READY = !0);\n}\n(YOUTUBEWIDGETS = []), (YOUTUBE_API_READY = !1);\nvar YouTube = (window.YouTube = function () {\n  var n,\n    t,\n    o,\n    i,\n    r,\n    a,\n    s,\n    l,\n    d = this;\n  return (\n    (d.init = function (e) {\n      (n = e),\n        (o = document.getElementById(n.widgetId)),\n        ((i = document.createElement(\"div\")).className =\n          \"widget-video__holder\"),\n        (i.id = n.widgetId + \"video\"),\n        (i.style.display = \"none\"),\n        o.appendChild(i),\n        n.width && (i.style.width = n.width + \"px\");\n      (l = !1),\n        (t = new Loader()).init(n),\n        YOUTUBE_API_READY ? f() : YOUTUBEWIDGETS.push(d);\n    }),\n    (d.onYouTubeIframeAPIReady = function () {\n      f();\n    }),\n    (d.setPlayheadChangedCallback = function (e) {\n      s = e;\n    }),\n    (d.setPlayheadToTime = function (e) {\n      if (void 0 === r || void 0 === r.getPlayerState) return;\n      r.getPlayerState() != YT.PlayerState.PLAYING && s && s(e);\n      r.seekTo(e), l && r.playVideo();\n      Tone.Transport.emit(\"takeover\", n.widgetId);\n    }),\n    d\n  );\n  function e(e) {\n    t.hide(),\n      (document.getElementById(n.widgetId + \"video\").style.display = \"block\"),\n      Tone.Transport.on(\"takeover\", u),\n      document.getElementById(n.widgetId).classList.add(\"is-ready\");\n  }\n  function u(e) {\n    \"takeover\" == n.onPlay &&\n      e != n.widgetId &&\n      r.getPlayerState() === YT.PlayerState.PLAYING &&\n      (r.pauseVideo(), (l = !0));\n  }\n  function c() {\n    r &&\n      r.getPlayerState() == YT.PlayerState.PLAYING &&\n      s &&\n      s(r.getCurrentTime());\n  }\n  function p(e) {\n    if (\n      e.data == YT.PlayerState.PLAYING ||\n      e.data == YT.PlayerState.BUFFERING\n    ) {\n      var t = document.getElementById(n.widgetId);\n      t.classList.remove(\"is-ready\"), t.classList.add(\"is-playing\");\n    }\n    e.data == YT.PlayerState.PLAYING\n      ? (\"takeover\" == n.onPlay && Tone.Transport.emit(\"takeover\", n.widgetId),\n        a ? a.restart(c) : (a = d3.timer(c)),\n        SUPERVISOR.registerPlayingWidget(n.widgetId),\n        (l = !1))\n      : (SUPERVISOR.unregisterPlayingWidget(n.widgetId), a && a.stop(c));\n  }\n  function f() {\n    r = new YT.Player(n.widgetId + \"video\", {\n      videoId: n.videoId,\n      playerVars: {\n        controls: 2,\n        disablekb: 1,\n        showinfo: 0,\n        color: \"white\",\n        modestbranding: 1,\n        fs: 0,\n        playsinline: 1,\n        start: n.start ? parseInt(n.start) : 0,\n        end: n.end ? parseInt(n.end) : void 0,\n        loop: n.loop && \"yes\" === n.loop ? 1 : 0,\n        host: \"https://www.youtube-nocookie.com\",\n      },\n      events: { onReady: e, onStateChange: p },\n    });\n  }\n});\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n"],"names":["require","window","AudioSupervisor","n","e","this","init","document","addEventListener","t","Tone","Transport","latencyHint","isMobile","makeGestureOnElementResumeAudioContext","context","resume","then","removeEventListener","registerPlayingWidget","indexOf","push","unregisterPlayingWidget","filter","isOnlyWidgetPlaying","length","areAnyWidgetsPlaying","masterEffectChain","Master","hidden","volume","rampTo","BrowserCompatibility","hasOwnProperty","createElement","className","innerHTML","appendChild","Drumkit","i","r","o","Promise","map","path","name","midi","SAMPLE_CACHE","getBuffers","MultiPlayer","toMaster","fadeOut","Buffer","on","a","playNoteAtNumber","playNotes","forEach","some","lane","choke","time","stopAll","buffers","loaded","start","Workarounds","multiplayerStopAll","LiveSetExport","KeySupervisor","keyCode","connectWidget","serviceURL","checkExportServiceAvailablility","XMLHttpRequest","timeout","open","send","createLiveSet","Date","toDateString","replace","backlink","location","href","tempo","tracks","userHasAlreadyExportedOnce","LOCALE_PATH","responseText","isValidFileId","downloadURLFromFileId","storageAvailable","localStorage","setItem","setRequestHeader","JSON","stringify","getItem","match","createDownloadLink","RegExp","exec","s","createTextNode","title","getElementById","style","display","Loader","LiveSetExporter","registerWidget","bind","getExportInfo","getConfig","onPlay","reduce","concat","id","widgetId","hide","onAudioLoaded","Piano","Metronome","metro","getAudioExtension","metroup","value","stop","dispose","Sequence","d","u","c","l","samples","connect","SUPERVISOR","fadeout","duration","val","nearest","offset","p","playNoteAtFrequency","Math","round","Frequency","toMidi","SingleTouchObserver","Recorder","recordEvent","SampleCache","Buffers","getBuffer","has","get","add","extension","d3","select","node","append","attr","event","type","button","classed","mouse","onDown","activeElement","blur","preventDefault","onMove","onUp","Tooltip","inject","userHasSeenTooltip","showalways","getBoundingClientRect","xShiftFactor","xShiftInPx","width","top","left","marginTop","marginLeft","border","borderColor","classList","setUserHasSeenTooltip","tooltipKeyForLocalStorage","appendTooltippableChild","position","onclick","m","parentElement","g","isRecording","isPlaying","getTempo","setTempo","bpm","emit","onTempoChanged","playButton","recordButton","playing","queued","stopped","showRecordButton","METRONOME","onStopPlayback","onStartPlayback","f","scheduleOnce","onStartQuantizedPlayback","getTotalBeats","parseFloat","split","getBars","getBeats","getSixteenths","beatsAsBarsBeatsSixteenths","Time","toBarsBeatsSixteenths","canPlayAudio","supportsType","Number","MAX_VALUE","abs","removeItem","establishCursorListeners","observables","querySelectorAll","console","log","setTimeout","observable","widget","ptr","Array","from","_","throttle","arlan_ws","cursor","rel_x","offsetX","target","offsetWidth","rel_y","offsetY","offsetHeight","getSavedModel","parse","getSavedModelString","arlan_cursor_pool","connectToWebsocket","ws","WebSocket","onmessage","message","data","pianoRoll","model","transport","modelSetter","getLiveAdjustThings","state","setModel","player","trigger","sound","cursors","svgs","svg","remove","svgSelection","color","zIndex","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","box","querySelector","scaledOffsetX","scaledOffsetY","height","x","y","Error","onopen","statusElement","onclose","navigator","userAgent","keyEventToPhysicalKey","code","includes","keyFromPhysicalCode","String","fromCharCode","cookie","domain","clearCookies","GLOBAL_PITCHPAD_SYNTH","PitchpadSynth","createGain","gain","createOscillator","startTouch","findIndex","frequency","setValueAtTime","currentTime","moveTouch","almostEqual","stopTouch","cancelScheduledValues","setTargetAtTime","PianoRollAssessment","ScaleExplorer","mLoader","textAlign","Elm","embed","scale","startNote","customNoteNames","I","frequencies","customNoteColors","showPiano","showPads","isQuantized","showScaleChooser","showRootChooser","availableScaleNames","availableScales","defaultScaleName","defaultScale","defaultRootName","defaultRoot","scaleCanBeMappedToPiano","keyboardMappings","keyboard","showKeyboardButton","lang","ports","exportScale","subscribe","S","keyboardActive","KEY_SUPERVISOR","T","b","h","E","P","w","timer","tip","tips","parseInt","changedTouches","item","touch","identifier","touches","selectAll","exit","enter","merge","v","toUpperCase","noteOn","noteOff","clamp","floor","find","resetNoteOnState","keyboardDisconnected","scaleQuantize","range","scaleLinear","toFrequency","freq","SimpleDrumpad","kit","transition","recorder","stopPropagation","html","justifyContent","lanesMatch","events","every","populatedLanesMatch","modelsMatch","PianoRollEditor","lanes","overflow","backgroundColor","SimplePianoRoll","beats","gridSize","labelWidth","scaleName","rootName","octave","defaultOctave","octaveCount","defaultOctaveCount","showTempoSlider","showSettings","highlightedLanes","options","allowResize","exportModel","page","previewNotes","notesSelected","notesDragged","notesAdded","tempoChanged","mouseDown","mouseMove","mouseUp","bottom","clear","version","importModel","getModel","record","setPlayhead","transform","opacity","pctInRange","fitsInRange","setOptions","updateTempo","getEditorTooltipWrapper","setSize","material","MicroEvent","mixin","PianoRollExport","createExportData","laneToMidi","startInBeats","durationInBeats","instrument","clip","lengthInBeats","notes","PianoRollPlayer","setLoop","progress","loopStart","loopEnd","uniq","end","loop","exporter","disableExport","debounce","showTargetState","targetState","livePreset","defaultState","pointerEvents","trySaveState","SimpleSession","preset","clips","scheduleRepeat","onTick","playSound","unqueueSound","stopSound","allSoundsStopped","SongFormExplorer","sections","songLength","description","label","jumpToSection","setPlayheadToTime","setPlayheadChangedCallback","updatePlayhead","YOUTUBEWIDGETS","YOUTUBE_API_READY","YouTube","onYouTubeIframeAPIReady","getPlayerState","YT","PlayerState","PLAYING","seekTo","playVideo","pauseVideo","getCurrentTime","BUFFERING","restart","Player","videoId","playerVars","controls","disablekb","showinfo","modestbranding","fs","playsinline","host","onReady","onStateChange","FUNC_ERROR_TEXT","NAN","symbolTag","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","freeGlobal","global","Object","freeSelf","self","root","Function","objectProto","prototype","objectToString","toString","nativeMax","max","nativeMin","min","now","func","wait","lastArgs","lastThis","maxWait","result","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","args","thisArg","undefined","apply","leadingEdge","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","remainingWait","debounced","isInvoking","arguments","toNumber","isObject","cancel","clearTimeout","flush","isObjectLike","isSymbol","call","other","valueOf","isBinary","test","slice","module","exports"],"version":3,"file":"index.5838c4d6.js.map"}